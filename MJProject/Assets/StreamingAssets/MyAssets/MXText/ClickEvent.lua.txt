local gbk = require "gbk"
local Effect = require "Effect"
local StringTable = require "StringTable"
ClickEvent = {}
ClickEvent.panelTable = {
	_main_ui = "Login",
	_choose_ui = "MainMenuAndroid",
	_choose_ui_ios = "MainMenuIOS",
	_create_room_ui = "CreateRoom",
	_join_room_ui = "GetintoRoom",
	_other_message_ui = "OtherMessageUI",
	_player_message_ui = "PlayerMessageUI",
	_mall_ui = "Mall",
	_mail_ui = "Mail",
	_setting_ui = "SettingMainMenu",
	_setting_play_ui = "Setting",
	_vip_note_ui = "VIPNote",
	_history_score_ui = "HistoryScene",
	_history_score_play_ui = "HistorySceneInGame",
	_store_ui = "StoreUI",
	_play_game_ui = "PlaySence",
	_player_info = "PlayerInfo",
	_other_player_info = "OtherPlayerInfo",
	_calculate_ui = "ClearRoundScene",
	_window_big = "PopWindowsBig",
	_window_mid = "PopWindowsMid",
	_window_small = "PopWindowsSmall",
	_exit_game_ui = "ExitGamePop",
	_instruction_ui = "HowToPlay",
	_welfare_ui = "WelfareScene",
	_activity_ui = "Activity",
	_toast_ui = "Toast",
	_not_move_toast_ui = "NotMoveToast",
	_room_calculate_ui = "FinishBalance",
	_vote_ui = "Vote",
	_share_calculate_ui = "Share",
	_only_yes_ui = "RoomClosedPop",
	_replay_ui = "ReplaySence",
	_watch_other_round = "WatchOthersRound",
	_home_share_ui = "HomeShare",
	_custom_servive_ui = "CustomServive",
	_getreward_ui = "GetReward",
	_loading_ui = "Loading",
}
ClickEvent.uiPanel = nil
ClickEvent.isInDouRoom = false
ClickEvent.scale = nil

ClickEvent._createObject = {}
ClickEvent._play_ui = {}

ClickEvent.isReplayClick = false

local _position_index = {
	POSITION_TYPE_EAST = 1,
	POSITION_TYPE_SOUTH = 2,
	POSITION_TYPE_WEST = 3,
	POSITION_TYPE_NORTH = 4,
}

local operationState = Enum.CreateEnumTable({"WAIT", "PENG", "GANG", "CHI", "HU", "DAPAI", "XUANFENGGANGFENG", "XUANFENGGANGJIAN", "ANGANG", "TINGPAI", "BAOPAI"},-1)

local notPushPassMsg = false

local _currentPanel = {}
local _popPanel = {}
local popPanelIndex = 0
local popBgIndex = 0
local Camera = CS.UnityEngine.Camera
local LogWarning = CS.UnityEngine.Debug.LogWarning
local WeChatPlatform = CS.Platform.Instance

local util = require "xlua.util"
local function AsyncYieldReturn(to_yield, cb)
    ClickEvent.self:YieldAndCallback(to_yield, cb)
end
local yield_return = util.async_to_sync(AsyncYieldReturn)

local rapidjson = require "rapidjson"

--local wechatHttpUrl = "http://api.cloudbm.wang/wechat/userinfo?"
local wechatHttpUrl = "http://testapi.cloudbm.wang/wechat/userinfo?"

local currentSingleDice = 1

function ClickEvent.Awake( ... )
	-- body
	if CS.LuaCommon.isIos == true then
		ClickEvent.AddPackage(CS.UnityEngine.Application.persistentDataPath.."/MyAssets/mx_assetbundles_ios/mxui.ab")
	else
		ClickEvent.AddPackage(CS.UnityEngine.Application.persistentDataPath.."/MyAssets/mx_assetbundles_android/mxui.ab")
	end
	--[[
	--]]
	UIConfig.defaultFont = "MJFont"
	ClickEvent.uiPanel = CS.UnityEngine.GameObject.Find("UIPanel"):GetComponent("UIPanel")
	ClickEvent.scale = ClickEvent.uiPanel.transform.localScale.x
	ClickEvent._createObject = nil
	ClickEvent._createObject = {}
	CS.UnityEngine.Application.targetFrameRate = 30
	if CS.LuaCommon.isIos == true then
		ClickEvent.panelTable._choose_ui = ClickEvent.panelTable._choose_ui_ios
	end
end

function ClickEvent.AddPackage(uiPath)
	-- body
	if Player.hasLoadUIPackage == false then
		Player.hasLoadUIPackage = true
		local bundle = CS.UnityEngine.AssetBundle.LoadFromFile(uiPath)
		UIPackage.AddPackage(bundle)
		--bundle:Unload(false)
	end
end

function ClickEvent.Start(loadUI)
	-- body
	ClickEvent.uiPanel.ui.visible = false
	GRoot.inst:RemoveChildren()
	ClickEvent.CreateNewPanel(loadUI)
	if ClickEvent.uiPanel.ui.visible then
	end
	_popPanel = nil
	_popPanel = {}
	popBgIndex = 0
	popPanelIndex = 0
end

function ClickEvent.WeChatGetMessage()
    -- body
    local code = WeChatPlatform:GetData("getWXCode")
    --[[
    local token = WeChatPlatform:GetData("getToken")
    if code and code ~= "" then
        WeChatPlatform:GetWeChatMethod("getAccess_token")
        return
    else
    	return
    end
    --]]
end

function ClickEvent.DeletePanel(deletePanel)
	-- body
	GRoot.inst:RemoveChild(deletePanel)
end

function ClickEvent.CreateNewPanel(panelName)
	-- body
	if panelName == ClickEvent.panelTable._main_ui then
		if Player and Player._tosence_name then
			if Player._tosence_name == "LoadingSence" or Player._tosence_name == "PlaySence" then
				return
			end
		end
	end
	if not ClickEvent._createObject[panelName] then
		ClickEvent._createObject[panelName] = UIPackage.CreateObject("MXUI", panelName)
	end
	_currentPanel.panel = ClickEvent._createObject[panelName]
	_currentPanel.panel.name = panelName
	_currentPanel.panel:SetSize(GRoot.inst.width, GRoot.inst.height)
	_currentPanel.panel:SetPosition(0,0,0)
	GRoot.inst:AddChild(_currentPanel.panel)
	local childNumber = _currentPanel.panel.numChildren
	for i=0,childNumber-1 do
		local obj = _currentPanel.panel:GetChildAt(i)
		if obj.group and obj.group.name == "Btns" then
			obj.onClick:Add(ClickEvent.registerButtonClick)
		end
	end
	--[[
	if Player._player_data and Player._player_data.common_prop and _currentPanel.panel:GetChild("Name") and _currentPanel.panel:GetChild("Name"):GetChild("PlayerName") then
		CS.UnityEngine.Debug.Player.LogWarning(Player._player_data.common_prop.name)
		_currentPanel.panel:GetChild("Name"):GetChild("PlayerName").text = Player._player_data.common_prop.name
	end
	--]]
	if not ClickEvent._play_ui then
		ClickEvent._play_ui = {}
	end

	if panelName == ClickEvent.panelTable._play_game_ui then
		ClickEvent._play_ui.chiPaiBar = _currentPanel.panel:GetChild("ChiPaiBg")
		ClickEvent._play_ui.chiPaiBar.visible = false
		ClickEvent._play_ui.gangPaiBar = _currentPanel.panel:GetChild("GangPaiBg")
		ClickEvent._play_ui.gangPaiBar.visible = false
		ClickEvent._play_ui.huPaiBar = _currentPanel.panel:GetChild("HuPaiBg")
		ClickEvent._play_ui.huPaiBar.visible = false
		ClickEvent._play_ui.operationBar = _currentPanel.panel:GetChild("GameOperationBar")
		ClickEvent._play_ui.passButton = _currentPanel.panel:GetChild("GamePassButton")
		ClickEvent._play_ui.passButton.visible = false
		ClickEvent._play_ui.cancelButton = _currentPanel.panel:GetChild("GameCancelButton")
		ClickEvent._play_ui.cancelButton.visible = false
		ClickEvent._play_ui.oppositePlayerTing = _currentPanel.panel:GetChild("OppositePlayerTing")
		ClickEvent._play_ui.frontPlayerTing = _currentPanel.panel:GetChild("FrontPlayerTing")
		ClickEvent._play_ui.behindPlayerTing = _currentPanel.panel:GetChild("BehindPlayerTing")
		ClickEvent._play_ui.playerTing = _currentPanel.panel:GetChild("PlayerTing")
		ClickEvent._play_ui.oppositePlayerTing.visible = false
		ClickEvent._play_ui.frontPlayerTing.visible = false
		ClickEvent._play_ui.behindPlayerTing.visible = false
		ClickEvent._play_ui.playerTing.visible = false
		ClickEvent._play_ui.gamePlayButton = _currentPanel.panel:GetChild("GamePlayButton")
		ClickEvent._play_ui.gamePlayButton.visible = false
		ClickEvent._play_ui.hintBar = _currentPanel.panel:GetChild("GameHintBar")
		ClickEvent._play_ui.hintBar.visible = false
		ClickEvent._play_ui.uselessRound = _currentPanel.panel:GetChild("Draw")
		ClickEvent._play_ui.uselessRound.visible = false
		ClickEvent._play_ui.frontPaiShow = _currentPanel.panel:GetChild("FrontPaiShow")
		ClickEvent._play_ui.frontPaiShow.visible = false
		ClickEvent._play_ui.behindPaiShow = _currentPanel.panel:GetChild("BehindPaiShow")
		ClickEvent._play_ui.behindPaiShow.visible = false
		ClickEvent._play_ui.oppositePaiShow = _currentPanel.panel:GetChild("OppositePaiShow")
		ClickEvent._play_ui.oppositePaiShow.visible = false
		ClickEvent._play_ui.playerAvatarInfo = _currentPanel.panel:GetChild("PlayerAvatarInfo")
		ClickEvent._play_ui.behindPlayerAvatarInfo = _currentPanel.panel:GetChild("BehindPlayerAvatarInfo")
		ClickEvent._play_ui.oppositePlayerAvatarInfo = _currentPanel.panel:GetChild("OppositePlayerAvatarInfo")
		ClickEvent._play_ui.frontPlayerAvatarInfo = _currentPanel.panel:GetChild("FrontPlayerAvatarInfo")
		ClickEvent._play_ui.selfBanker = ClickEvent._play_ui.playerAvatarInfo:GetChild("Zhuang")
		ClickEvent._play_ui.nextBanker = ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("Zhuang")
		ClickEvent._play_ui.oppositeBanker = ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("Zhuang")
		ClickEvent._play_ui.forwardBanker = ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("Zhuang")
		ClickEvent._play_ui.selfBanker.visible = false
		ClickEvent._play_ui.nextBanker.visible = false
		ClickEvent._play_ui.oppositeBanker.visible = false
		ClickEvent._play_ui.forwardBanker.visible = false
		ClickEvent._play_ui.remainNum = _currentPanel.panel:GetChild("RemainNum")
		ClickEvent._play_ui.remainNum.text = "136"
		ClickEvent._play_ui.frontAlready = _currentPanel.panel:GetChild("FrontAlready")
		ClickEvent._play_ui.oppositeAlready = _currentPanel.panel:GetChild("OppositeAlready")
		ClickEvent._play_ui.behindAlready = _currentPanel.panel:GetChild("BehindAlready")
		ClickEvent._play_ui.playerAlready = _currentPanel.panel:GetChild("PlayerAlready")
		ClickEvent._play_ui.frontAlready.visible = false
		ClickEvent._play_ui.oppositeAlready.visible = false
		ClickEvent._play_ui.behindAlready.visible = false
		ClickEvent._play_ui.playerAlready.visible = false
		ClickEvent._play_ui.inviteWechatFriends = _currentPanel.panel:GetChild("InviteWechatFriends")
		if WeChatPlatform:isInstalledWX() == false then
			ClickEvent._play_ui.inviteWechatFriends.visible = false
		end
		ClickEvent._play_ui.copyRoomNum = _currentPanel.panel:GetChild("CopyRoomNum")
		ClickEvent._play_ui.timeShow = _currentPanel.panel:GetChild("Wlan"):GetChild("Time")
		ClickEvent._play_ui.wlanShow = _currentPanel.panel:GetChild("Wlan"):GetController("WLan")
		WeChatPlatform.onSignalLevel = ClickEvent.OnSignalLevel
		--ClickEvent._play_ui.copyRoomNum.visible = false
		_currentPanel.panel:GetChild("RoundNumber"):GetChild("CurrentRoundNum").text = "0"

		_currentPanel.panel:GetChild("RoundNumber"):GetChild("TotalRoundNum").text = tostring(Player._room_information.options.open_rands)
		if Player._room_information.options.voice_open and Player._room_information.options.voice_open ~= 0 then
			_currentPanel.panel:GetChild("GameListenButton").selected = false
			_currentPanel.panel:GetChild("GameVoiceButton").selected = true
		else
			_currentPanel.panel:GetChild("GameListenButton").visible = false
			_currentPanel.panel:GetChild("GameVoiceButton").visible = false
		end

		Player.MahJong.UpdateRoomNumber(tostring(Player._roomId))

		ClickEvent._play_ui.baopaiLoader = _currentPanel.panel:GetChild("BaoPai"):GetChild("BaoPaiInRound"):GetChild("BaoPaiLoader")
		_currentPanel.panel:GetChild("BaoPai"):GetController("BaoPaiShow").selectedIndex = 0
		local hasBaoPai = false
		for k,v in pairs(Player._room_information.options.extend_type) do
			if v == "ROOM_EXTEND_TYPE_BAOPAI" then
				hasBaoPai = true
			end
		end
		if hasBaoPai == true then
			_currentPanel.panel:GetChild("BaoPai").visible = true
		else
			_currentPanel.panel:GetChild("BaoPai").visible = false
		end
		ClickEvent._play_ui.zhuangStarItem = _currentPanel.panel:GetChild("ZhuangStart")
		ClickEvent._play_ui.baoPaiShaiZi = _currentPanel.panel:GetChild("ShaiZiSprite")
		ClickEvent._play_ui.shaiZiStopLoader = _currentPanel.panel:GetChild("ShaiZiStopLoader")
		ClickEvent._play_ui.baoPaiAnimation = _currentPanel.panel:GetChild("BaoPaiInRound")
		ClickEvent._play_ui.zhuangStarItem.visible = false
		ClickEvent._play_ui.baoPaiShaiZi.visible = false
		ClickEvent._play_ui.shaiZiStopLoader.visible = false
		ClickEvent._play_ui.baoPaiAnimation.visible = false


		------特效
		ClickEvent._play_ui.playerAvatarInfoEffect = Effect.AddUIEffect(Effect._effect_name.head_ui,CS.UnityEngine.Vector3(110,110,110),ClickEvent._play_ui.playerAvatarInfo)
		ClickEvent._play_ui.behindPlayerAvatarInfoEffect = Effect.AddUIEffect(Effect._effect_name.head_ui,CS.UnityEngine.Vector3(110,110,110),ClickEvent._play_ui.behindPlayerAvatarInfo)
		ClickEvent._play_ui.oppositePlayerAvatarInfoEffect = Effect.AddUIEffect(Effect._effect_name.head_ui,CS.UnityEngine.Vector3(110,110,110),ClickEvent._play_ui.oppositePlayerAvatarInfo)
		ClickEvent._play_ui.frontPlayerAvatarInfoEffect = Effect.AddUIEffect(Effect._effect_name.head_ui,CS.UnityEngine.Vector3(110,110,110),ClickEvent._play_ui.frontPlayerAvatarInfo)
		ClickEvent._play_ui.changeZhuang = _currentPanel.panel:GetChild("ZhuangGraph")
		Effect.AddUIGraphEffect(Effect._effect_name.zhuangStar,CS.UnityEngine.Vector3(110,110,110),ClickEvent._play_ui.changeZhuang,ClickEvent._play_ui.changeZhuang.xy+ClickEvent._play_ui.changeZhuang.size/2)
		ClickEvent._play_ui.playerAvatarInfoEffect.visible = false
		ClickEvent._play_ui.behindPlayerAvatarInfoEffect.visible = false
		ClickEvent._play_ui.oppositePlayerAvatarInfoEffect.visible = false
		ClickEvent._play_ui.frontPlayerAvatarInfoEffect.visible = false
		ClickEvent._play_ui.changeZhuang.visible = false
		---------------
		ClickEvent._play_ui.playerAvatarInfo.visible = false
		ClickEvent._play_ui.behindPlayerAvatarInfo.visible = false
		ClickEvent._play_ui.oppositePlayerAvatarInfo.visible = false
		ClickEvent._play_ui.frontPlayerAvatarInfo.visible = false

		ClickEvent._play_ui.titleFather = _currentPanel.panel:GetChild("Inform")
		ClickEvent._play_ui.moveTitleText = _currentPanel.panel:GetChild("Inform"):GetChild("InformText"):GetChild("txtMove")
		ClickEvent._play_ui.moveTitle = _currentPanel.panel:GetChild("Inform"):GetChild("InformText"):GetTransition("Txt")
		ClickEvent._play_ui.titleFather.visible = false
		ClickEvent._play_ui.gameMoreControl = _currentPanel.panel:GetController("Menu")
		ClickEvent._play_ui.gameEmojiControl = _currentPanel.panel:GetController("Emoji")

		local emojiList = _currentPanel.panel:GetChild("Emoji"):GetChild("HelloEmojiList")--.onClickItem:Add(ClickEvent.registerButtonClick)
		for i=0,emojiList.numChildren-1 do
			local obj = emojiList:GetChildAt(i)
			obj.onClick:Add(ClickEvent.registerButtonClick)
		end
		emojiList = _currentPanel.panel:GetChild("Emoji"):GetChild("HelloTextList")--.onClickItem:Add(ClickEvent.registerButtonClick)
		for i=0,emojiList.numChildren-1 do
			local obj = emojiList:GetChildAt(i)
			obj.onClick:Add(ClickEvent.registerButtonClick)
		end

		ClickEvent._play_ui.playerEmoji = _currentPanel.panel:GetChild("PlayerEmojiShow")
		ClickEvent._play_ui.behindEmoji = _currentPanel.panel:GetChild("BehindEmojiShow")
		ClickEvent._play_ui.oppositeEmoji = _currentPanel.panel:GetChild("OppositeEmojiShow")
		ClickEvent._play_ui.FrontEmoji = _currentPanel.panel:GetChild("FrontEmojiShow")

		--[[
		ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("VoiceState").visible = false
		ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("VoiceState").visible = false
		ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("VoiceState").visible = false
		ClickEvent._play_ui.playerAvatarInfo:GetChild("VoiceState").visible = false
		--]]

		if Player.isFriendRoom == true then
			--_currentPanel.panel:GetChild("GameTrusteeshipButton").visible = false
		end
		--[[
		effectPlayer.transform.position = Camera.main:ScreenToWorldPoint(ClickEvent._play_ui.playerAvatarInfo:TransformPoint(ClickEvent._play_ui.playerAvatarInfo.xy,nil).x,
			ClickEvent._play_ui.playerAvatarInfo:TransformPoint(ClickEvent._play_ui.playerAvatarInfo.xy,nil).y,0.35)
		ClickEvent._play_ui.playerAvatarInfo:AddChild(x)
		--]]
	elseif panelName == ClickEvent.panelTable._replay_ui then
		ClickEvent._play_ui.oppositePlayerTing = _currentPanel.panel:GetChild("OppositePlayerTing")
		ClickEvent._play_ui.frontPlayerTing = _currentPanel.panel:GetChild("FrontPlayerTing")
		ClickEvent._play_ui.behindPlayerTing = _currentPanel.panel:GetChild("BehindPlayerTing")
		ClickEvent._play_ui.playerTing = _currentPanel.panel:GetChild("PlayerTing")
		ClickEvent._play_ui.oppositePlayerTing.visible = false
		ClickEvent._play_ui.frontPlayerTing.visible = false
		ClickEvent._play_ui.behindPlayerTing.visible = false
		ClickEvent._play_ui.playerTing.visible = false
		ClickEvent._play_ui.uselessRound = _currentPanel.panel:GetChild("Draw")
		ClickEvent._play_ui.uselessRound.visible = false
		ClickEvent._play_ui.frontPaiShow = _currentPanel.panel:GetChild("FrontPaiShow")
		ClickEvent._play_ui.frontPaiShow.visible = false
		ClickEvent._play_ui.behindPaiShow = _currentPanel.panel:GetChild("BehindPaiShow")
		ClickEvent._play_ui.behindPaiShow.visible = false
		ClickEvent._play_ui.oppositePaiShow = _currentPanel.panel:GetChild("OppositePaiShow")
		ClickEvent._play_ui.oppositePaiShow.visible = false
		ClickEvent._play_ui.replayFinish = _currentPanel.panel:GetChild("ReplayFinish")
		ClickEvent._play_ui.replayFinish.visible = false
		ClickEvent._play_ui.replayFinishTransition = _currentPanel.panel:GetTransition("FinishIn")
		--[[
		--]]
		ClickEvent._play_ui.playerAvatarInfo = _currentPanel.panel:GetChild("PlayerAvatarInfo")
		ClickEvent._play_ui.behindPlayerAvatarInfo = _currentPanel.panel:GetChild("BehindPlayerAvatarInfo")
		ClickEvent._play_ui.oppositePlayerAvatarInfo = _currentPanel.panel:GetChild("OppositePlayerAvatarInfo")
		ClickEvent._play_ui.frontPlayerAvatarInfo = _currentPanel.panel:GetChild("FrontPlayerAvatarInfo")
		ClickEvent._play_ui.selfBanker = ClickEvent._play_ui.playerAvatarInfo:GetChild("Zhuang")
		ClickEvent._play_ui.nextBanker = ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("Zhuang")
		ClickEvent._play_ui.oppositeBanker = ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("Zhuang")
		ClickEvent._play_ui.forwardBanker = ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("Zhuang")
		ClickEvent._play_ui.selfBanker.visible = false
		ClickEvent._play_ui.nextBanker.visible = false
		ClickEvent._play_ui.oppositeBanker.visible = false
		ClickEvent._play_ui.forwardBanker.visible = false
		ClickEvent._play_ui.remainNum = _currentPanel.panel:GetChild("RemainNum")
		ClickEvent._play_ui.remainNum.text = "136"
		ClickEvent._play_ui.timeShow = _currentPanel.panel:GetChild("Wlan"):GetChild("Time")
		ClickEvent._play_ui.wlanShow = _currentPanel.panel:GetChild("Wlan"):GetController("WLan")
		WeChatPlatform.onSignalLevel = ClickEvent.OnSignalLevel
		_currentPanel.panel:GetChild("RoundNumber"):GetChild("CurrentRoundNum").text = tostring(Player.playBackRoundIndex)

		_currentPanel.panel:GetChild("RoundNumber"):GetChild("TotalRoundNum").text = tostring(Player._room_information.options.open_rands)

		Player.MahJong.UpdateRoomNumber(tostring(Player._roomId))

		ClickEvent._play_ui.baopaiLoader = _currentPanel.panel:GetChild("BaoPai"):GetChild("BaoPaiInRound"):GetChild("BaoPaiLoader")
		_currentPanel.panel:GetChild("BaoPai"):GetController("BaoPaiShow").selectedIndex = 0
		--[[
		local hasBaoPai = false
		for k,v in pairs(Player._room_information.options.extend_type) do
			if v == "ROOM_EXTEND_TYPE_BAOPAI" then
				hasBaoPai = true
			end
		end
		if hasBaoPai == true then
			_currentPanel.panel:GetChild("BaoPai").visible = true
		else
			_currentPanel.panel:GetChild("BaoPai").visible = false
		end
		--]]
		------特效
		ClickEvent._play_ui.playerAvatarInfoEffect = Effect.AddUIEffect(Effect._effect_name.head_ui,CS.UnityEngine.Vector3(110,110,110),ClickEvent._play_ui.playerAvatarInfo)
		ClickEvent._play_ui.behindPlayerAvatarInfoEffect = Effect.AddUIEffect(Effect._effect_name.head_ui,CS.UnityEngine.Vector3(110,110,110),ClickEvent._play_ui.behindPlayerAvatarInfo)
		ClickEvent._play_ui.oppositePlayerAvatarInfoEffect = Effect.AddUIEffect(Effect._effect_name.head_ui,CS.UnityEngine.Vector3(110,110,110),ClickEvent._play_ui.oppositePlayerAvatarInfo)
		ClickEvent._play_ui.frontPlayerAvatarInfoEffect = Effect.AddUIEffect(Effect._effect_name.head_ui,CS.UnityEngine.Vector3(110,110,110),ClickEvent._play_ui.frontPlayerAvatarInfo)
		ClickEvent._play_ui.playerAvatarInfoEffect.visible = false
		ClickEvent._play_ui.behindPlayerAvatarInfoEffect.visible = false
		ClickEvent._play_ui.oppositePlayerAvatarInfoEffect.visible = false
		ClickEvent._play_ui.frontPlayerAvatarInfoEffect.visible = false
		---------------
		ClickEvent._play_ui.playerAvatarInfo.visible = false
		ClickEvent._play_ui.behindPlayerAvatarInfo.visible = false
		ClickEvent._play_ui.oppositePlayerAvatarInfo.visible = false
		ClickEvent._play_ui.frontPlayerAvatarInfo.visible = false

		ClickEvent._play_ui.titleFather = _currentPanel.panel:GetChild("Inform")
		ClickEvent._play_ui.moveTitleText = _currentPanel.panel:GetChild("Inform"):GetChild("InformText"):GetChild("txtMove")
		ClickEvent._play_ui.moveTitle = _currentPanel.panel:GetChild("Inform"):GetChild("InformText"):GetTransition("Txt")
		ClickEvent._play_ui.titleFather.visible = false
		ClickEvent._play_ui.gameMoreControl = _currentPanel.panel:GetController("Menu")
		ClickEvent._play_ui.gameEmojiControl = _currentPanel.panel:GetController("Emoji")

		ClickEvent._play_ui.replayProgress = _currentPanel.panel:GetChild("ReplayProgressBar")
		ClickEvent._play_ui.replayProgress.value = 0

		ClickEvent._play_ui.playPauseControl = _currentPanel.panel:GetController("PlayAndPause")
		ClickEvent._play_ui.playPauseControl.selectedIndex = 1

	elseif panelName == ClickEvent.panelTable._choose_ui and Player._player_data then
		Player.isPlayBack = false
		if Player.wechat_nickname and Player.wechat_nickname ~= "" then
			_currentPanel.panel:GetChild("Avatar"):GetChild("Name"):GetChild("PlayerName").text = tostring(gbk.toutf8(gbk.fromutf8(Player.wechat_nickname)))
		else
			_currentPanel.panel:GetChild("Avatar"):GetChild("Name"):GetChild("PlayerName").text = tostring(Player._player_data.common_prop.name)
		end
		_currentPanel.panel:GetChild("Avatar"):GetChild("PlayerID").text = tostring(Player._player_data.common_prop.player_id)
		_currentPanel.panel:GetChild("DouNum"):GetChild("DouNum").text = tostring(Player._player_data.common_prop.huanledou)
		_currentPanel.panel:GetChild("GemsNum"):GetChild("GemsNum").text = tostring(Player._player_data.common_prop.diamond)
		_currentPanel.panel:GetChild("RoomCardNum"):GetChild("RoomCardNum").text = tostring(Player._player_data.common_prop.room_card_count)
		--[[
		ClickEvent._play_ui.waitingPop = _currentPanel.panel:GetChild("WaitingPop")
		ClickEvent._play_ui.waitingPop:GetChild("CloseWaiting").onClick:Add(ClickEvent.registerButtonClick)
		ClickEvent._play_ui.waitingPopTime = ClickEvent._play_ui.waitingPop:GetChild("MatchTimer")
		--]]

		ClickEvent._play_ui.avatarLoader = _currentPanel.panel:GetChild("Avatar"):GetChild("AvatarLoader")
		--_currentPanel.panel:GetChild("Inform"):GetChild("InformText"):GetChild("txtFixed").text = "[Color=#70DB93,#B5A642]游戏严打外挂，一旦发现立即封号[/Color]"
		ClickEvent._play_ui.titleFather = _currentPanel.panel:GetChild("Inform")
		ClickEvent._play_ui.moveTitleText = _currentPanel.panel:GetChild("Inform"):GetChild("InformText"):GetChild("txtMove")
		ClickEvent._play_ui.moveTitle = _currentPanel.panel:GetChild("Inform"):GetChild("InformText"):GetTransition("Txt")
		ClickEvent._play_ui.titleFather.visible = false
		if Player.wechat_headimgurl and Player.wechat_headimgurl ~= "" then
			ClickEvent._play_ui.avatarLoader.url = ""--UIPackage.GetItemURL("MXUI","Touxiang01")
			WeChatPlatform.func = nil
			WeChatPlatform:SetFuncDelegate(function (...)
				-- body
				local tempTexture = WeChatPlatform:SetAsyncImage(Player.wechat_headimgurl)
				if tempTexture then
					ClickEvent._play_ui.avatarLoader.texture = NTexture(tempTexture)
				end
				WeChatPlatform.func = nil
			end)
			local tempTexture = WeChatPlatform:SetAsyncImage(Player.wechat_headimgurl)
			--[[
			--]]
			if tempTexture then
				ClickEvent._play_ui.avatarLoader.texture = NTexture(tempTexture)
			end
		else
			ClickEvent._play_ui.avatarLoader.url = UIPackage.GetItemURL("MXUI","Touxiang01")
		end
		--------红点
		_currentPanel.panel:GetChild("Shop"):GetChild("Reddot").visible = false
		_currentPanel.panel:GetChild("Mail"):GetChild("Reddot").visible = false
		_currentPanel.panel:GetChild("VIPRecordButton"):GetChild("Reddot").visible = false
		_currentPanel.panel:GetChild("Promotion"):GetChild("Reddot").visible = false

		local x = 1/ClickEvent.scale
		Effect.AddUIEffect(Effect._effect_name.gold_ui,CS.UnityEngine.Vector3(x,x,x),_currentPanel.panel:GetChild("DouNum"),_currentPanel.panel:GetChild("DouNum"):GetChild("n7").xy+_currentPanel.panel:GetChild("DouNum"):GetChild("n7").size/2)
		Effect.AddUIEffect(Effect._effect_name.gem_ui,CS.UnityEngine.Vector3(x,x,x),_currentPanel.panel:GetChild("GemsNum"),_currentPanel.panel:GetChild("GemsNum"):GetChild("n7").xy+_currentPanel.panel:GetChild("GemsNum"):GetChild("n7").size/2)
		--Effect.AddUIGraphEffect(Effect._effect_name.datingButton,CS.UnityEngine.Vector3(375,375,375),_currentPanel.panel:GetChild("ButtonEffectGraph3"),_currentPanel.panel:GetChild("ButtonEffectGraph3").xy+_currentPanel.panel:GetChild("ButtonEffectGraph3").size/2 - CS.UnityEngine.Vector2(0,-50))
		--Effect.AddUIEffect(Effect._effect_name.shangcheng_ui,CS.UnityEngine.Vector3(x,x,x),_currentPanel.panel:GetChild("Shop"),CS.UnityEngine.Vector2(_currentPanel.panel:GetChild("Shop").width*0.7,_currentPanel.panel:GetChild("Shop").height*0.52))

		if Player._player_data.room_id and Player._player_data.room_id ~= 0 then
			ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
			_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2036)
		end
		if Player.hasClickActivity == true then
			_currentPanel.panel:GetChild("Activity"):GetChild("Reddot").visible = false
		end
		if Player.hasShowActivity == false then
			ClickEvent.ShowActivity()
		end
		--[[
		local image = _currentPanel.panel:GetChild("Back"):GetChild("n1")
		Player.LogWarning(image.displayObject.gameObject:GetComponent("Renderer").bounds.size.x)
		Player.LogWarning(image.displayObject.size.x * ClickEvent.scale)
		for k,v in pairs(Player._player_data.inventory.inventory) do
			for j,c in pairs(v.items) do
				Player.LogWarning("ITEM_TYPE_ROOM_CARD")
				Player.LogWarning(c.type_t)
				if c.type_t == "ITEM_TYPE_ROOM_CARD" then
					local tempMsg = protobuf.decode(AssetManager.GetMessagesByType(c.type_t),c.stuff)
					_currentPanel.panel:GetChild("RoomCardNum"):GetChild("RoomCardNum").text = tostring(tempMsg.item_common_prop.count)
				end
			end
		end
		--]]
	elseif panelName == ClickEvent.panelTable._main_ui then
		if WeChatPlatform:isInstalledWX() == false then
			_currentPanel.panel:GetChild("WechatLogin").visible = false
		end

		if _currentPanel.panel:GetChild("Version") then
			_currentPanel.panel:GetChild("Version").text = Player.pc_version
		end
		if CS.LuaCommon.isAndroid or CS.LuaCommon.isIos then
			_currentPanel.panel:GetChild("Title").visible = false
			_currentPanel.panel:GetChild("Account").visible = false
			_currentPanel.panel:GetChild("LoginButton").visible = false
		end
		_currentPanel.panel:GetChild("ServiceCheck").selected = true
		local x = 1/ClickEvent.scale
		Effect.AddUIEffect(Effect._effect_name.mainUI,CS.UnityEngine.Vector3(100,100,100),_currentPanel.panel,_currentPanel.panel:GetChild("n20").xy+CS.UnityEngine.Vector2(_currentPanel.panel:GetChild("n20").width*0.5,_currentPanel.panel:GetChild("n20").height*0.5))
	elseif panelName == ClickEvent.panelTable._loading_ui then
		_currentPanel.panel:GetChild("InformNoHorn").visible = false
		_currentPanel.panel:GetChild("LoadingBar").visible = false
	end
	
	--[[
	ClickEvent._play_ui.roomId = _currentPanel.panel:GetChild("RoomID")
	if ClickEvent._play_ui.roomId then
		--ClickEvent._play_ui.roomId.text = tostring(Player._roomId)
		ClickEvent._play_ui.roomId.visible = false
	end
	--]]
end

function ClickEvent.OnSignalLevel(signalLevel)
	-- body
	if _currentPanel and _currentPanel.panel and _currentPanel.panel.name == ClickEvent.panelTable._play_game_ui and CS.UnityEngine.SceneManagement.SceneManager.GetActiveScene().name == "PlaySence" then
		if signalLevel == 3 then
			ClickEvent._play_ui.wlanShow.selectedIndex = 0
		elseif signalLevel == 2 then
			ClickEvent._play_ui.wlanShow.selectedIndex = 1
		else
			ClickEvent._play_ui.wlanShow.selectedIndex = 2
		end
	end
end

function ClickEvent.UpdateSignalLevel(signalLevel)
	-- body
	print("IOSsignalLevel:"..tostring(signalLevel))
	if _currentPanel and _currentPanel.panel and _currentPanel.panel.name == ClickEvent.panelTable._play_game_ui and CS.UnityEngine.SceneManagement.SceneManager.GetActiveScene().name == "PlaySence" then
		if signalLevel == 3 then
			ClickEvent._play_ui.wlanShow.selectedIndex = 0
		elseif signalLevel == 2 then
			ClickEvent._play_ui.wlanShow.selectedIndex = 1
		else
			ClickEvent._play_ui.wlanShow.selectedIndex = 2
		end
	end
end

function ClickEvent.ShowActivity( ... )
	-- body
	if next(Player.activityTable) == nil then
		return
	end
	if _currentPanel.panel.name ~= ClickEvent.panelTable._choose_ui then
		return
	end
	ClickEvent.PopPanel(ClickEvent.panelTable._activity_ui)
	Player.hasShowActivity = true
	local pageCount = 0
	for i=1,5 do
		_popPanel[popPanelIndex].panel:GetChild("Choose"..tostring(i)).visible = false
		_popPanel[popPanelIndex].panel:GetChild("ActivityShow"..tostring(i)).visible = false
	end
	if Player.activityTable then
		for k,v in pairs(Player.activityTable) do
			for activityKey,activityValue in pairs(Player.activityDataTable.page_list) do
				Player.LogWarning(activityValue.activity_id)
				if v.activity_id == activityValue.activity_id then
					if v.open == true then
						cardActivity = true
						pageCount = pageCount + 1
						_popPanel[popPanelIndex].panel:GetChild("Choose"..tostring(pageCount)).visible = true
						_popPanel[popPanelIndex].panel:GetChild("ActivityShow"..tostring(pageCount)).visible = true
						_popPanel[popPanelIndex].panel:GetChild("Choose"..tostring(pageCount)):GetChild("title").text = ""--gbk.toutf8(activityValue.page_name)
						if tostring(type(_popPanel[popPanelIndex].panel:GetChild("Choose"..tostring(pageCount)):GetChild("icon").texture)) == "nil" then
							ClickEvent.LoadActivityTexture(tostring(activityValue.activity_id).."_1",_popPanel[popPanelIndex].panel:GetChild("Choose"..tostring(pageCount)):GetChild("icon"))
						end
						if tostring(type(_popPanel[popPanelIndex].panel:GetChild("ActivityShow"..tostring(pageCount)):GetChild("ImgLoader").texture)) == "nil" then
							ClickEvent.LoadActivityTexture(tostring(activityValue.activity_id),_popPanel[popPanelIndex].panel:GetChild("ActivityShow"..tostring(pageCount)):GetChild("ImgLoader"))
						end
					end
				end
			end
		end
	else
		return
	end
end

function ClickEvent.LoadActivityTexture(textureID,loader)
	-- body
	local texturePath = "file:///"..CS.UnityEngine.Application.persistentDataPath.."/MyAssets/ActivityTexture/"..textureID..".png"
	if CS.LuaCommon.isAndroid == true or CS.LuaCommon.isIos == true then
		texturePath = "file://"..CS.UnityEngine.Application.persistentDataPath.."/MyAssets/ActivityTexture/"..textureID..".png"
	end
	local co = coroutine.create(function()
		local www = CS.UnityEngine.WWW(texturePath)
		yield_return(www)
		if not www.error then
			loader.texture = NTexture(www.texture)
		else
			CS.UnityEngine.Debug.LogWarning('error:'..www.error)
		end
    end)
    coroutine.resume(co)

	--[[
	local folder = CS.System.IO.FileInfo(texturePath)
	if not folder.Exists then
		return nil
	end
	local fileStream = CS.System.IO.FileStream(texturePath, CS.System.IO.FileMode.Open, CS.System.IO.FileAccess.Read)
    fileStream:Seek(0, CS.System.IO.SeekOrigin.Begin)
    local bytes = nil
    fileStream:Read(bytes, 0, fileStream.Length)
    fileStream:Close()
    fileStream:Dispose()
    fileStream = nil

    local width = 400
    local height = 500
    local texture = CS.UnityEngine.Texture2D(width, height)
    texture.LoadImage(bytes)
    loader.texture = NTexture(www.texture)
	--]]
end

function ClickEvent.CommonPropertyUpdate( ... )
	-- body
	if _currentPanel.panel.name == ClickEvent.panelTable._choose_ui then
		--_currentPanel.panel:GetChild("Name"):GetChild("PlayerName").text = Player._player_data.common_prop.name
		_currentPanel.panel:GetChild("DouNum"):GetChild("DouNum").text = tostring(Player._player_data.common_prop.huanledou)
		_currentPanel.panel:GetChild("GemsNum"):GetChild("GemsNum").text = tostring(Player._player_data.common_prop.diamond)
		_currentPanel.panel:GetChild("RoomCardNum"):GetChild("RoomCardNum").text = tostring(Player._player_data.common_prop.room_card_count)
	end
end

function ClickEvent.CreateOperationButton( ... )
	-- body
	_currentPanel.buttonList = {}
	_currentPanel.buttonList["GameChiButton"] = UIPackage.GetItemURL("MXUI","GameChiButton")
	_currentPanel.buttonList["GamePengButton"] = UIPackage.GetItemURL("MXUI","GamePengButton")
	_currentPanel.buttonList["GameGangButton"] = UIPackage.GetItemURL("MXUI","GameGangButton")
	_currentPanel.buttonList["GameHuButton"] = UIPackage.GetItemURL("MXUI","GameHuButton")
	_currentPanel.buttonList["GameTingButton"] = UIPackage.GetItemURL("MXUI","GameTingButton")
	_currentPanel.buttonList["XuanFengButton"] = UIPackage.GetItemURL("MXUI","XuanFengButton")
	_currentPanel.buttonList["ClearShowFan"] = UIPackage.GetItemURL("MXUI","ClearShowFan")
end

function ClickEvent.ShowSingleYesWindow( showContentNumber )
	-- body
	if ClickEvent.PopPanel(ClickEvent.panelTable._only_yes_ui) == false then
		return
	end
	_popPanel[popPanelIndex].panel:GetChild("TPopText").text = StringTable.Get(showContentNumber)
end

function ClickEvent.ShowSmallWindow(showContentNumber)
	-- body
	if ClickEvent.PopPanel(ClickEvent.panelTable._window_small) == false then
		return
	end
	_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(showContentNumber)
end

function ClickEvent.ShowSmallWindowByContent(showContent)
	-- body
	if ClickEvent.PopPanel(ClickEvent.panelTable._window_small) == false then
		return
	end
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = tostring(showContent)
end

function ClickEvent.ShowAlready(playerID)
	-- body
	if CS.UnityEngine.SceneManagement.SceneManager.GetActiveScene().name ~= "PlaySence" then
		return
	end
	local currentPositionData
	for j,m in pairs(Player._all_players_data) do
		if playerID == m.common_prop.player_id then
			currentPositionData = m
			break
		end
	end
	local tempX = _position_index[currentPositionData.position] - _position_index[Player._my_player_data.position]
	if tempX == 1 then
		ClickEvent._play_ui.behindAlready.visible = true
	elseif tempX == 2 then
		ClickEvent._play_ui.oppositeAlready.visible = true
	elseif tempX == 3 then
		ClickEvent._play_ui.frontAlready.visible = true
	else
		ClickEvent._play_ui.playerAlready.visible = true
	end
end

function ClickEvent.SetPlayBackProgress(progress)
	-- body
	local progessInt = math.floor(progress * 100)
	ClickEvent._play_ui.replayProgress.value = progessInt
end

function ClickEvent.DeleteShowBaoPai( ... )
	-- body
	_currentPanel.panel:GetChild("BaoPai"):GetController("BaoPaiShow").selectedIndex = 0
end

function ClickEvent.PlayBackBaoPaiShow( paiData )
	-- body
	if paiData and paiData ~= {} and paiData.card_value ~= 0 then
		_currentPanel.panel:GetChild("BaoPai"):GetController("BaoPaiShow").selectedIndex = 1
		ClickEvent._play_ui.baopaiLoader.url = UIPackage.GetItemURL("MXUI",paiData.card_type.."_"..paiData.card_value)
	end
end

function ClickEvent.BaoPaiFinalShow( ... )
	-- body
	ClickEvent._play_ui.baoPaiAnimation.visible = false
	_currentPanel.panel:GetChild("BaoPai"):GetController("BaoPaiShow").selectedIndex = 1
	ClickEvent._play_ui.baopaiLoader.url = UIPackage.GetItemURL("MXUI",Player.baoPaiCache.card_type.."_"..Player.baoPaiCache.card_value)
end

function ClickEvent.ShowBaoPai(paiData)
	-- body
	if paiData and paiData ~= {} and paiData.card_value ~= 0 then
		ClickEvent._play_ui.baoPaiAnimation.visible = true
		Player.LogWarning("roomall"..paiData.card_type.."::::"..paiData.card_value)
		Player.baoPaiCache = paiData
		_currentPanel.panel:GetTransition("BaoPai"):Play(ClickEvent.BaoPaiFinalShow)
		ClickEvent._play_ui.baoPaiAnimation:GetChild("BaoPaiLoader").url = UIPackage.GetItemURL("MXUI",paiData.card_type.."_"..paiData.card_value)
	end
end

function ClickEvent.ShowSingleDice( ... )
	-- body
	ClickEvent._play_ui.baoPaiShaiZi.visible = false
	ClickEvent._play_ui.baoPaiShaiZi.onPlayEnd:Clear()
	ClickEvent._play_ui.shaiZiStopLoader.visible = true
	ClickEvent._play_ui.shaiZiStopLoader.url = UIPackage.GetItemURL("MXUI","shaiziz_common_lobby_"..tostring(currentSingleDice))
	_currentPanel.panel:GetTransition("ShaiZiStop"):Play(ClickEvent.FinishSingleDice)
end

function ClickEvent.testDiceShow( ... )
	-- body
	ClickEvent._play_ui.shaiZiStopLoader.visible = true
	ClickEvent._play_ui.shaiZiStopLoader.url = UIPackage.GetItemURL("MXUI","shaiziz_common_lobby_4")
	_currentPanel.panel:GetTransition("ShaiZiStop"):Play()
end

function ClickEvent.FinishSingleDice( ... )
	-- body
	ClickEvent._play_ui.shaiZiStopLoader.visible = false
	ClickEvent.ShowBaoPai(Player.baoPaiCache)
end

function ClickEvent.PlaySingleDice(dicePoint)
	-- body
	ClickEvent._play_ui.baoPaiShaiZi.visible = true
	currentSingleDice = dicePoint
	ClickEvent._play_ui.baoPaiShaiZi.onPlayEnd:Add(ClickEvent.ShowSingleDice)
	ClickEvent._play_ui.baoPaiShaiZi:SetPlaySettings(0, 16, 1, (16+dicePoint))
end

function ClickEvent.UpdateTime( ... )
	-- body
	if _currentPanel and _currentPanel.panel and CS.UnityEngine.SceneManagement.SceneManager.GetActiveScene().name == "PlaySence" then
		if _currentPanel.panel.name == ClickEvent.panelTable._play_game_ui or _currentPanel.panel.name == ClickEvent.panelTable._replay_ui then
			local hour = tostring(CS.System.DateTime.Now.Hour)
			local minute = tostring(CS.System.DateTime.Now.Minute)
			if CS.System.DateTime.Now.Hour < 10 then
				hour = "0"..tostring(CS.System.DateTime.Now.Hour)
			end
			if CS.System.DateTime.Now.Minute < 10 then
				minute = "0"..tostring(CS.System.DateTime.Now.Minute)
			end
			ClickEvent._play_ui.timeShow.text = hour..":"..minute
		end
	end
end

function ClickEvent.PlayMoveTitle(BroadcastingContent)
	-- body
	if CS.UnityEngine.SceneManagement.SceneManager.GetActiveScene().name ~= "PlaySence" and CS.UnityEngine.SceneManagement.SceneManager.GetActiveScene().name ~= "FairyMainUI" then
		return
	end
	if not _currentPanel or not _currentPanel.panel or not ClickEvent._play_ui.titleFather then
		return
	end
	if _currentPanel.panel.name ~= ClickEvent.panelTable._choose_ui and _currentPanel.panel.name ~= ClickEvent.panelTable._play_game_ui then
		return
	end
	ClickEvent._play_ui.titleFather.visible = true
	if not BroadcastingContent then
		if ClickEvent._play_ui.moveTitleText.text == StringTable.Get(2050) then
			ClickEvent._play_ui.moveTitleText.text = StringTable.Get(2051)
		elseif ClickEvent._play_ui.moveTitleText.text == StringTable.Get(2051) then
			ClickEvent._play_ui.moveTitleText.text = StringTable.Get(2052)
		elseif ClickEvent._play_ui.moveTitleText.text == StringTable.Get(2052) then
			ClickEvent._play_ui.moveTitleText.text = StringTable.Get(2050)
		else
			ClickEvent._play_ui.moveTitleText.text = StringTable.Get(2050)
		end
	else
		ClickEvent._play_ui.moveTitleText.text = tostring(BroadcastingContent)
	end
	ClickEvent._play_ui.moveTitle:SetValue("Time",-ClickEvent._play_ui.moveTitleText.width,16)
	ClickEvent._play_ui.moveTitle:SetHook("Time",function()
		-- body
		ClickEvent._play_ui.titleFather.visible = false
	end)
	ClickEvent._play_ui.moveTitle:Play()
end

function ClickEvent.UpdateRoundNumber(CurrentRoundNum,TotalRoundNum)
	-- body
	Player.room_current_round = CurrentRoundNum
	_currentPanel.panel:GetChild("RoundNumber"):GetChild("CurrentRoundNum").text = tostring(CurrentRoundNum)
	_currentPanel.panel:GetChild("RoundNumber"):GetChild("TotalRoundNum").text = tostring(TotalRoundNum)
end

function ClickEvent.CloseAlready( ... )
	-- body
	if CS.UnityEngine.SceneManagement.SceneManager.GetActiveScene().name ~= "PlaySence" then
		return
	end
	ClickEvent._play_ui.frontAlready.visible = false
	ClickEvent._play_ui.oppositeAlready.visible = false
	ClickEvent._play_ui.behindAlready.visible = false
	ClickEvent._play_ui.playerAlready.visible = false
end

function ClickEvent.AddOperationButton( buttonName )
	-- body
	for i=0,ClickEvent._play_ui.operationBar.numChildren-1 do
		local obj = ClickEvent._play_ui.operationBar:GetChildAt(i)
		if obj.name == buttonName then
			return
		end
	end
	local operationButtonTemp = ClickEvent._play_ui.operationBar:AddItemFromPool(_currentPanel.buttonList[buttonName])
	operationButtonTemp.name = buttonName
	operationButtonTemp.onClick:Add(ClickEvent.registerButtonClick)
end

function ClickEvent.PlayerPosition(position)
	-- body
	Player.LogWarning(position)
	if Player._my_player_data and Player._my_player_data.position then
		local tempX = _position_index[position] - _position_index[Player._my_player_data.position]
		return tempX
	end
	return nil
end

function ClickEvent.SetRemainNum( paiRemainNum )
 	-- body
 	ClickEvent._play_ui.remainNum.text = tostring(paiRemainNum)
 end 

function ClickEvent.RoomInformationUpdate(sync_type)
	-- body
	--0915 fixed
	if not Player._my_player_data.position or Player._my_player_data.position == "POSITION_TYPE_NULL" then
		return
	end

	Player.LogWarning(Player._my_player_data.position)
	local x = _position_index[Player._my_player_data.position]
	for k,v in pairs(_position_index) do
		if v >= x then
			_position_index[k] = v - x + 1
		else
			_position_index[k] = 5 + v - x
		end
	end
	for k,v in pairs(_position_index) do
		Player.LogWarning(k)
		Player.LogWarning(v)
	end
	ClickEvent._play_ui.behindPlayerAvatarInfo.visible = false
	ClickEvent._play_ui.oppositePlayerAvatarInfo.visible = false
	ClickEvent._play_ui.frontPlayerAvatarInfo.visible = false
	WeChatPlatform.func = nil
	WeChatPlatform:SetFuncDelegate(ClickEvent.UpdatePlayersHeadImg)
	local countPlayerNumber = 0
	for k,v in pairs(Player._all_players_data) do
		countPlayerNumber = countPlayerNumber + 1
		local tempX = _position_index[v.position] - _position_index[Player._my_player_data.position]
		if tempX == 1 then
			ClickEvent._play_ui.behindPlayerAvatarInfo.visible = true
			if v.position == "POSITION_TYPE_EAST" then
				ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("RoomLord").visible = true
			else
				ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("RoomLord").visible = false
			end
			if Player.isPlayBack == false then
				if v.oper_type == "GAME_OPER_TYPE_OFFLINE" then
					ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("PlayerLineState").visible = true
				else
					ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("PlayerLineState").visible = false
				end
			else
				ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("PlayerLineState").visible = false
			end
			if v.wechat and v.wechat.nickname and v.wechat.nickname ~= "" then
				ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("PlayerName").text = tostring(gbk.toutf8(gbk.fromutf8(v.wechat.nickname)))
			else
				ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("PlayerName").text = tostring(v.common_prop.name)
			end
			ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("DouNum").text = tostring(Player.playerScore[tempX])
			ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
			if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
				ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("AvatarLoader").url = ""
				local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
				if tempTexture then
					ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("AvatarLoader").texture = NTexture(tempTexture)
				end
			end
		elseif tempX == 2 then
			ClickEvent._play_ui.oppositePlayerAvatarInfo.visible = true
			if v.position == "POSITION_TYPE_EAST" then
				ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("RoomLord").visible = true
			else
				ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("RoomLord").visible = false
			end
			if Player.isPlayBack == false then
				if v.oper_type == "GAME_OPER_TYPE_OFFLINE" then
					ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("PlayerLineState").visible = true
				else
					ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("PlayerLineState").visible = false
				end
			else
				ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("PlayerLineState").visible = false
			end
			if v.wechat and v.wechat.nickname and v.wechat.nickname ~= "" then
				ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("PlayerName").text = tostring(gbk.toutf8(gbk.fromutf8(v.wechat.nickname)))
			else
				ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("PlayerName").text = tostring(v.common_prop.name)
			end
			ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("DouNum").text = tostring(Player.playerScore[tempX])
			ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
			if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
				ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("AvatarLoader").url = ""
				local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
				if tempTexture then
					ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("AvatarLoader").texture = NTexture(tempTexture)
				end
			end
		elseif tempX == 3 then
			ClickEvent._play_ui.frontPlayerAvatarInfo.visible = true
			if v.position == "POSITION_TYPE_EAST" then
				ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("RoomLord").visible = true
			else
				ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("RoomLord").visible = false
			end
			if Player.isPlayBack == false then
				if v.oper_type == "GAME_OPER_TYPE_OFFLINE" then
					ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("PlayerLineState").visible = true
				else
					ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("PlayerLineState").visible = false
				end
			else
				ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("PlayerLineState").visible = false
			end
			if v.wechat and v.wechat.nickname and v.wechat.nickname ~= "" then
				ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("PlayerName").text = tostring(gbk.toutf8(gbk.fromutf8(v.wechat.nickname)))
			else
				ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("PlayerName").text = tostring(v.common_prop.name)
			end
			ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("DouNum").text = tostring(Player.playerScore[tempX])
			ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
			if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
				ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("AvatarLoader").url = ""
				local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
				if tempTexture then
					ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("AvatarLoader").texture = NTexture(tempTexture)
				end
			end
		else
			ClickEvent._play_ui.playerAvatarInfo.visible = true
			if v.position == "POSITION_TYPE_EAST" then
				ClickEvent._play_ui.playerAvatarInfo:GetChild("RoomLord").visible = true
			else
				ClickEvent._play_ui.playerAvatarInfo:GetChild("RoomLord").visible = false
			end
			if Player.isPlayBack == false then
				if v.oper_type == "GAME_OPER_TYPE_OFFLINE" then
					ClickEvent._play_ui.playerAvatarInfo:GetChild("PlayerLineState").visible = true
				else
					ClickEvent._play_ui.playerAvatarInfo:GetChild("PlayerLineState").visible = false
				end
			else
				ClickEvent._play_ui.playerAvatarInfo:GetChild("PlayerLineState").visible = false
			end
			if v.wechat and v.wechat.nickname and v.wechat.nickname ~= "" then
				ClickEvent._play_ui.playerAvatarInfo:GetChild("PlayerName").text = gbk.toutf8(gbk.fromutf8(v.wechat.nickname))
			else
				ClickEvent._play_ui.playerAvatarInfo:GetChild("PlayerName").text = v.common_prop.name
			end
			ClickEvent._play_ui.playerAvatarInfo:GetChild("DouNum").text = tostring(Player.playerScore[0])
			ClickEvent._play_ui.playerAvatarInfo:GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
			Player.LogWarning(v.wechat.headimgurl)
			if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
				ClickEvent._play_ui.playerAvatarInfo:GetChild("AvatarLoader").url = ""
				local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
				--[[
				local headimgurl = v.wechat.headimgurl
				WeChatPlatform.func = function ()
					-- body
					local delegateTex = WeChatPlatform:SetAsyncImage(headimgurl)
					if delegateTex then
						ClickEvent._play_ui.playerAvatarInfo:GetChild("AvatarLoader").texture = NTexture(delegateTex)
					end
				end
				--]]
				if tempTexture then
					ClickEvent._play_ui.playerAvatarInfo:GetChild("AvatarLoader").texture = NTexture(tempTexture)
				end
			end
		end
	end
	if Player.isPlayBack == false then
		if countPlayerNumber >= 4 and ClickEvent._play_ui.playerAlready.visible == false then
			if Player.hasBeginned == true then
				Player.LogWarning("buttonDisable")
				ClickEvent._play_ui.gamePlayButton.visible = false
			else
				Player.LogWarning(Player.canShowPlayButton)
				Player.LogWarning(Player.room_current_round)
				Player.LogWarning(Player._room_information.options.open_rands)
				if Player.canShowPlayButton and Player.canShowPlayButton == true and Player.room_current_round < Player._room_information.options.open_rands then
					Player.LogWarning("showButton")
					ClickEvent._play_ui.gamePlayButton.visible = true
				end
			end
			ClickEvent._play_ui.inviteWechatFriends.visible = false
			ClickEvent._play_ui.copyRoomNum.visible = false
		end
	end
end

function ClickEvent.UpdatePlayersHeadImg( ... )
	-- body
	for k,v in pairs(Player._all_players_data) do
		local tempX = _position_index[v.position] - _position_index[Player._my_player_data.position]
		if tempX == 1 then
			ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
			if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
				ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("AvatarLoader").url = ""
				local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
				if tempTexture then
					ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("AvatarLoader").texture = NTexture(tempTexture)
				end
			end
		elseif tempX == 2 then
			ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
			if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
				ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("AvatarLoader").url = ""
				local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
				if tempTexture then
					ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("AvatarLoader").texture = NTexture(tempTexture)
				end
			end
		elseif tempX == 3 then
			ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
			if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
				ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("AvatarLoader").url = ""
				local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
				if tempTexture then
					ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("AvatarLoader").texture = NTexture(tempTexture)
				end
			end
		else
			ClickEvent._play_ui.playerAvatarInfo:GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
			if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
				ClickEvent._play_ui.playerAvatarInfo:GetChild("AvatarLoader").url = ""
				local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
				if tempTexture then
					ClickEvent._play_ui.playerAvatarInfo:GetChild("AvatarLoader").texture = NTexture(tempTexture)
				end
			end
		end
	end
end

function ClickEvent.BankerStarShow( ... )
	-- body
	ClickEvent._play_ui.changeZhuang.visible = true
	local co = coroutine.create(function()
    yield_return(CS.UnityEngine.WaitForSeconds(0.8))
    ClickEvent._play_ui.changeZhuang.visible = false
	end)
	coroutine.resume(co)
end

function ClickEvent.BankerStateUpdate(bankerPos)
	-- body
	Player.MahJong.UpdateWhoseTurn(bankerPos)
	local isLianZhuang = false
	if Player._banker_position and Player._banker_position == ClickEvent.PlayerPosition(bankerPos) then
		isLianZhuang = true
	end
	Player._banker_position = ClickEvent.PlayerPosition(bankerPos)
	ClickEvent._play_ui.zhuangStarItem.visible = true
	if Player.room_current_round == 0 then
		if Player._banker_position == 0 then
			_currentPanel.panel:GetTransition("ZhuangStart"):Play(ClickEvent.BankerStarShow)
		elseif Player._banker_position == 1 then
			_currentPanel.panel:GetTransition("ZhuangBehind"):Play(ClickEvent.BankerStarShow)
		elseif Player._banker_position == 2 then
			_currentPanel.panel:GetTransition("ZhuangOpposite"):Play(ClickEvent.BankerStarShow)
		elseif Player._banker_position == 3 then
			_currentPanel.panel:GetTransition("ZhuangFront"):Play(ClickEvent.BankerStarShow)
		else
			Player.LogWarning("bankerPos nil")
		end
	else
		if isLianZhuang == false then
			if Player._banker_position == 0 then
				_currentPanel.panel:GetTransition("ZhuangFtoP"):Play(ClickEvent.BankerStarShow)
			elseif Player._banker_position == 1 then
				_currentPanel.panel:GetTransition("ZhuangPtoB"):Play(ClickEvent.BankerStarShow)
			elseif Player._banker_position == 2 then
				_currentPanel.panel:GetTransition("ZhuangBtoO"):Play(ClickEvent.BankerStarShow)
			elseif Player._banker_position == 3 then
				_currentPanel.panel:GetTransition("ZhuangOtoF"):Play(ClickEvent.BankerStarShow)
			else
				Player.LogWarning("bankerPos nil")
			end
		end
	end
	if Player._banker_position == 0 then
		--[[
		ClickEvent._play_ui.selfBanker.visible = true
		ClickEvent._play_ui.nextBanker.visible = false
		ClickEvent._play_ui.oppositeBanker.visible = false
		ClickEvent._play_ui.forwardBanker.visible = false
		--]]
		Player.MahJong.SetModelPoolFrontPointer(Player.MahJong.GetModelPoolFrontPointer() + 34*2)
	elseif Player._banker_position == 1 then
		--[[
		ClickEvent._play_ui.selfBanker.visible = false
		ClickEvent._play_ui.nextBanker.visible = true
		ClickEvent._play_ui.oppositeBanker.visible = false
		ClickEvent._play_ui.forwardBanker.visible = false
		--]]
		Player.MahJong.SetModelPoolFrontPointer(Player.MahJong.GetModelPoolFrontPointer() + 34)
	elseif Player._banker_position == 2 then
		--[[
		ClickEvent._play_ui.selfBanker.visible = false
		ClickEvent._play_ui.nextBanker.visible = false
		ClickEvent._play_ui.oppositeBanker.visible = true
		ClickEvent._play_ui.forwardBanker.visible = false
		--]]
		Player.MahJong.SetModelPoolFrontPointer(Player.MahJong.GetModelPoolFrontPointer())
	elseif Player._banker_position == 3 then
		--[[
		ClickEvent._play_ui.selfBanker.visible = false
		ClickEvent._play_ui.nextBanker.visible = false
		ClickEvent._play_ui.oppositeBanker.visible = false
		ClickEvent._play_ui.forwardBanker.visible = true
		--]]
		Player.MahJong.SetModelPoolFrontPointer(Player.MahJong.GetModelPoolFrontPointer() + 34*3)
	else
		Player.LogWarning("bankerPos nil")
	end
end

function ClickEvent.PaiOperationState()
	-- body
	local xuanfengCount = 0
	local angangCount = 0
	local tingpaiCount = 0
	Player._ting_pai_cache = {}
	if Player._operation_alert_cache.pais then
		for k,v in pairs(Player._operation_alert_cache.pais) do
			for j,m in pairs(v.oper_list) do
				if m == "PAI_OPER_TYPE_ANGANGPAI" or m == "PAI_OPER_TYPE_GANGPAI" then
					angangCount = angangCount + 1
				elseif m == "PAI_OPER_TYPE_XUANFENG_FENG" or m == "PAI_OPER_TYPE_XUANFENG_JIAN" then
					xuanfengCount = xuanfengCount + 1
				elseif m == "PAI_OPER_TYPE_TINGPAI" then
					if v.pai and v.pai.card_value then
						tingpaiCount = tingpaiCount + 1
						Player._ting_pai_cache[tingpaiCount] = {}
						Player._ting_pai_cache[tingpaiCount].card_type = v.pai.card_type
						Player._ting_pai_cache[tingpaiCount].card_value = v.pai.card_value
					end
				end
			end
		end
	end

    for k,v in pairs(Player._operation_alert_cache.pais) do
    	for j,m in pairs(v.oper_list) do
	    	Player.LogWarning(m)
	    	ClickEvent._play_ui.passButton.visible = true
			if m == "PAI_OPER_TYPE_HUPAI" then
				Player.isQiangGangAlert = false
				ClickEvent.AddOperationButton("GameHuButton")
		        --Player.MahJong.SetCurrentState(operationState.HU)
		    elseif m == "PAI_OPER_TYPE_QIANGGANG" then
		    	Player.isQiangGangAlert = true
		    	ClickEvent.AddOperationButton("GameHuButton")
			elseif m == "PAI_OPER_TYPE_GANGPAI" then
				ClickEvent.AddOperationButton("GameGangButton")
		        Player.MahJong.SetCurrentState(operationState.GANG)
		        Player.MahJong.ShowMabeOperationEffect()
			elseif m == "PAI_OPER_TYPE_PENGPAI" then
				ClickEvent.AddOperationButton("GamePengButton")
		        Player.MahJong.SetCurrentState(operationState.PENG)
		        Player.MahJong.ShowMabeOperationEffect()
			elseif m == "PAI_OPER_TYPE_CHIPAI" then
				ClickEvent.AddOperationButton("GameChiButton")
				Player.MahJong.SetCurrentState(operationState.CHI)
				Player.MahJong.ShowMabeOperationEffect()
			elseif m == "PAI_OPER_TYPE_ANGANGPAI" then
				Player.LogWarning("ANGANG")
				--Player.MahJong.SetCurrentState(operationState.ANGANG)
				if xuanfengCount == 0 then
					ClickEvent.AddOperationButton("GameGangButton")
				end
			elseif m == "PAI_OPER_TYPE_XUANFENG_FENG" then
				Player.LogWarning("XuanFengButton")
				--Player.MahJong.SetCurrentState(operationState.XUANFENGGANGFENG)
				if xuanfengCount > 1 then
					v.pai.card_type = "CARD_TYPE_FENG"
					v.pai.card_value = 1
					Player.MahJong.CreateGangPai(v.pai,true)
				else
					ClickEvent.AddOperationButton("XuanFengButton")
				end
			elseif m == "PAI_OPER_TYPE_XUANFENG_JIAN" then
				Player.LogWarning("XuanFengButton")
				--Player.MahJong.SetCurrentState(operationState.XUANFENGGANGJIAN)
				if xuanfengCount > 1 then
					v.pai.card_type = "CARD_TYPE_JIAN"
					v.pai.card_value = 1
					Player.MahJong.CreateGangPai(v.pai,true)
				else
					ClickEvent.AddOperationButton("XuanFengButton")
				end
			elseif m == "PAI_OPER_TYPE_TINGPAI" then
				Player.LogWarning("tingpai")
				if MahJong.ShouldTingPai() == true then
					Player.MahJong.SetCurrentState(operationState.TINGPAI)
				end
			elseif m == "PAI_OPER_TYPE_BAOPAI" then
				
			else
		    	ClickEvent._play_ui.passButton.visible = false
				Player.LogWarning("PAI_OPER_TYPE_BEGIN ")
				Player.LogWarning(ClickEvent.MahJong.GetCurrentState())
			end
    	end
    end
    Player.LogWarning("tingpaiCount"..tingpaiCount)
    if tingpaiCount > 0 and MahJong.ShouldTingPai() == true then
    	ClickEvent._play_ui.cancelButton.visible = true
    	ClickEvent._play_ui.passButton.visible = false
		ClickEvent.AddOperationButton("GameTingButton")
    end
    Player.MahJong.SetStateTable({})
end

function ClickEvent.ErrorChangeTable(errorCode)
	-- body
	local errorTable = {
		ERROR_SUCCESS = 0,
		ERROR_INNER = 1,
		ERROR_DIAMOND_NOT_ENOUGH = 2,
		ERROR_HUANLEDOU_NOT_ENOUGH = 3,
		ERROR_INVENTORY_FULL = 4,
		ERROR_REWARD_HAS_GOT = 5,
		ERROR_HUANLEDOU_LIMIT = 6,
		ERROR_MALL_NOT_FOUND = 7,
		ERROR_ACTIVITY_NOT_OPEN = 8,
		ERROR_CLIENT_DATA = 9,
		ERROR_HAS_NO_PLAYER = 10,
		ERROR_DATABASE = 11,
		ERROR_ROOM_CARD_NOT_ENOUGH = 12,

		ERROR_ROOM_NOT_FOUNT = 20,
		ERROR_ROOM_PASSWORD = 21,
		ERROR_ROOM_IS_FULL = 22,
		ERROR_ROOM_NOT_AVAILABLE = 23,
		ERROR_ROOM_NO_PERMISSION = 24,
		ERROR_ROOM_BEANS_MIN_LIMIT = 25,
		ERROR_ROOM_BEANS_MAX_LIMIT = 26,
		ERROR_ROOM_TYPE_NOT_FOUND = 27,
		ERROR_ROOM_HAS_BEEN_IN = 28,
		ERROR_ROOM_GUEST_FORBID_ENTER = 29,
		ERROR_ROOM_CARD_GAMES_FULL = 30,
		ERROR_ROOM_DISMISS_COOLDOWN = 31,
		ERROR_ROOM_BEEN_OVER = 32,
		ERROR_ROOM_BEEN_DISMISS = 33,
		
		ERROR_GAME_NO_PERMISSION = 40,
		ERROR_GAME_PAI_UNSATISFIED = 41,
		
		ERROR_COMMON_REWARD_DATA = 50,
		ERROR_COMMON_REWARD_HAS_GOT = 51,
	}
	fSwitch = errorTable[errorCode]
	if fSwitch then
		return fSwitch
	else
		return -1
	end
end

function ClickEvent.ShowToast(content)
	-- body
	if CS.UnityEngine.SceneManagement.SceneManager.GetActiveScene().name == "PlaySence" then
		ClickEvent.PopPanel(ClickEvent.panelTable._toast_ui,true)
	else
		ClickEvent.PopPanel(ClickEvent.panelTable._toast_ui)
	end
	_popPanel[popPanelIndex].panel:GetTransition("ToastMove"):Play(ClickEvent.CloseToast)
	if popPanelIndex > 0 and _popPanel[popPanelIndex] then
		if _popPanel[popPanelIndex].panel and _popPanel[popPanelIndex].panel:GetChild("n0") then
			_popPanel[popPanelIndex].panel:GetChild("n0"):GetChild("Text").text = content
		end
		--[[
		if ClickEvent.ErrorChangeTable(content) ~= -1 then
		else
			if _popPanel[popPanelIndex].panel and _popPanel[popPanelIndex].panel:GetChild("n0") then
				_popPanel[popPanelIndex].panel:GetChild("n0"):GetChild("Text").text = content
			end
		end
		--]]
	end
end

function ClickEvent.CloseToast( ... )
	-- body
	ClickEvent.CloseByName(ClickEvent.panelTable._toast_ui)
end

function ClickEvent.ShowNotMoveToast(content,deleteTime)
	-- body
	--ClickEvent.Close()
	ClickEvent.PopPanel(ClickEvent.panelTable._not_move_toast_ui)
	_popPanel[popPanelIndex].panel:GetChild("n0"):GetChild("Text").text = StringTable.Get(content)
	if deleteTime then
		local co = coroutine.create(function()
	    yield_return(CS.UnityEngine.WaitForSeconds(deleteTime))
	    ClickEvent.CloseByName( ClickEvent.panelTable._not_move_toast_ui )
		end)
		coroutine.resume(co)
	end
end

function ClickEvent.ShowChiButton()
	-- body
	ClickEvent.AddOperationButton("GameChiButton")
end

function ClickEvent.PopPanelShowText(textName,content)
	-- body
	if popPanelIndex > 0 then
		_popPanel[popPanelIndex].panel:GetChild(textName).text = content
	end
end

function ClickEvent.PopPanel( panelName , noBack)
	-- body
	if not ClickEvent._createObject["Bg"] then
		ClickEvent._createObject["Bg"] = {}
	end
	local hasUIIndex = 0
	for i=1,popPanelIndex do
		if _popPanel[i].panel.name == panelName then
			hasUIIndex = i
		end
	end
	if not ClickEvent._createObject[panelName] then
		ClickEvent._createObject[panelName] = UIPackage.CreateObject("MXUI", panelName)
	end
	--ClickEvent.Close()
	if _popPanel[popPanelIndex] and _popPanel[popPanelIndex].panel and panelName == _popPanel[popPanelIndex].panel.name then
		return true
	end
	if hasUIIndex > 0 then
		local tempUI = _popPanel[hasUIIndex]
		for i=hasUIIndex,popPanelIndex-1 do
			_popPanel[i] = _popPanel[i+1]
		end
		_popPanel[popPanelIndex] = tempUI
		if _popPanel[popPanelIndex].background and ClickEvent.self:IsNull(_popPanel[popPanelIndex].background) == false then
			GRoot.inst:AddChild(_popPanel[popPanelIndex].background)
		end
		GRoot.inst:AddChild(_popPanel[popPanelIndex].panel)
		return
	end

	popPanelIndex = popPanelIndex + 1
	_popPanel[popPanelIndex] = {}
	if not noBack then
		if popBgIndex <= 0 or not ClickEvent._createObject["Bg"][popBgIndex] or ClickEvent._createObject["Bg"][popBgIndex].visible == true then
			popBgIndex = popBgIndex + 1
			if not ClickEvent._createObject["Bg"][popBgIndex] then
				ClickEvent._createObject["Bg"][popBgIndex] = UIPackage.CreateObject("MXUI", "Bg")
			end
		end
		_popPanel[popPanelIndex].background = ClickEvent._createObject["Bg"][popBgIndex]
		_popPanel[popPanelIndex].background:SetSize(GRoot.inst.width, GRoot.inst.height)
		_popPanel[popPanelIndex].background:Center()
		_popPanel[popPanelIndex].background:SetPosition(0,0,0)
		if panelName == ClickEvent.panelTable._calculate_ui then
			_popPanel[popPanelIndex].background.onTouchBegin:Add(ClickEvent.registerButtonDown)
			_popPanel[popPanelIndex].background.onTouchEnd:Add(ClickEvent.registerButtonUp)
		end
		_popPanel[popPanelIndex].background:GetChild("Di").visible  = true
		GRoot.inst:AddChild(_popPanel[popPanelIndex].background)
	end

	_popPanel[popPanelIndex].panel = ClickEvent._createObject[panelName]
	_popPanel[popPanelIndex].panel.name = panelName
	_popPanel[popPanelIndex].panel:SetSize(GRoot.inst.width, GRoot.inst.height)
	_popPanel[popPanelIndex].panel:Center()
	_popPanel[popPanelIndex].panel:SetPosition(0,0,0)
	GRoot.inst:AddChild(_popPanel[popPanelIndex].panel)
	--GRoot.inst:RemoveChild(_popPanel[popPanelIndex].panel)
	--GRoot.inst:AddChild(_popPanel[popPanelIndex].panel)
	local childNumber = _popPanel[popPanelIndex].panel.numChildren
	for i=0,childNumber-1 do
		local obj = _popPanel[popPanelIndex].panel:GetChildAt(i)
		if obj.group and obj.group.name == "Btns" then
			obj.onClick:Add(ClickEvent.registerButtonClick)
		end
	end
	if panelName == ClickEvent.panelTable._create_room_ui then
		local x = 1/ClickEvent.scale
		Effect.AddUIEffect(Effect._effect_name.button_ui,CS.UnityEngine.Vector3(100,100,100),_popPanel[popPanelIndex].panel:GetChild("CreateButton"),_popPanel[popPanelIndex].panel:GetChild("CreateButton").size/2)
	end
	return true
	--[[
	local image = _popPanel[popPanelIndex].background:GetChild("Di")
	LogWarning(image.displayObject.gameObject:GetComponent("Renderer").bounds.size.x)
	LogWarning(_currentPanel.panel:GetChild("Bg").displayObject.gameObject:GetComponent("Renderer").bounds.size.x)
	LogWarning(image.displayObject.size.x * ClickEvent.scale)
	if panelName == ClickEvent.panelTable._create_room_ui and addEffect then
		Effect.AddUIEffect("Effect_UI_button_02",CS.UnityEngine.Vector3(100,100,100),_popPanel[popPanelIndex].panel:GetChild("CreateButton"),image.displayObject.gameObject)
	end
	local tempObj = CS.UnityEngine.Resources.Load("UIPrefab/"..panelName)
	_popPanel[popPanelIndex].panel = CS.UnityEngine.Object.Instantiate(tempObj,ClickEvent.self.transform)
	_popPanel[popPanelIndex].panel.transform.localScale = CS.UnityEngine.Vector3.one
	_popPanel[popPanelIndex].eventTriggerListener = _popPanel[popPanelIndex].panel:GetComponent("EventTriggerListener")
	_popPanel[popPanelIndex].eventTriggerListener.onClick = ClickEvent.registerButtonClick
	_popPanel[popPanelIndex].buttonList = _popPanel[popPanelIndex].eventTriggerListener._buttons
	_popPanel[popPanelIndex].toggleList = _popPanel[popPanelIndex].eventTriggerListener._toggles
	--]]
end

function ClickEvent.DestroyPanel(gameObject)
	-- body
	CS.UnityEngine.Object.Destroy(gameObject)
	if _popPanel then
		_popPanel = {}
	else
		_currentPanel = {}
	end
end

function ClickEvent.ShowRoomCalculate( ... )
	-- body
	if not Player._room_calculate_data then
		return
	end
	ClickEvent.PopPanel(ClickEvent.panelTable._room_calculate_ui)
	if WeChatPlatform:isInstalledWX() == false then
		_popPanel[popPanelIndex].panel:GetChild("ShareRank").visible = false
	end
	local bigWinScore = nil
	local superPaoCount = nil
	for k,v in pairs(Player._room_calculate_data.record) do
		if not bigWinScore then
			bigWinScore = v.score
		end
		if not superPaoCount then
			superPaoCount = v.dianpao_count
		end
		if bigWinScore and bigWinScore < v.score then
			bigWinScore = v.score
		end
		if superPaoCount and superPaoCount < v.dianpao_count then
			superPaoCount = v.dianpao_count
		end
	end
	local bigWinScoreNumber = 0
	local superPaoCountNumber = 0
	for k,v in pairs(Player._room_calculate_data.record) do
		if v.score == bigWinScore and v.score ~= 0 then
			bigWinScoreNumber = bigWinScoreNumber + 1
		end
		if v.dianpao_count == superPaoCount and v.dianpao_count ~= 0 then
			superPaoCountNumber = superPaoCountNumber + 1
		end
	end
	--_popPanel[popPanelIndex].panel:GetChild("ShareRank").visible = false
	local listObj = _popPanel[popPanelIndex].panel:GetChild("FinishBalanceList")
	listObj:RemoveChildrenToPool()
	for k,v in pairs(Player._room_calculate_data.record) do
		local obj = listObj:AddItemFromPool(UIPackage.GetItemURL("MXUI","FinishBalanceUnit"))
		obj.name = "FinishBalanceUnit"
		obj:GetChild("UserID").text = tostring(v.player_id)
		obj:GetChild("Name").text = tostring(gbk.toutf8(gbk.fromutf8(v.nickname)))
		obj:GetChild("RoundNum").text = tostring(v.pk_count)
		obj:GetChild("BankerNum").text = tostring(v.banker_count)
		obj:GetChild("WinNum").text = tostring(v.win_count)
		obj:GetChild("PaoNum").text = tostring(v.dianpao_count)
		obj:GetChild("LouBaoNum").text = tostring(v.loubao_count)
		obj:GetChild("JinBaoNum").text = tostring(v.jinbao_count)
		obj:GetChild("TotalNum").text = tostring(v.score)
		obj:GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
		if v.headimgurl and v.headimgurl ~= "" then
			local delegateTex = WeChatPlatform:SetAsyncImage(v.headimgurl)
			if delegateTex then
				obj:GetChild("AvatarLoader").url = ""
				obj:GetChild("AvatarLoader").texture = NTexture(delegateTex)
			end
		end

		for j,c in pairs(Player._all_players_data) do
			if v.player_id == c.common_prop.player_id then
				if c.position == "POSITION_TYPE_EAST" then
					obj:GetChild("RoomLord").visible = true
				else
					obj:GetChild("RoomLord").visible = false
				end
			end
		end

		if superPaoCountNumber > 0 and superPaoCountNumber <= 2 and v.dianpao_count >= superPaoCount then
			obj:GetChild("MedalLoader").url = UIPackage.GetItemURL("MXUI","tubiao_paoshen")
		end
		if bigWinScoreNumber > 0 and bigWinScoreNumber <= 2 and v.score >= bigWinScore then
			obj:GetChild("MedalLoader").url = UIPackage.GetItemURL("MXUI","tubiao_dayingjia")
		end
	end
end

function ClickEvent.ShareRank( ... )
	-- body
	ClickEvent.Close()
	ClickEvent.PopPanel(ClickEvent.panelTable._share_calculate_ui)
	local scoreList = _popPanel[popPanelIndex].panel:GetChild("HistoryShareList")
	scoreList:RemoveChildrenToPool()
	local countScore = {}
	for i=1,4 do
		countScore[i] = {}
		countScore[i].nickname = ""
		countScore[i].headimgurl = ""
		countScore[i].allScore = 0
		countScore[i].roundNumber = 0
		countScore[i].bigWinShow = 0
		countScore[i].player_id = 0
	end

	local bigWinScore = nil
	local superPaoCount = nil
	for k,v in pairs(Player._room_calculate_data.record) do
		if not bigWinScore then
			bigWinScore = v.score
		end
		if not superPaoCount then
			superPaoCount = v.dianpao_count
		end
		if bigWinScore and bigWinScore < v.score then
			bigWinScore = v.score
		end
		if superPaoCount and superPaoCount < v.dianpao_count then
			superPaoCount = v.dianpao_count
		end
	end
	local bigWinScoreNumber = 0
	local superPaoCountNumber = 0
	for k,v in pairs(Player._room_calculate_data.record) do
		if v.score == bigWinScore and v.score ~= 0 then
			bigWinScoreNumber = bigWinScoreNumber + 1
		end
		if v.dianpao_count == superPaoCount and v.dianpao_count ~= 0 then
			superPaoCountNumber = superPaoCountNumber + 1
		end
	end

	local playerNumber = 1
	for k,v in pairs(Player._room_calculate_data.record) do
		countScore[playerNumber].nickname = gbk.toutf8(gbk.fromutf8(v.nickname))
		countScore[playerNumber].headimgurl = v.headimgurl
		countScore[playerNumber].allScore = v.score
		countScore[playerNumber].roundNumber = v.pk_count
		countScore[playerNumber].player_id = v.player_id
		if superPaoCountNumber > 0 and superPaoCountNumber <= 2 and v.dianpao_count >= superPaoCount then
			countScore[playerNumber].bigWinShow = 1
		end
		if bigWinScoreNumber > 0 and bigWinScoreNumber <= 2 and v.score >= bigWinScore then
			countScore[playerNumber].bigWinShow = 2
		end
		playerNumber = playerNumber + 1
	end
	for i=1,4 do
		local tempTable = {}
		for j=i,4 do
			if countScore[i].allScore < countScore[j].allScore then
				tempTable = countScore[i]
				countScore[i] = countScore[j]
				countScore[j] = tempTable
			end
		end
	end
	for i=1,4 do
		local obj = scoreList:AddItemFromPool(UIPackage.GetItemURL("MXUI","VipNoteListInTotal"))
		obj.name = "VipNoteListInTotal"
		--obj:GetChild("Rank").text = tostring(i)
		if countScore[i].allScore < 0 then
			local loseFont = obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").textFormat
			loseFont.font = UIPackage.GetItemURL("MXUI","LoseFont")
			obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").textFormat = loseFont
			obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").text = tostring(countScore[i].allScore)
		else
			local winFont = obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").textFormat
			winFont.font = UIPackage.GetItemURL("MXUI","WinFont")
			obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").textFormat = winFont
			obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").text = tostring(countScore[i].allScore)
		end
		obj:GetChild("VipNoteListTotalUnit"):GetChild("PlayerName").text = tostring(countScore[i].nickname)
		if countScore[i].headimgurl and countScore[i].headimgurl ~= "" then
			local tempTexture = WeChatPlatform:SetAsyncImage(countScore[i].headimgurl)
			if tempTexture then
				obj:GetChild("VipNoteListTotalUnit"):GetChild("AvatarLoader").texture = NTexture(tempTexture)
			end
		end
		obj:GetChild("VipNoteListTotalUnit"):GetChild("PlayerID").text = tostring(countScore[i].player_id)
		if countScore[i].bigWinShow == 1 then
			obj:GetChild("VipNoteListTotalUnit"):GetChild("MedalLoaderSmall").url = UIPackage.GetItemURL("MXUI","tubiao_paoshen")
		elseif countScore[i].bigWinShow == 2 then
			obj:GetChild("VipNoteListTotalUnit"):GetChild("MedalLoaderSmall").url = UIPackage.GetItemURL("MXUI","tubiao_dayingjia")
		else
			obj:GetChild("VipNoteListTotalUnit"):GetChild("MedalLoaderSmall").url = ""
		end
		--[[
		if i == 1 then
			obj:GetChild("No1").visible = true
		else
			obj:GetChild("No1").visible = false
		end
		--]]
	end
	_popPanel[popPanelIndex].panel:GetChild("RoomIDText").text = tostring(Player._roomId)
	_popPanel[popPanelIndex].panel:GetChild("TotalRoundNum").text = tostring(countScore[1].roundNumber)
	local nowTime = os.time()
	local year,month,day = ClickEvent.ChangeSecondToDate(nowTime)
	local hour,minute = ClickEvent.ChangeSecondToTime(nowTime)
	_popPanel[popPanelIndex].panel:GetChild("RoomDate").text = tostring(year).."/"..tostring(month).."/"..tostring(day)
	_popPanel[popPanelIndex].panel:GetChild("RoomTime").text = tostring(hour)..":"..tostring(minute)
	Player.CmdMatTrackCutomKVEvent("Share","Round","1")
end

function ClickEvent.ShareToWeChatFriends( ... )
	-- body
	Player.CmdMatTrackCutomKVEvent("Share","ShareToMoments","1")
	Player.isRewardShare = false
	local radio = CS.UnityEngine.Screen.width/CS.UnityEngine.Screen.height
	_popPanel[popPanelIndex].panel:GetChild("ShareToWeChatFriends").visible = false
	_popPanel[popPanelIndex].panel:GetChild("ShareToWeChat").visible = false
	_popPanel[popPanelIndex].panel:GetChild("GameBackButtonShare").visible = false
	WeChatPlatform:ShareTexture(StageCamera.main, CS.UnityEngine.Rect(0,0,600 * radio,600),2)
	_popPanel[popPanelIndex].panel:GetChild("ShareToWeChatFriends").visible = true
	_popPanel[popPanelIndex].panel:GetChild("ShareToWeChat").visible = true
	_popPanel[popPanelIndex].panel:GetChild("GameBackButtonShare").visible = true
end

function ClickEvent.ShareToWeChat( ... )
	-- body
	Player.CmdMatTrackCutomKVEvent("Share","ShareToFriend","1")
	Player.isRewardShare = false
	local radio = CS.UnityEngine.Screen.width/CS.UnityEngine.Screen.height
	_popPanel[popPanelIndex].panel:GetChild("ShareToWeChatFriends").visible = false
	_popPanel[popPanelIndex].panel:GetChild("ShareToWeChat").visible = false
	_popPanel[popPanelIndex].panel:GetChild("GameBackButtonShare").visible = false
	WeChatPlatform:ShareTexture(StageCamera.main, CS.UnityEngine.Rect(0,0,600 * radio,600),1)
	_popPanel[popPanelIndex].panel:GetChild("ShareToWeChatFriends").visible = true
	_popPanel[popPanelIndex].panel:GetChild("ShareToWeChat").visible = true
	_popPanel[popPanelIndex].panel:GetChild("GameBackButtonShare").visible = true
end

function ClickEvent.ExitRoomButton( ... )
	-- body
	--Player.returnMainUI = true
	Player.CmdGameOperation("GAME_OPER_TYPE_LEAVE")
	ClickEvent.Close()
	--Player.MahJong.QuitVoiceRoom()
	--Player.LoadScene("FairyMainUI")
end

function ClickEvent.ShowCalculate( ... )
	-- body
	if not Player._calculate_data or not Player._all_players_data or not Player._my_player_data.position then
		return
	end
	local myPosition = Player._my_player_data.position
	local currentPositionData
	ClickEvent.PopPanel(ClickEvent.panelTable._calculate_ui)
	Player.LogWarning("setTrue")
	Player.canShowPlayButton = true
	Player.isJinBao = false
	for k,v in pairs(Player._calculate_data.record.list) do
		for countKey,countNum in pairs(v.details) do
			if countNum.fan_type == "FAN_TYPE_JIN_BAO" then
				Player.isJinBao = true
			end
		end
	end

	if Player._banker_position then
		_popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("Zhuang").visible = false
		_popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("Zhuang").visible = false
		_popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("Zhuang").visible = false
		_popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("Zhuang").visible = false
		if Player._banker_position == 1 then
			_popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("Zhuang").visible = true
		elseif Player._banker_position == 2 then
			_popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("Zhuang").visible = true
		elseif Player._banker_position == 3 then
			_popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("Zhuang").visible = true
		else
			_popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("Zhuang").visible = true
		end
	end
	_popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("ClearState"):GetController("ClearState").selectedIndex = 2
	_popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("HuZhang").visible = false
	_popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("ClearState"):GetController("ClearState").selectedIndex = 2
	_popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("HuZhang").visible = false
	_popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("ClearState"):GetController("ClearState").selectedIndex = 2
	_popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("HuZhang").visible = false
	_popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("ClearState"):GetController("ClearState").selectedIndex = 2
	_popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("HuZhang").visible = false

	if Player.room_current_round > 10 then
		_popPanel[popPanelIndex].panel:GetChild("ClearRoundTitle").text = "第0"..tostring(Player.room_current_round % 10).."局结算"
	else
		_popPanel[popPanelIndex].panel:GetChild("ClearRoundTitle").text = "第"..tostring(Player.room_current_round % 10).."局结算"
	end

	if Player._calculate_data.dianpao_player_position and Player._calculate_data.dianpao_player_position ~= "" and Player._calculate_data.dianpao_player_position ~= "POSITION_TYPE_NULL" then
		local dianpaoPosition = ClickEvent.PlayerPosition(Player._calculate_data.dianpao_player_position)
		if dianpaoPosition == 0 then
			_popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("ClearState"):GetController("ClearState").selectedIndex = 1
		elseif dianpaoPosition == 1 then
			_popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("ClearState"):GetController("ClearState").selectedIndex = 1
		elseif dianpaoPosition == 2 then
			_popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("ClearState"):GetController("ClearState").selectedIndex = 1
		elseif dianpaoPosition == 3 then
			_popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("ClearState"):GetController("ClearState").selectedIndex = 1
		end
	end
	if Player.huPaiPosition == 0 then
		_popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("ClearState"):GetController("ClearState").selectedIndex = 0
		_popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("HuZhang").visible = true
		_popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("HuZhang"):GetChild("BaoPaiLoader").url = UIPackage.GetItemURL("MXUI",Player.hupai_calculate_data.card_type.."_"..Player.hupai_calculate_data.card_value)
	elseif Player.huPaiPosition == 1 then
		_popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("ClearState"):GetController("ClearState").selectedIndex = 0
		_popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("HuZhang").visible = true
		_popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("HuZhang"):GetChild("BaoPaiLoader").url = UIPackage.GetItemURL("MXUI",Player.hupai_calculate_data.card_type.."_"..Player.hupai_calculate_data.card_value)
	elseif Player.huPaiPosition == 2 then
		_popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("ClearState"):GetController("ClearState").selectedIndex = 0
		_popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("HuZhang").visible = true
		_popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("HuZhang"):GetChild("BaoPaiLoader").url = UIPackage.GetItemURL("MXUI",Player.hupai_calculate_data.card_type.."_"..Player.hupai_calculate_data.card_value)
	elseif Player.huPaiPosition == 3 then
		_popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("ClearState"):GetController("ClearState").selectedIndex = 0
		_popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("HuZhang").visible = true
		_popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("HuZhang"):GetChild("BaoPaiLoader").url = UIPackage.GetItemURL("MXUI",Player.hupai_calculate_data.card_type.."_"..Player.hupai_calculate_data.card_value)
	else
	end

	if Player._calculate_data.baopai and Player._calculate_data.baopai ~= {} then
		_popPanel[popPanelIndex].panel:GetChild("BaoPai").visible = true
		_popPanel[popPanelIndex].panel:GetChild("BaoPai"):GetChild("WeiYaoBao").visible = false
		_popPanel[popPanelIndex].panel:GetChild("BaoPai"):GetChild("BaoPaiLoader").url = UIPackage.GetItemURL("MXUI",Player._calculate_data.baopai.card_type.."_"..Player._calculate_data.baopai.card_value)
	else
		_popPanel[popPanelIndex].panel:GetChild("BaoPai").visible = true
		_popPanel[popPanelIndex].panel:GetChild("BaoPai"):GetChild("WeiYaoBao").visible = true
		_popPanel[popPanelIndex].panel:GetChild("BaoPai"):GetChild("WeiYaoBao"):GetController("BackColor").selectedIndex = Player.paiSizeSet
	end
	for k,v in pairs(Player._calculate_data.record.list) do
		for j,m in pairs(Player._all_players_data) do
			if v.player_id == m.common_prop.player_id then
				currentPositionData = m
				break
			end
		end
		local tempX = _position_index[currentPositionData.position] - _position_index[myPosition]
		Player.playerScore[tempX] = Player.playerScore[tempX] + v.score
		if tempX == 1 then
			_popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("PlayerName").text = tostring(gbk.toutf8(gbk.fromutf8(v.nickname)))
			_popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("DouNum").text = tostring(v.score)
			_popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("PlayerID").text = tostring(v.player_id)

			local paiList = _popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("PaiList")
			paiList:RemoveChildrenToPool()
			for i=1,Player.operation_calculate_data[tempX].operationNumber do
				if Player.operation_calculate_data[1][i].oper_type == "PAI_OPER_TYPE_CHIPAI" or Player.operation_calculate_data[1][i].oper_type == "PAI_OPER_TYPE_PENGPAI" or Player.operation_calculate_data[1][i].oper_type == "PAI_OPER_TYPE_XUANFENG_JIAN" then
					local listChild = paiList:AddItemFromPool(UIPackage.GetItemURL("MXUI","ChiPaiInList"))
					for j=1,3 do
						listChild:GetChild("ChiPaiLoader0"..tostring(j)).url = UIPackage.GetItemURL("MXUI",Player.operation_calculate_data[tempX][i].card_type.."_"..Player.operation_calculate_data[tempX][i].card_value[j])
					end
				else
					local listChild = paiList:AddItemFromPool(UIPackage.GetItemURL("MXUI","GangPaiInList"))
					for j=1,4 do
						listChild:GetChild("ChiPaiLoader0"..tostring(j)).url = UIPackage.GetItemURL("MXUI",Player.operation_calculate_data[tempX][i].card_type.."_"..Player.operation_calculate_data[tempX][i].card_value[j])
					end
				end
			end
			local playerHandPaiList = paiList:AddItemFromPool(UIPackage.GetItemURL("MXUI","PaiSingleList"))
			local paiSingleList = playerHandPaiList:GetChild("PaiList")
			paiSingleList:RemoveChildrenToPool()
			for dataKey,data in pairs(Player.pai_push_down) do
				local playerPos = ClickEvent.PlayerPosition(data.position)
				if playerPos == 1 then
					for paiKey,paiData in pairs(data.pai_list) do
						for valueKay,value in pairs(paiData.cards) do
							if Player.isZiMo == true and Player.isJinBao == false and Player.huPaiPosition == 1 and Player.hupai_calculate_data.card_type == paiData.card_type and Player.hupai_calculate_data.card_value == value then
								Player.isZiMo = false
								Player.isJinBao = true
							else
								local singleChild = paiSingleList:AddItemFromPool(UIPackage.GetItemURL("MXUI","PaiSingleInList"))
								singleChild:GetChild("ChiPaiLoader01").url = UIPackage.GetItemURL("MXUI",paiData.card_type.."_"..value)
							end
						end
					end
				end
			end

			local allFanNumber = 0
			local gangScore = 0
			local detailList = _popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("FanList")
			detailList:RemoveChildrenToPool()
			local typeNumber = 0
			for countKey,countNum in pairs(v.details) do
				if countNum.fan_type ~= "FAN_TYPE_MING_GANG" and countNum.fan_type ~= "FAN_TYPE_AN_GANG" and countNum.fan_type ~= "FAN_TYPE_XUAN_FENG_GANG" then
					typeNumber = typeNumber + 1
				end
			end
			for i,c in pairs(v.details) do
				local fanName = ""
				local fanNum = 0
				for a,b in pairs(Player._calculate_table_loader) do
					for a1,b1 in pairs(b.fans) do
						if c.fan_type == b1.fan_type then
							fanName = b1.name
							fanNum = b1.multiple
							if c.fan_type ~= "FAN_TYPE_XUAN_FENG_GANG" then
								allFanNumber = allFanNumber + fanNum
							end
							break
						end
					end
				end
				if c.fan_type ~= "FAN_TYPE_MING_GANG" and c.fan_type ~= "FAN_TYPE_AN_GANG" and c.fan_type ~= "FAN_TYPE_XUAN_FENG_GANG" and c.fan_type ~= "FAN_TYPE_PINGHU" and fanNum == 0 then
					Player.LogWarning("0 fan")
				else
					if c.fan_type == "FAN_TYPE_PINGHU" and typeNumber ~= 1 then
						Player.LogWarning("many fantype")
					else
						local listChild = detailList:AddItemFromPool(_currentPanel.buttonList["ClearShowFan"])
						listChild.name = ""..i
						listChild:GetChild("FanName").text = gbk.toutf8(fanName)
						if c.fan_type == "FAN_TYPE_AN_GANG" or c.fan_type == "FAN_TYPE_MING_GANG" or c.fan_type == "FAN_TYPE_XUAN_FENG_GANG" then
							gangScore = gangScore + c.score
						end
						--[[
						--]]
					end
				end

				--[[
				if c.score < 0 then
					listChild:GetChild("FanDou").text = ""..c.score
				else
					listChild:GetChild("FanDou").text = "+"..c.score
				end
				--]]
				--listChild:GetChild("FanPlayer").text = "+"..c.score
			end
			_popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("TotalFanNum").text = tostring(allFanNumber)
			_popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("GangNum").text = tostring(gangScore)
			_popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("HuNum").text = tostring(v.score-gangScore)
		elseif tempX == 2 then
			_popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("PlayerName").text = tostring(gbk.toutf8(gbk.fromutf8(v.nickname)))
			_popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("DouNum").text = tostring(v.score)
			_popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("PlayerID").text = tostring(v.player_id)

			local paiList = _popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("PaiList")
			paiList:RemoveChildrenToPool()
			for i=1,Player.operation_calculate_data[tempX].operationNumber do
				if Player.operation_calculate_data[2][i].oper_type == "PAI_OPER_TYPE_CHIPAI" or Player.operation_calculate_data[2][i].oper_type == "PAI_OPER_TYPE_PENGPAI" or Player.operation_calculate_data[2][i].oper_type == "PAI_OPER_TYPE_XUANFENG_JIAN" then
					local listChild = paiList:AddItemFromPool(UIPackage.GetItemURL("MXUI","ChiPaiInList"))
					for j=1,3 do
						listChild:GetChild("ChiPaiLoader0"..tostring(j)).url = UIPackage.GetItemURL("MXUI",Player.operation_calculate_data[tempX][i].card_type.."_"..Player.operation_calculate_data[tempX][i].card_value[j])
					end
				else
					local listChild = paiList:AddItemFromPool(UIPackage.GetItemURL("MXUI","GangPaiInList"))
					for j=1,4 do
						listChild:GetChild("ChiPaiLoader0"..tostring(j)).url = UIPackage.GetItemURL("MXUI",Player.operation_calculate_data[tempX][i].card_type.."_"..Player.operation_calculate_data[tempX][i].card_value[j])
					end
				end
			end
			local playerHandPaiList = paiList:AddItemFromPool(UIPackage.GetItemURL("MXUI","PaiSingleList"))
			local paiSingleList = playerHandPaiList:GetChild("PaiList")
			paiSingleList:RemoveChildrenToPool()
			for dataKey,data in pairs(Player.pai_push_down) do
				local playerPos = ClickEvent.PlayerPosition(data.position)
				if playerPos == 2 then
					for paiKey,paiData in pairs(data.pai_list) do
						for valueKay,value in pairs(paiData.cards) do
							if Player.isZiMo == true and Player.isJinBao == false and Player.huPaiPosition == 2 and Player.hupai_calculate_data.card_type == paiData.card_type and Player.hupai_calculate_data.card_value == value then
								Player.isZiMo = false
								Player.isJinBao = true
							else
								local singleChild = paiSingleList:AddItemFromPool(UIPackage.GetItemURL("MXUI","PaiSingleInList"))
								singleChild:GetChild("ChiPaiLoader01").url = UIPackage.GetItemURL("MXUI",paiData.card_type.."_"..value)
							end
						end
					end
				end
			end

			local allFanNumber = 0
			local gangScore = 0
			local detailList = _popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("FanList")
			detailList:RemoveChildrenToPool()
			local typeNumber = 0
			for countKey,countNum in pairs(v.details) do
				if countNum.fan_type ~= "FAN_TYPE_MING_GANG" and countNum.fan_type ~= "FAN_TYPE_AN_GANG" and countNum.fan_type ~= "FAN_TYPE_XUAN_FENG_GANG" then
					typeNumber = typeNumber + 1
				end
			end
			for i,c in pairs(v.details) do
				local fanName = ""
				local fanNum = 0
				for a,b in pairs(Player._calculate_table_loader) do
					for a1,b1 in pairs(b.fans) do
						if c.fan_type == b1.fan_type then
							fanName = b1.name
							fanNum = b1.multiple
							if c.fan_type ~= "FAN_TYPE_XUAN_FENG_GANG" then
								allFanNumber = allFanNumber + fanNum
							end
							break
						end
					end
				end
				if c.fan_type ~= "FAN_TYPE_MING_GANG" and c.fan_type ~= "FAN_TYPE_AN_GANG" and c.fan_type ~= "FAN_TYPE_XUAN_FENG_GANG" and c.fan_type ~= "FAN_TYPE_PINGHU" and fanNum == 0 then
					Player.LogWarning("0 fan")
				else
					if c.fan_type == "FAN_TYPE_PINGHU" and typeNumber ~= 1 then
						Player.LogWarning("many fantype")
					else
						local listChild = detailList:AddItemFromPool(_currentPanel.buttonList["ClearShowFan"])
						listChild.name = ""..i
						listChild:GetChild("FanName").text = gbk.toutf8(fanName)
						if c.fan_type == "FAN_TYPE_AN_GANG" or c.fan_type == "FAN_TYPE_MING_GANG" or c.fan_type == "FAN_TYPE_XUAN_FENG_GANG" then
							gangScore = gangScore + c.score
						end
						--[[
						--]]
					end
				end

				--[[
				if c.score < 0 then
					listChild:GetChild("FanDou").text = ""..c.score
				else
					listChild:GetChild("FanDou").text = "+"..c.score
				end
				--]]
				--listChild:GetChild("FanPlayer").text = "+"..c.score
			end
			_popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("TotalFanNum").text = tostring(allFanNumber)
			_popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("GangNum").text = tostring(gangScore)
			_popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("HuNum").text = tostring(v.score-gangScore)
		elseif tempX == 3 then
			_popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("PlayerName").text = tostring(gbk.toutf8(gbk.fromutf8(v.nickname)))
			_popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("DouNum").text = tostring(v.score)
			_popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("PlayerID").text = tostring(v.player_id)

			local paiList = _popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("PaiList")
			paiList:RemoveChildrenToPool()
			for i=1,Player.operation_calculate_data[tempX].operationNumber do
				if Player.operation_calculate_data[3][i].oper_type == "PAI_OPER_TYPE_CHIPAI" or Player.operation_calculate_data[3][i].oper_type == "PAI_OPER_TYPE_PENGPAI" or Player.operation_calculate_data[3][i].oper_type == "PAI_OPER_TYPE_XUANFENG_JIAN" then
					local listChild = paiList:AddItemFromPool(UIPackage.GetItemURL("MXUI","ChiPaiInList"))
					for j=1,3 do
						listChild:GetChild("ChiPaiLoader0"..tostring(j)).url = UIPackage.GetItemURL("MXUI",Player.operation_calculate_data[tempX][i].card_type.."_"..Player.operation_calculate_data[tempX][i].card_value[j])
					end
				else
					local listChild = paiList:AddItemFromPool(UIPackage.GetItemURL("MXUI","GangPaiInList"))
					for j=1,4 do
						listChild:GetChild("ChiPaiLoader0"..tostring(j)).url = UIPackage.GetItemURL("MXUI",Player.operation_calculate_data[tempX][i].card_type.."_"..Player.operation_calculate_data[tempX][i].card_value[j])
					end
				end
			end
			local playerHandPaiList = paiList:AddItemFromPool(UIPackage.GetItemURL("MXUI","PaiSingleList"))
			local paiSingleList = playerHandPaiList:GetChild("PaiList")
			paiSingleList:RemoveChildrenToPool()
			for dataKey,data in pairs(Player.pai_push_down) do
				local playerPos = ClickEvent.PlayerPosition(data.position)
				if playerPos == 3 then
					for paiKey,paiData in pairs(data.pai_list) do
						for valueKay,value in pairs(paiData.cards) do
							if Player.isZiMo == true and Player.isJinBao == false and Player.huPaiPosition == 3 and Player.hupai_calculate_data.card_type == paiData.card_type and Player.hupai_calculate_data.card_value == value then
								Player.isZiMo = false
								Player.isJinBao = true
							else
								local singleChild = paiSingleList:AddItemFromPool(UIPackage.GetItemURL("MXUI","PaiSingleInList"))
								singleChild:GetChild("ChiPaiLoader01").url = UIPackage.GetItemURL("MXUI",paiData.card_type.."_"..value)
							end
						end
					end
				end
			end

			local allFanNumber = 0
			local gangScore = 0
			local detailList = _popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("FanList")
			detailList:RemoveChildrenToPool()
			local typeNumber = 0
			for countKey,countNum in pairs(v.details) do
				if countNum.fan_type ~= "FAN_TYPE_MING_GANG" and countNum.fan_type ~= "FAN_TYPE_AN_GANG" and countNum.fan_type ~= "FAN_TYPE_XUAN_FENG_GANG" then
					typeNumber = typeNumber + 1
				end
			end
			for i,c in pairs(v.details) do
				local fanName = ""
				local fanNum = 0
				for a,b in pairs(Player._calculate_table_loader) do
					for a1,b1 in pairs(b.fans) do
						if c.fan_type == b1.fan_type then
							fanName = b1.name
							fanNum = b1.multiple
							if c.fan_type ~= "FAN_TYPE_XUAN_FENG_GANG" then
								allFanNumber = allFanNumber + fanNum
							end
							break
						end
					end
				end
				if c.fan_type ~= "FAN_TYPE_MING_GANG" and c.fan_type ~= "FAN_TYPE_AN_GANG" and c.fan_type ~= "FAN_TYPE_XUAN_FENG_GANG" and c.fan_type ~= "FAN_TYPE_PINGHU" and fanNum == 0 then
					Player.LogWarning("0 fan")
				else
					if c.fan_type == "FAN_TYPE_PINGHU" and typeNumber ~= 1 then
						Player.LogWarning("many fantype")
					else
						local listChild = detailList:AddItemFromPool(_currentPanel.buttonList["ClearShowFan"])
						listChild.name = ""..i
						listChild:GetChild("FanName").text = gbk.toutf8(fanName)
						if c.fan_type == "FAN_TYPE_AN_GANG" or c.fan_type == "FAN_TYPE_MING_GANG" or c.fan_type == "FAN_TYPE_XUAN_FENG_GANG" then
							gangScore = gangScore + c.score
						end
						--[[
						--]]
					end
				end

				--[[
				if c.score < 0 then
					listChild:GetChild("FanDou").text = ""..c.score
				else
					listChild:GetChild("FanDou").text = "+"..c.score
				end
				--]]
				--listChild:GetChild("FanPlayer").text = "+"..c.score
			end
			_popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("TotalFanNum").text = tostring(allFanNumber)
			_popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("GangNum").text = tostring(gangScore)
			_popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("HuNum").text = tostring(v.score-gangScore)
		else
			_popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("PlayerName").text = tostring(gbk.toutf8(gbk.fromutf8(v.nickname)))
			_popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("DouNum").text = tostring(v.score)
			_popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("PlayerID").text = tostring(v.player_id)
			
			local paiList = _popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("PaiList")
			paiList:RemoveChildrenToPool()
			for i=1,Player.operation_calculate_data[0].operationNumber do
				if Player.operation_calculate_data[0][i].oper_type == "PAI_OPER_TYPE_CHIPAI" or Player.operation_calculate_data[0][i].oper_type == "PAI_OPER_TYPE_PENGPAI" or Player.operation_calculate_data[0][i].oper_type == "PAI_OPER_TYPE_XUANFENG_JIAN" then
					local listChild = paiList:AddItemFromPool(UIPackage.GetItemURL("MXUI","ChiPaiInList"))
					for j=1,3 do
						listChild:GetChild("ChiPaiLoader0"..tostring(j)).url = UIPackage.GetItemURL("MXUI",Player.operation_calculate_data[0][i].card_type.."_"..Player.operation_calculate_data[0][i].card_value[j])
					end
				else
					local listChild = paiList:AddItemFromPool(UIPackage.GetItemURL("MXUI","GangPaiInList"))
					for j=1,4 do
						listChild:GetChild("ChiPaiLoader0"..tostring(j)).url = UIPackage.GetItemURL("MXUI",Player.operation_calculate_data[0][i].card_type.."_"..Player.operation_calculate_data[0][i].card_value[j])
					end
				end
			end
			local playerHandPaiList = paiList:AddItemFromPool(UIPackage.GetItemURL("MXUI","PaiSingleList"))
			local paiSingleList = playerHandPaiList:GetChild("PaiList")
			paiSingleList:RemoveChildrenToPool()
			for dataKey,data in pairs(Player.pai_push_down) do
				local playerPos = ClickEvent.PlayerPosition(data.position)
				if playerPos == 0 then
					for paiKey,paiData in pairs(data.pai_list) do
						for valueKay,value in pairs(paiData.cards) do
							if Player.isZiMo == true and Player.isJinBao == false and Player.huPaiPosition == 0 and Player.hupai_calculate_data.card_type == paiData.card_type and Player.hupai_calculate_data.card_value == value then
								Player.isZiMo = false
								Player.isJinBao = true
							else
								local singleChild = paiSingleList:AddItemFromPool(UIPackage.GetItemURL("MXUI","PaiSingleInList"))
								singleChild:GetChild("ChiPaiLoader01").url = UIPackage.GetItemURL("MXUI",paiData.card_type.."_"..value)
							end
						end
					end
				end
			end

			local allFanNumber = 0
			local gangScore = 0
			local detailList = _popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("FanList")
			detailList:RemoveChildrenToPool()
			local typeNumber = 0
			for countKey,countNum in pairs(v.details) do
				if countNum.fan_type ~= "FAN_TYPE_MING_GANG" and countNum.fan_type ~= "FAN_TYPE_AN_GANG" and countNum.fan_type ~= "FAN_TYPE_XUAN_FENG_GANG" then
					typeNumber = typeNumber + 1
				end
			end
			for i,c in pairs(v.details) do
				local fanName = ""
				local fanNum = 0
				for a,b in pairs(Player._calculate_table_loader) do
					for a1,b1 in pairs(b.fans) do
						if c.fan_type == b1.fan_type then
							fanName = b1.name
							fanNum = b1.multiple
							if c.fan_type ~= "FAN_TYPE_XUAN_FENG_GANG" then
								allFanNumber = allFanNumber + fanNum
							end
							break
						end
					end
				end
				if c.fan_type ~= "FAN_TYPE_MING_GANG" and c.fan_type ~= "FAN_TYPE_AN_GANG" and c.fan_type ~= "FAN_TYPE_XUAN_FENG_GANG" and c.fan_type ~= "FAN_TYPE_PINGHU" and fanNum == 0 then
					Player.LogWarning("0 fan")
				else
					if c.fan_type == "FAN_TYPE_PINGHU" and typeNumber ~= 1 then
						Player.LogWarning("many fantype")
					else
						local listChild = detailList:AddItemFromPool(_currentPanel.buttonList["ClearShowFan"])
						listChild.name = ""..i
						listChild:GetChild("FanName").text = gbk.toutf8(fanName)
						if c.fan_type == "FAN_TYPE_AN_GANG" or c.fan_type == "FAN_TYPE_MING_GANG" or c.fan_type == "FAN_TYPE_XUAN_FENG_GANG" then
							gangScore = gangScore + c.score
						end
						--[[
						--]]
					end
				end

				--[[
				if c.score < 0 then
					listChild:GetChild("FanDou").text = ""..c.score
				else
					listChild:GetChild("FanDou").text = "+"..c.score
				end
				--]]
				--listChild:GetChild("FanPlayer").text = "+"..c.score
			end
			_popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("TotalFanNum").text = tostring(allFanNumber)
			_popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("GangNum").text = tostring(gangScore)
			_popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("HuNum").text = tostring(v.score-gangScore)
		end
	end
	ClickEvent._play_ui.playerAvatarInfo:GetChild("DouNum").text = tostring(Player.playerScore[0])
	ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("DouNum").text = tostring(Player.playerScore[1])
	ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("DouNum").text = tostring(Player.playerScore[2])
	ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("DouNum").text = tostring(Player.playerScore[3])
	for k,v in pairs(Player._all_players_data) do
		local tempX = _position_index[v.position] - _position_index[Player._my_player_data.position]
		if tempX == 1 then
			if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
				_popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("AvatarLoader").url = ""
				local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
				if tempTexture then
					_popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("AvatarLoader").texture = NTexture(tempTexture)
				end
			else
				_popPanel[popPanelIndex].panel:GetChild("BehindPlayerClearInfo"):GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
			end
		elseif tempX == 2 then
			if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
				_popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("AvatarLoader").url = ""
				local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
				if tempTexture then
					_popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("AvatarLoader").texture = NTexture(tempTexture)
				end
			else
				_popPanel[popPanelIndex].panel:GetChild("OppositePlayerClearInfo"):GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
			end
		elseif tempX == 3 then
			if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
				_popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("AvatarLoader").url = ""
				local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
				if tempTexture then
					_popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("AvatarLoader").texture = NTexture(tempTexture)
				end
			else
				_popPanel[popPanelIndex].panel:GetChild("FrontPlayerClearInfo"):GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
			end
		else
			if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
				_popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("AvatarLoader").url = ""
				local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
				if tempTexture then
					_popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("AvatarLoader").texture = NTexture(tempTexture)
				end
			else
				_popPanel[popPanelIndex].panel:GetChild("MyClearInfo"):GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
			end
		end
	end
end

function ClickEvent.DapaiUIShow(position,card_type,card_value,isPlayBack)
	-- body
	local whichPlayer = ClickEvent.PlayerPosition(position)
	if whichPlayer == 1 then
		ClickEvent._play_ui.behindPaiShow:GetChild("PaiLoader").url = UIPackage.GetItemURL("MXUI",card_type.."_"..card_value)
		ClickEvent._play_ui.behindPaiShow.visible = true
		ClickEvent._play_ui.oppositePaiShow.visible = false
		ClickEvent._play_ui.frontPaiShow.visible = false
	elseif whichPlayer == 2 then
		ClickEvent._play_ui.oppositePaiShow:GetChild("PaiLoader").url = UIPackage.GetItemURL("MXUI",card_type.."_"..card_value)
		ClickEvent._play_ui.behindPaiShow.visible = false
		ClickEvent._play_ui.oppositePaiShow.visible = true
		ClickEvent._play_ui.frontPaiShow.visible = false
	elseif whichPlayer == 3 then
		ClickEvent._play_ui.frontPaiShow:GetChild("PaiLoader").url = UIPackage.GetItemURL("MXUI",card_type.."_"..card_value)
		ClickEvent._play_ui.behindPaiShow.visible = false
		ClickEvent._play_ui.oppositePaiShow.visible = false
		ClickEvent._play_ui.frontPaiShow.visible = true
	else
		Player.LogWarning("position nil")
	end
	if not isPlayBack then
		AudioPlayer.PlaySound(card_type.."_"..card_value,false,1,position)
	end
	AudioPlayer.PlaySound(AudioPlayer._audio_name.Dapai,false,1,position)
	Player.MahJong.DapaiUIHide(whichPlayer)
end

function ClickEvent.DapaiUIHide(position)
	-- body
	
	if position == 1 then
		ClickEvent._play_ui.behindPaiShow.visible = false
	elseif position == 2 then
		ClickEvent._play_ui.oppositePaiShow.visible = false
	elseif position == 3 then
		ClickEvent._play_ui.frontPaiShow.visible = false
	else
		Player.LogWarning("position nil")
	end
end

function ClickEvent.showDisconnect(content)
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
	_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(content)
end

function ClickEvent.ShowEmoji(position,chat_type,index)
	-- body
	local textureIndex = tostring(index)
	if index < 10 then
		textureIndex = "0"..tostring(index)
	end
	if chat_type == "CHAT_TYPE_TEXT" then
		AudioPlayer.PlaySound(AudioPlayer._audio_name.SayWords..tostring(index),false,1,position)
	end
	local whichPlayer = ClickEvent.PlayerPosition(position)
	if whichPlayer == 1 then
		ClickEvent._play_ui.behindEmoji.visible = true
		if chat_type == "CHAT_TYPE_TEXT" then
			ClickEvent._play_ui.behindEmoji:GetChild("icon").url = ""
			ClickEvent._play_ui.behindEmoji:GetChild("title").text = StringTable.Get(index+2059)
			ClickEvent._play_ui.behindEmoji:GetTransition("TextMove"):Play()
		else
			ClickEvent._play_ui.behindEmoji:GetChild("icon").url = UIPackage.GetItemURL("MXUI",textureIndex)
			ClickEvent._play_ui.behindEmoji:GetChild("title").text = ""
			ClickEvent._play_ui.behindEmoji:GetTransition("EmojiShake"):Play()
		end
		--[[
		ClickEvent._play_ui.behindEmoji:GetTransition("TextMove"):Stop(true,false)
		ClickEvent._play_ui.behindEmoji:GetTransition("EmojiShake"):Stop(true,false)
		behindTimeStamp = CS.UnityEngine.Time.time
		local co = coroutine.create(function()
	    yield_return(CS.UnityEngine.WaitForSeconds(3))
	    if CS.UnityEngine.Time.time - behindTimeStamp >= 3 then
		    ClickEvent._play_ui.behindEmoji.visible = false
	    end
		end)
		coroutine.resume(co)
		--]]
	elseif whichPlayer == 2 then
		ClickEvent._play_ui.oppositeEmoji.visible = true
		if chat_type == "CHAT_TYPE_TEXT" then
			ClickEvent._play_ui.oppositeEmoji:GetChild("icon").url = ""
			ClickEvent._play_ui.oppositeEmoji:GetChild("title").text = StringTable.Get(index+2059)
			ClickEvent._play_ui.oppositeEmoji:GetTransition("TextMove"):Play()
		else
			ClickEvent._play_ui.oppositeEmoji:GetChild("icon").url = UIPackage.GetItemURL("MXUI",textureIndex)
			ClickEvent._play_ui.oppositeEmoji:GetChild("title").text = ""
			ClickEvent._play_ui.oppositeEmoji:GetTransition("EmojiShake"):Play()
		end
		--[[
		ClickEvent._play_ui.oppositeEmoji:GetTransition("TextMove"):Stop(true,false)
		ClickEvent._play_ui.oppositeEmoji:GetTransition("EmojiShake"):Stop(true,false)
		oppositeTimeStamp = CS.UnityEngine.Time.time
		local co = coroutine.create(function()
	    yield_return(CS.UnityEngine.WaitForSeconds(3))
	    if CS.UnityEngine.Time.time - oppositeTimeStamp >= 3 then
		    ClickEvent._play_ui.oppositeEmoji.visible = false
	    end
		end)
		coroutine.resume(co)
		--]]
	elseif whichPlayer == 3 then
		ClickEvent._play_ui.FrontEmoji.visible = true
		if chat_type == "CHAT_TYPE_TEXT" then
			ClickEvent._play_ui.FrontEmoji:GetChild("icon").url = ""
			ClickEvent._play_ui.FrontEmoji:GetChild("title").text = StringTable.Get(index+2059)
			ClickEvent._play_ui.FrontEmoji:GetTransition("TextMove"):Play()
		else
			ClickEvent._play_ui.FrontEmoji:GetChild("icon").url = UIPackage.GetItemURL("MXUI",textureIndex)
			ClickEvent._play_ui.FrontEmoji:GetChild("title").text = ""
			ClickEvent._play_ui.FrontEmoji:GetTransition("EmojiShake"):Play()
		end
		--[[
		frontTimeStamp = CS.UnityEngine.Time.time
		ClickEvent._play_ui.FrontEmoji:GetTransition("TextMove"):Stop(true,false)
		ClickEvent._play_ui.FrontEmoji:GetTransition("EmojiShake"):Stop(true,false)
		local co = coroutine.create(function()
	    yield_return(CS.UnityEngine.WaitForSeconds(3))
	    if CS.UnityEngine.Time.time - frontTimeStamp >= 3 then
		    --ClickEvent._play_ui.FrontEmoji.visible = false
	    end
		end)
		coroutine.resume(co)
		--]]
	else
		ClickEvent._play_ui.playerEmoji.visible = true
		if chat_type == "CHAT_TYPE_TEXT" then
			ClickEvent._play_ui.playerEmoji:GetChild("icon").url = ""
			ClickEvent._play_ui.playerEmoji:GetChild("title").text = StringTable.Get(index+2059)
			ClickEvent._play_ui.playerEmoji:GetTransition("TextMove"):Play()
		else
			ClickEvent._play_ui.playerEmoji:GetChild("icon").url = UIPackage.GetItemURL("MXUI",textureIndex)
			ClickEvent._play_ui.playerEmoji:GetChild("title").text = ""
			ClickEvent._play_ui.playerEmoji:GetTransition("EmojiShake"):Play()
		end
		--[[
		ClickEvent._play_ui.playerEmoji:GetTransition("TextMove"):Stop(true,false)
		ClickEvent._play_ui.playerEmoji:GetTransition("EmojiShake"):Stop(true,false)
		local co = coroutine.create(function()
		playerTimeStamp = CS.UnityEngine.Time.time
	    yield_return(CS.UnityEngine.WaitForSeconds(3))
	    if CS.UnityEngine.Time.time - playerTimeStamp >= 3 then
	    	--ClickEvent._play_ui.playerEmoji.visible = false
	    end
		end)
		coroutine.resume(co)
		--]]
	end
end

function ClickEvent.IsMainUI(name)
	-- body
	if _currentPanel.panel and _currentPanel.panel.name == name then
		return true
	end
	return false
end

function ClickEvent.IsPopPanel(name)
	-- body
	if popPanelIndex > 0 then
		for i=1,popPanelIndex do
			if _popPanel[i].panel and _popPanel[i].panel.name == name then
				return true
			end
		end
	else
    end
	return false
end

function ClickEvent.CurrentSingleText(content)
	-- body
	if _popPanel[popPanelIndex] and _popPanel[popPanelIndex].panel and _popPanel[popPanelIndex].panel.name == ClickEvent.panelTable._only_yes_ui and _popPanel[popPanelIndex].panel:GetChild("TPopText") and _popPanel[popPanelIndex].panel:GetChild("TPopText").text == content then
		return true
	end
	return false
end

function ClickEvent.ShowDissolveTime(time)
	-- body
	if _popPanel[popPanelIndex].panel.name == ClickEvent.panelTable._vote_ui then
		_popPanel[popPanelIndex].panel:GetChild("Agree"):GetChild("count").text = tostring(time)--
		_popPanel[popPanelIndex].panel:GetChild("AgreeText").text = string.format(StringTable.Get(2040),math.ceil(time))
	end
end

function ClickEvent.ShowDissolvePanel(data)
	-- body
	if popPanelIndex > 0 and _popPanel[popPanelIndex].panel.name == ClickEvent.panelTable._vote_ui then
	else
		Player.dismissHasClicked = false
		Player.dismissTimestarmp = CS.UnityEngine.Time.time
		ClickEvent.PopPanel(ClickEvent.panelTable._vote_ui)

		_popPanel[popPanelIndex].panel:GetChild("Agree").visible = true
		_popPanel[popPanelIndex].panel:GetChild("Disagree").visible = true
		_popPanel[popPanelIndex].panel:GetChild("AgreeText").visible = false
		Player.dismissIsShowing = true
		for k,v in pairs(Player._all_players_data) do
			if v.position == "POSITION_TYPE_EAST" then
				_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader1").url = UIPackage.GetItemURL("MXUI","Touxiang01")
				if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
					_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader1").url = ""
					local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
					if tempTexture then
						_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader1").texture = NTexture(tempTexture)
					end
				end
				_popPanel[popPanelIndex].panel:GetChild("YesOrNo1"):GetController("YesOrNo").selectedIndex = 2
			elseif v.position == "POSITION_TYPE_SOUTH" then
				_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader2").url = UIPackage.GetItemURL("MXUI","Touxiang01")
				if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
					_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader2").url = ""
					local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
					if tempTexture then
						_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader2").texture = NTexture(tempTexture)
					end
				end
				_popPanel[popPanelIndex].panel:GetChild("YesOrNo2"):GetController("YesOrNo").selectedIndex = 2
			elseif v.position == "POSITION_TYPE_WEST" then
				_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader3").url = UIPackage.GetItemURL("MXUI","Touxiang01")
				if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
					_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader3").url = ""
					local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
					if tempTexture then
						_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader3").texture = NTexture(tempTexture)
					end
				end
				_popPanel[popPanelIndex].panel:GetChild("YesOrNo3"):GetController("YesOrNo").selectedIndex = 2
			elseif v.position == "POSITION_TYPE_NORTH" then
				_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader4").url = UIPackage.GetItemURL("MXUI","Touxiang01")
				if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
					_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader4").url = ""
					local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
					if tempTexture then
						_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader4").texture = NTexture(tempTexture)
					end
				end
				_popPanel[popPanelIndex].panel:GetChild("YesOrNo4"):GetController("YesOrNo").selectedIndex = 2
			end
		end
	end
	local countPlayer = 0
	local firstPlayer = "POSITION_TYPE_EAST"
	for k,v in pairs(data) do
		countPlayer = countPlayer + 1
		if countPlayer == 1 then
			firstPlayer = v.position
		end
		Player.LogWarning("Dissolve:"..v.position)
		Player.LogWarning("Dissolve:"..v.oper_type)
		if v.position == "POSITION_TYPE_EAST" then
			if v.oper_type == "GAME_OPER_TYPE_DISMISS_AGREE" then
				_popPanel[popPanelIndex].panel:GetChild("YesOrNo1"):GetController("YesOrNo").selectedIndex = 0
			else
				_popPanel[popPanelIndex].panel:GetChild("YesOrNo1"):GetController("YesOrNo").selectedIndex = 1
			end
		elseif v.position == "POSITION_TYPE_SOUTH" then
			if v.oper_type == "GAME_OPER_TYPE_DISMISS_AGREE" then
				_popPanel[popPanelIndex].panel:GetChild("YesOrNo2"):GetController("YesOrNo").selectedIndex = 0
			else
				_popPanel[popPanelIndex].panel:GetChild("YesOrNo2"):GetController("YesOrNo").selectedIndex = 1
			end
		elseif v.position == "POSITION_TYPE_WEST" then
			if v.oper_type == "GAME_OPER_TYPE_DISMISS_AGREE" then
				_popPanel[popPanelIndex].panel:GetChild("YesOrNo3"):GetController("YesOrNo").selectedIndex = 0
			else
				_popPanel[popPanelIndex].panel:GetChild("YesOrNo3"):GetController("YesOrNo").selectedIndex = 1
			end
		elseif v.position == "POSITION_TYPE_NORTH" then
			if v.oper_type == "GAME_OPER_TYPE_DISMISS_AGREE" then
				_popPanel[popPanelIndex].panel:GetChild("YesOrNo4"):GetController("YesOrNo").selectedIndex = 0
			else
				_popPanel[popPanelIndex].panel:GetChild("YesOrNo4"):GetController("YesOrNo").selectedIndex = 1
			end
		end
		if Player._my_player_data and v.position == Player._my_player_data.position then
			_popPanel[popPanelIndex].panel:GetChild("AgreeText").visible = true
			_popPanel[popPanelIndex].panel:GetChild("Agree").visible = false
			_popPanel[popPanelIndex].panel:GetChild("Disagree").visible = false
		end
		if v.oper_type == "GAME_OPER_TYPE_DISMISS_DISAGREE" then
			--countDisagree = countDisagree + 1
			---[[
			Player.LogWarning("Dissolve:")
			if CS.UnityEngine.SceneManagement.SceneManager.GetActiveScene().name == "PlaySence" then
				ClickEvent.Close()
				Player.dismissIsShowing = false
				ClickEvent.ShowToast(StringTable.Get(2011))
				return
			end
			--]]
			return
		end
	end
	for k,v in pairs(Player._all_players_data) do
		if v.position == firstPlayer then
			if v.wechat.nickname and v.wechat.nickname ~= "" then
				_popPanel[popPanelIndex].panel:GetChild("Name").text = tostring(gbk.toutf8(gbk.fromutf8(v.wechat.nickname)))
			else
				_popPanel[popPanelIndex].panel:GetChild("Name").text = tostring(v.common_prop.name)
			end
		end
	end
	--[[
	if _popPanel[popPanelIndex].panel:GetChild("YesOrNo1"):GetController("YesOrNo").selectedIndex == 0 and
	_popPanel[popPanelIndex].panel:GetChild("YesOrNo2"):GetController("YesOrNo").selectedIndex == 0 and
	_popPanel[popPanelIndex].panel:GetChild("YesOrNo3"):GetController("YesOrNo").selectedIndex == 0 and
	_popPanel[popPanelIndex].panel:GetChild("YesOrNo4"):GetController("YesOrNo").selectedIndex == 0 then
		--agree
		ClickEvent.Close()
		Player.dismissIsShowing = false
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2009)
	end
	--]]
end

function ClickEvent.ShowLeaveRoom(contentId)
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
	_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(contentId)
end
---------------------------------------------------------------------------
-------------点击功能函数
---------------------------------------------------------------------------

function ClickEvent.ShareClearRoundButton( ... )
	-- body
	Player.isRewardShare = false
	local radio = CS.UnityEngine.Screen.width/CS.UnityEngine.Screen.height
	WeChatPlatform:ShareTexture(StageCamera.main, CS.UnityEngine.Rect(0,0,600 * radio,600),1)
end

function ClickEvent.UserService( ... )
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._window_mid)
	_popPanel[popPanelIndex].panel:GetChild("PopWindowsMidShowText"):GetChild("Text").text = StringTable.Get(3006)
end

function ClickEvent.HomeShareWeChat( ... )--好友
	-- body
	Player.isRewardShare = false
	local title = _currentPanel.panel:GetChild("Avatar"):GetChild("Name"):GetChild("PlayerName").text
	local description = "邀请你一起来玩-乡乐朝阳麻将"
	WeChatPlatform:WXShare(title,description,"http://m.cloudbm.wang/download_app.html",1)
end

function ClickEvent.HomeShareMoments( ... )--朋友圈
	-- body
	local rewardItem = Player.isRewardLimited(Player.activityDataTable.shared_reward_id)
	if rewardItem and rewardItem ~= {} then
		Player.isRewardShare = true
	end
	if Player.isRewardShare == true then
		WeChatPlatform.onShareCallBack = function(errorCode)
			-- body
			if Player.isRewardShare == true then
				if errorCode == "success" then
					Player.CmdGetReward("GET_REWARD_REASON_SHARED",Player.activityDataTable.shared_reward_id)
					ClickEvent.PopPanel(ClickEvent.panelTable._getreward_ui)
					local rewardList = _popPanel[popPanelIndex].panel:GetChild("GetRewardList")
					rewardList:RemoveChildrenToPool()
					for k,v in pairs(rewardItem.rewards) do
						local obj = rewardList:AddItemFromPool(UIPackage.GetItemURL("MXUI","GetRewardItem"))
						if v.reward_type == "REWARD_TYPE_DIAMOND" then
							obj:GetChild("GetRewardLoader").url = UIPackage.GetItemURL("MXUI","gongXiHuoDe_xiangLeBi")
						elseif v.reward_type == "REWARD_TYPE_HUANLEDOU" then
							obj:GetChild("GetRewardLoader").url = UIPackage.GetItemURL("MXUI","gongXiHuoDe_zuanShi")
						elseif v.reward_type == "REWARD_TYPE_ITEM" then
						end
						obj:GetChild("GetRewardNum").text = tostring(v.count)
					end
				else
				end
			end
			WeChatPlatform.onShareCallBack = nil
			Player.isRewardShare = false
		end
	end
	local title = _currentPanel.panel:GetChild("Avatar"):GetChild("Name"):GetChild("PlayerName").text
	local description = "邀请你一起来玩-乡乐朝阳麻将"
	WeChatPlatform:WXShare(title,description,"http://m.cloudbm.wang/download_app.html",2)
end

function ClickEvent.HomeShare( ... )
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._home_share_ui)
end

function ClickEvent.Activity( ... )
	-- body
	if Player.hasClickActivity == false then
		Player.hasClickActivity = true
		_currentPanel.panel:GetChild("Activity"):GetChild("Reddot").visible = false
	end
	ClickEvent.ShowActivity()
	--[[
	ClickEvent.PopPanel(ClickEvent.panelTable._activity_ui)
	if tostring(type(_popPanel[popPanelIndex].panel:GetChild("ActivityShow2"):GetChild("ImgLoader").texture)) == "nil" then
		Player.LogWarning(type(_popPanel[popPanelIndex].panel:GetChild("ActivityShow2"):GetChild("ImgLoader").texture))
		ClickEvent.LoadActivityTexture("1",_popPanel[popPanelIndex].panel:GetChild("ActivityShow2"):GetChild("ImgLoader"))
	end
	--]]
end

function ClickEvent.GameEmojiButton( ... )
	-- body
	ClickEvent._play_ui.gameMoreControl.selectedIndex = 0
	ClickEvent._play_ui.gameEmojiControl.selectedIndex = 1
end

function ClickEvent.GameMoreButtonUp( ... )
	-- body
	ClickEvent._play_ui.gameMoreControl.selectedIndex = 0
	ClickEvent._play_ui.gameEmojiControl.selectedIndex = 0
end

function ClickEvent.GameMoreButtonDown( ... )
	-- body
	ClickEvent._play_ui.gameMoreControl.selectedIndex = 1
	ClickEvent._play_ui.gameEmojiControl.selectedIndex = 0
end

function ClickEvent.GreenDesk( ... )
	-- body
	Player.tablecloth = 0
end

function ClickEvent.BlueDesk( ... )
	-- body
	Player.tablecloth = 1
end

function ClickEvent.RedDesk( ... )
	-- body
	Player.tablecloth = 2
end

function ClickEvent.GreenBack( ... )
	-- body
	Player.paiSizeSet = 0
end

function ClickEvent.BlueBack( ... )
	-- body
	Player.paiSizeSet = 1
end

function ClickEvent.GoldBack( ... )
	-- body
	Player.paiSizeSet = 2
end

function ClickEvent.ReplayFastForward( ... )
	-- body
	CS.UnityEngine.Time.timeScale = 2
	ClickEvent._play_ui.playPauseControl.selectedIndex = 0
	Player.isReplayFastBackward = false
	Player.CmdMatTrackCutomKVEvent("Replay","QuickForward","1")
end

function ClickEvent.ReplayFastBackward( ... )
	-- body
	CS.UnityEngine.Time.timeScale = 2
	ClickEvent._play_ui.playPauseControl.selectedIndex = 0
	Player.isReplayFastBackward = true
	Player.CmdMatTrackCutomKVEvent("Replay","QuickBackward","1")
end

function ClickEvent.ReplayPlayButton( ... )
	-- body
	ClickEvent._play_ui.playPauseControl.selectedIndex = 1
	CS.UnityEngine.Time.timeScale = 1
	Player.isReplayFastBackward = false
	Player.CmdMatTrackCutomKVEvent("Replay","Play","1")
end

function ClickEvent.ReplayPauseButton( ... )
	-- body
	ClickEvent._play_ui.playPauseControl.selectedIndex = 0
	CS.UnityEngine.Time.timeScale = 0
	Player.isReplayFastBackward = false
	Player.CmdMatTrackCutomKVEvent("Replay","Pause","1")
end

function ClickEvent.ButtonPaste( ... )
	-- body
	local pasteContent = WeChatPlatform:ReadPaste()
	if pasteContent and pasteContent ~= "" then
		_popPanel[popPanelIndex].panel:GetChild("InputText").text = pasteContent
	end
	Player._roomId = nil
end

function ClickEvent.WatchButton( ... )
	-- body
	local roomNumber = 0
	local roundNumber = 0
	roomNumber = tonumber(string.sub(_popPanel[popPanelIndex].panel:GetChild("InputText").text,1,-3))
	if string.sub(_popPanel[popPanelIndex].panel:GetChild("InputText").text,-2) == "0" then
		roundNumber = tonumber(string.sub(_popPanel[popPanelIndex].panel:GetChild("InputText").text,-1))
	else
		roundNumber = tonumber(string.sub(_popPanel[popPanelIndex].panel:GetChild("InputText").text,-2))
	end
	if roundNumber and roomNumber then
		Player.playBackRoomID = roomNumber
		Player._roomId = roomNumber
		Player.playBackRoundIndex = roundNumber
		Player.CmdPlayBack(roomNumber,roundNumber)
	end
end

function ClickEvent.ReplayOthersRound( ... )
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._watch_other_round)
	Player._roomId = nil
	Player.CmdMatTrackCutomKVEvent("Button","HistoryChectOthersReplay","1")
end

function ClickEvent.PlayThisRound(gameObject)
	-- body
	ClickEvent.Close()
	local roundNumber = 0
	roundNumber = tonumber(gameObject.parent:GetChild("RoundNum").text)
	Player.LogWarning(Player.playBackRoomID)
	Player.LogWarning(roundNumber)
	if Player.playBackRoomID and Player.playBackRoomID ~= 0 and roundNumber and roundNumber <= 16 and roundNumber ~= 0 then
		Player._roomId = Player.playBackRoomID
		Player.playBackRoundIndex = roundNumber
		Player.CmdPlayBack(Player.playBackRoomID,roundNumber)
	end
	Player.CmdMatTrackCutomKVEvent("Button","HistoryReplay","1")
end

function ClickEvent.ShareReplay(gameObject)
	-- body
	local roundNumber = 0
	local shareStr = ""
	shareStr = tostring(Player.playBackRoomID)
	roundNumber = tonumber(gameObject.parent:GetChild("RoundNum").text)
	if tonumber(roundNumber) < 10 then
		shareStr = shareStr.."0"..tostring(roundNumber)
	else
		shareStr = shareStr..tostring(roundNumber)
	end
	WeChatPlatform:CopyRoomID(shareStr)
	ClickEvent.ShowToast(StringTable.Get(2047))
end

function ClickEvent.Replay(gameObject)
	-- body
	--[[
	if ClickEvent.IsPopPanel(ClickEvent.panelTable._history_score_ui) == true then
		_popPanel[popPanelIndex].panel:GetController("HistorySecenSelect").selectedIndex = 1
	else
		ClickEvent.isReplayClick = true
	end
	--]]
	--gameObject.parent:GetChild()
end

function ClickEvent.BigButton( ... )
	-- body
	ClickEvent._play_ui.gameMoreControl.selectedIndex = 0
	ClickEvent._play_ui.gameEmojiControl.selectedIndex = 0
end

function ClickEvent.Agree( ... )
	-- body
	Player.CmdGameOperation("GAME_OPER_TYPE_DISMISS_AGREE")
	if ClickEvent._play_ui.playerAlready.visible == true then
		ClickEvent._play_ui.playerAlready.visible = false
		ClickEvent._play_ui.gamePlayButton.visible = true
	end
end

function ClickEvent.Disagree( ... )
	-- body
	Player.CmdGameOperation("GAME_OPER_TYPE_DISMISS_DISAGREE")
	if ClickEvent._play_ui.playerAlready.visible == true then
		ClickEvent._play_ui.playerAlready.visible = false
		ClickEvent._play_ui.gamePlayButton.visible = true
	end
end

function ClickEvent.ShowDissmiss( ... )
	-- body
	if not Player.dismissTimestarmp or CS.UnityEngine.Time.time - Player.dismissTimestarmp > Player.activityDataTable.room_dismiss_cooldown then
		if popPanelIndex > 0 and _popPanel[popPanelIndex].panel.name == ClickEvent.panelTable._vote_ui then
			Player.LogWarning("panelnil")
			return
		end
		Player.dismissHasClicked = false
		Player.dismissTimestarmp = CS.UnityEngine.Time.time
		ClickEvent.PopPanel(ClickEvent.panelTable._vote_ui)
		_popPanel[popPanelIndex].panel:GetChild("AgreeText").visible = false
		_popPanel[popPanelIndex].panel:GetChild("Agree").visible = true
		_popPanel[popPanelIndex].panel:GetChild("Disagree").visible = true
		if Player.wechat_nickname and Player.wechat_nickname ~= "" then
			_popPanel[popPanelIndex].panel:GetChild("Name").text = tostring(gbk.toutf8(gbk.fromutf8(Player.wechat_nickname)))
		else
			_popPanel[popPanelIndex].panel:GetChild("Name").text = tostring(Player._player_data.common_prop.name)
		end
		Player.dismissIsShowing = true
		for k,v in pairs(Player._all_players_data) do
			if v.position == "POSITION_TYPE_EAST" then
				_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader1").url = UIPackage.GetItemURL("MXUI","Touxiang01")
				if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
					_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader1").url = ""
					local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
					if tempTexture then
						_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader1").texture = NTexture(tempTexture)
					end
				end
				_popPanel[popPanelIndex].panel:GetChild("YesOrNo1"):GetController("YesOrNo").selectedIndex = 2
			elseif v.position == "POSITION_TYPE_SOUTH" then
				_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader2").url = UIPackage.GetItemURL("MXUI","Touxiang01")
				if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
					_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader2").url = ""
					local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
					if tempTexture then
						_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader2").texture = NTexture(tempTexture)
					end
				end
				_popPanel[popPanelIndex].panel:GetChild("YesOrNo2"):GetController("YesOrNo").selectedIndex = 2
			elseif v.position == "POSITION_TYPE_WEST" then
				_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader3").url = UIPackage.GetItemURL("MXUI","Touxiang01")
				if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
					_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader3").url = ""
					local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
					if tempTexture then
						_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader3").texture = NTexture(tempTexture)
					end
				end
				_popPanel[popPanelIndex].panel:GetChild("YesOrNo3"):GetController("YesOrNo").selectedIndex = 2
			elseif v.position == "POSITION_TYPE_NORTH" then
				_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader4").url = UIPackage.GetItemURL("MXUI","Touxiang01")
				if v.wechat and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
					_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader4").url = ""
					local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
					if tempTexture then
						_popPanel[popPanelIndex].panel:GetChild("PlayAvatarLoader4").texture = NTexture(tempTexture)
					end
				end
				_popPanel[popPanelIndex].panel:GetChild("YesOrNo4"):GetController("YesOrNo").selectedIndex = 2
			end
		end
		--_popPanel[popPanelIndex].panel:GetChild("Agree").visible = false
		--_popPanel[popPanelIndex].panel:GetChild("Disagree").visible = false
		Player.CmdGameOperation("GAME_OPER_TYPE_DISMISS_AGREE")
		if ClickEvent._play_ui.playerAlready.visible == true then
			ClickEvent._play_ui.playerAlready.visible = false
			ClickEvent._play_ui.gamePlayButton.visible = true
		end
		Player.CmdMatTrackCutomKVEvent("DissolvedRoom","Round"..tostring(Player.room_current_round),"1")
		--Player.dismissHasClicked = true
	else
		ClickEvent.PopPanel(ClickEvent.panelTable._only_yes_ui)
		_popPanel[popPanelIndex].panel:GetChild("TPopText").text = string.format(StringTable.Get(2039),math.ceil(Player.activityDataTable.room_dismiss_cooldown - CS.UnityEngine.Time.time + Player.dismissTimestarmp))
	end
end

function ClickEvent.GameDissolveButton(gameObject)
	-- body
	if Player.roomHasBegin == false and Player._room_information.options and Player._room_information.options.gmt_opened == false then
		Player.CmdMatTrackCutomKVEvent("DissolvedRoom","NotInRound","1")
		if Player._my_player_data.position == "POSITION_TYPE_EAST" then
			ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
			_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2006)
		end
		return
	end
	ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
	_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2041)
end

function ClickEvent.GameInstructionButton(gameObject)
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._instruction_ui)
end

function ClickEvent.HelloText(gameObject)
	-- body
	local index = string.find(gameObject.name,"_")
	local number = string.sub(gameObject.name,index+1)
	Player.CmdSystemChat("CHAT_TYPE_TEXT",tonumber(number))
	if _currentPanel and _currentPanel.panel and _currentPanel.panel:GetChild("GameEmojiButton") then
		ClickEvent._play_ui.gameEmojiControl.selectedIndex = 0
	end
end

function ClickEvent.Emoji(gameObject)
	-- body
	local index = string.find(gameObject.name,"_")
	local number = string.sub(gameObject.name,index+1)
	Player.CmdSystemChat("CHAT_TYPE_FACE",tonumber(number))
	if _currentPanel and _currentPanel.panel and _currentPanel.panel:GetChild("GameEmojiButton") then
		ClickEvent._play_ui.gameEmojiControl.selectedIndex = 0
	end
end

function ClickEvent.InviteWechatFriends(gameObject)
	-- body
	Player.isRewardShare = false
	local title = "乡乐朝阳麻将,房间号:"..tostring(Player._roomId)
	local fanxing = ""
	for k,v in pairs(Player._room_information.options.extend_type) do
		if v == "ROOM_EXTEND_TYPE_ZHANLIHU" then
			fanxing = fanxing.."站立胡"
		elseif v == "ROOM_EXTEND_TYPE_JIAHU" then
			fanxing = fanxing.."带夹胡"
		elseif v == "ROOM_EXTEND_TYPE_XUANFENGGANG" then
			fanxing = fanxing.."旋风杠"
		elseif v == "ROOM_EXTEND_TYPE_BAOPAI" then
			fanxing = fanxing.."宝牌"
		elseif v == "ROOM_EXTEND_TYPE_DUANMEN" then
			fanxing = fanxing.."可断门"
		elseif v == "ROOM_EXTEND_TYPE_QIYISE" then
			fanxing = fanxing.."清一色"
		elseif v == "ROOM_EXTEND_TYPE_BAOSANJIA" then
			fanxing = fanxing.."点炮包三家"
		end
		fanxing = fanxing.."  "
	end
	fanxing = string.sub(fanxing, 1, -2)
	local isAACreate = ""
	if Player._room_information and Player._room_information.options and Player._room_information.options.pay_type and Player._room_information.options.pay_type == "ROOM_PAY_TYPE_AA" then
		isAACreate = "AA制 "
	else
		isAACreate = ""
	end
	local description = isAACreate.."局数:"..tostring(Player._room_information.options.open_rands)..fanxing
	WeChatPlatform:WXShare(title,description,"http://m.cloudbm.wang/download_app.html")
	Player.CmdMatTrackCutomKVEvent("Button","InviteFriend","1")
end

function ClickEvent.CopyRoomNum( ... )
	-- body
	WeChatPlatform:CopyRoomID(tostring(Player._roomId))
	ClickEvent.ShowToast(StringTable.Get(2031))
	Player.CmdMatTrackCutomKVEvent("Button","CopyRoomNum","1")
end

function ClickEvent.ChangeAccount(gameObject)
	-- body
	ClickEvent.Close()
	ClickEvent.DeletePanel(_currentPanel.panel)
	ClickEvent.CreateNewPanel(ClickEvent.panelTable._main_ui)
	os.remove(CS.UnityEngine.Application.persistentDataPath.."/openID.txt")
	Player.wechat_code = ""
	Player.wechat_nickname = ""
    Player.wechat_sex = ""
    Player.wechat_headimgurl = ""
	Player.LogWarning(Player._string_id)
	Player.LogWarning(Player._player_data.common_prop.player_id)
	Player.CmdSwitchAccount(Player._string_id,Player._player_data.common_prop.player_id)
	Player.CmdMatTrackCutomKVEvent("Button","SettingChangeAccount","1")
end

function ClickEvent.ServiveTerm1(gameObject)
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._window_mid)
	_popPanel[popPanelIndex].panel:GetChild("PopWindowsMidShowText"):GetChild("Text").text = StringTable.Get(3004)
	Player.CmdMatTrackCutomKVEvent("Button","PersonalSecret","1")
end

function ClickEvent.ServiveTerm2(gameObject)
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._window_mid)
	_popPanel[popPanelIndex].panel:GetChild("PopWindowsMidShowText"):GetChild("Text").text = StringTable.Get(3003)
	Player.CmdMatTrackCutomKVEvent("Button","PersonalServe","1")
end

function ClickEvent.ServiveTerm3(gameObject)
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._window_mid)
	_popPanel[popPanelIndex].panel:GetChild("PopWindowsMidShowText"):GetChild("Text").text = StringTable.Get(3005)
	Player.CmdMatTrackCutomKVEvent("Button","PersonalUser","1")
end

function ClickEvent.ServiveTerm4(gameObject)
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._window_mid)
	_popPanel[popPanelIndex].panel:GetChild("PopWindowsMidShowText"):GetChild("Text").text = StringTable.Get(3006)
	Player.CmdMatTrackCutomKVEvent("Button","PersonalUser","1")
end

function ClickEvent.ServiveTerm5(gameObject)
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._window_mid)
	_popPanel[popPanelIndex].panel:GetChild("PopWindowsMidShowText"):GetChild("Text").text = StringTable.Get(3002)
end

function ClickEvent.ServiceTerm6( ... )
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._window_mid)
	_popPanel[popPanelIndex].panel:GetChild("PopWindowsMidShowText"):GetChild("Text").text = StringTable.Get(3001)
	Player.CmdMatTrackCutomKVEvent("Button","CreateRoomNotice","1")
end

function ClickEvent.FeedBackButton(gameObject)
	-- body
	ClickEvent.ShowSingleYesWindow(3009)
end

function ClickEvent.UpdateButton(gameObject)
	-- body
	ClickEvent.ShowSingleYesWindow(3008)
end

function ClickEvent.CustomServiceButton(gameObject)
	-- body
	ClickEvent.ShowSingleYesWindow(3007)
end

function ClickEvent.VipNoteList(gameObject)
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._history_score_ui)
	Player.LogWarning(gameObject.gameObjectName)
	_popPanel[popPanelIndex].panel:GetChild("NoHistory").visible = false
	for k,v in pairs(Player.history_data) do
		if tostring(v.room_id) == gameObject.gameObjectName then
			--[[
			if v.options.model == "ROOM_MODEL_TYPE_CLASSICAL" then
				_popPanel[popPanelIndex].panel:GetChild("ModeText").text = "经典模式"
			else
				_popPanel[popPanelIndex].panel:GetChild("ModeText").text = "高番模式"
			end
			--]]
			Player.playBackRoomID = v.room_id
			local fanxing = ""
			for kFan,vFan in pairs(v.options.extend_type) do
				if vFan == "ROOM_EXTEND_TYPE_ZHANLIHU" then
					fanxing = fanxing.."站立胡"
				elseif vFan == "ROOM_EXTEND_TYPE_JIAHU" then
					fanxing = fanxing.."带夹胡"
				elseif vFan == "ROOM_EXTEND_TYPE_XUANFENGGANG" then
					fanxing = fanxing.."旋风杠"
				elseif vFan == "ROOM_EXTEND_TYPE_BAOPAI" then
					fanxing = fanxing.."宝牌"
				elseif vFan == "ROOM_EXTEND_TYPE_DUANMEN" then
					fanxing = fanxing.."可断门"
				elseif vFan == "ROOM_EXTEND_TYPE_QIYISE" then
					fanxing = fanxing.."清一色"
				elseif vFan == "ROOM_EXTEND_TYPE_BAOSANJIA" then
					fanxing = fanxing.."点炮包三家"
				end
				fanxing = fanxing.."、"
			end
			fanxing = string.sub(fanxing, 1, -2)
			_popPanel[popPanelIndex].panel:GetChild("FanText").text = fanxing
			_popPanel[popPanelIndex].panel:GetChild("RoundText").text = tostring(v.options.open_rands).."局"
			if _popPanel[popPanelIndex].panel:GetChild("RoomIDText") then
				_popPanel[popPanelIndex].panel:GetChild("RoomIDText").text = gameObject.gameObjectName
			end
			if v.options.top_mutiple == 0 then
				_popPanel[popPanelIndex].panel:GetChild("MultipleText").text = "不封顶"
			else
				_popPanel[popPanelIndex].panel:GetChild("MultipleText").text = tostring(v.options.top_mutiple).."倍"
			end
			local historyList = _popPanel[popPanelIndex].panel:GetChild("HistoryList")
			historyList:RemoveChildrenToPool()
			local countScore = {}
			for i=1,4 do
				countScore[i] = {}
				countScore[i].nickname = ""
				countScore[i].headimgurl = ""
				countScore[i].allScore = 0
			end
			local roundCount = 0
			for j,c in pairs(v.list) do
				local obj = historyList:AddItemFromPool(UIPackage.GetItemURL("MXUI","VipNoteListInRound"))
				obj.name = "VipNoteListInRound"
				if j > 10 then
					obj:GetChild("RoundNum").text = "0"..tostring(j % 10)
				else
					obj:GetChild("RoundNum").text = tostring(j % 10)
				end
				if obj:GetChild("ShareReplay") and obj:GetChild("PlayThisRound") then
					obj:GetChild("ShareReplay").visible = true
					obj:GetChild("PlayThisRound").visible = true
					obj:GetChild("ShareReplay").onClick:Add(ClickEvent.registerButtonClick)
					obj:GetChild("PlayThisRound").onClick:Add(ClickEvent.registerButtonClick)
				end
				roundCount = roundCount + 1
				local playerNumber = 1
				for roundKey,roundData in pairs(c.list) do
					for playerKey,playerData in pairs(v.player_brief_list) do
						if playerData.player_id == roundData.player_id then
							countScore[playerNumber].headimgurl = playerData.headimgurl
							countScore[playerNumber].nickname = playerData.nickname
						end
					end
					countScore[playerNumber].allScore = countScore[playerNumber].allScore + roundData.score
					obj:GetChild("VipNoteListRountUnit"..tostring(playerNumber)):GetChild("PlayerName").text = tostring(countScore[playerNumber].nickname)
					obj:GetChild("VipNoteListRountUnit"..tostring(playerNumber)):GetChild("WinLoseNum").text = tostring(roundData.score)
					if obj:GetChild("VipNoteListRountUnit"..tostring(playerNumber)):GetChild("AvatarLoader") then
						obj:GetChild("VipNoteListRountUnit"..tostring(playerNumber)):GetChild("AvatarLoader").url  = UIPackage.GetItemURL("MXUI","Touxiang01")
						if countScore[playerNumber].headimgurl and countScore[playerNumber].headimgurl ~= "" then
							obj:GetChild("VipNoteListRountUnit"..tostring(playerNumber)):GetChild("AvatarLoader").url = ""
							local tempTexture = WeChatPlatform:SetAsyncImage(countScore[playerNumber].headimgurl)
							if tempTexture then
								obj:GetChild("VipNoteListRountUnit"..tostring(playerNumber)):GetChild("AvatarLoader").texture = NTexture(tempTexture)
							end
						end
					end
					--[[
					--]]
					playerNumber = playerNumber + 1
				end
			end
			--[[
			local historyShareList = _popPanel[popPanelIndex].panel:GetChild("HistoryShareList")
			historyShareList:RemoveChildrenToPool()
			for i=1,4 do
				local tempTable = {}
				for j=i,4 do
					if countScore[i].allScore < countScore[j].allScore then
						tempTable = countScore[i]
						countScore[i] = countScore[j]
						countScore[j] = tempTable
					end
				end
			end
			for i=1,4 do
				local obj = historyShareList:AddItemFromPool(UIPackage.GetItemURL("MXUI","VipNoteListInTotal"))
				obj.name = "VipNoteListInTotal"
				obj:GetChild("Rank").text = tostring(i)
				if countScore[i].allScore < 0 then
					local loseFont = obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").textFormat
					loseFont.font = UIPackage.GetItemURL("MXUI","LoseFont")
					obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").textFormat = loseFont
					obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").text = tostring(countScore[i].allScore)
				else
					local winFont = obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").textFormat
					winFont.font = UIPackage.GetItemURL("MXUI","WinFont")
					obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").textFormat = winFont
					obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").text = tostring(countScore[i].allScore)
				end
				obj:GetChild("VipNoteListTotalUnit"):GetChild("PlayerName").text = tostring(countScore[i].nickname)
				obj:GetChild("VipNoteListTotalUnit"):GetChild("AvatarLoader").url  = UIPackage.GetItemURL("MXUI","Touxiang01")
				if countScore[i].headimgurl and countScore[i].headimgurl ~= "" then
					obj:GetChild("VipNoteListTotalUnit"):GetChild("AvatarLoader").url = ""
					local tempTexture = WeChatPlatform:SetAsyncImage(countScore[i].headimgurl)
					if tempTexture then
						obj:GetChild("VipNoteListTotalUnit"):GetChild("AvatarLoader").texture = NTexture(tempTexture)
					end
				end
				obj:GetChild("VipNoteListTotalUnit"):GetChild("TotalRoundNum").text = tostring(roundCount)
			end
			--]]
		end
	end
end

function ClickEvent.GameSettingButton( ... )
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._setting_play_ui)
	Player.LogWarning("Music:")
	Player.LogWarning(Player._player_data.game_setting.music)
	_popPanel[popPanelIndex].panel:GetChild("Version").text = Player.pc_version
	--[[
	if CS.LuaCommon.isIos == true then
		_popPanel[popPanelIndex].panel:GetChild("UpdateButton").visible = false
	end
	if Player.wechat_nickname and Player.wechat_nickname ~= "" then
		_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerName").text = tostring(gbk.toutf8(gbk.fromutf8(Player.wechat_nickname)))
	else
		_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerName").text = Player._player_data.common_prop.name
	end
	_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerID").text = tostring(Player._player_data.common_prop.player_id)

	if Player.wechat_headimgurl and Player.wechat_headimgurl ~= "" then
		_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").url = ""
		local tempTexture = WeChatPlatform:SetAsyncImage(Player.wechat_headimgurl)
		--[[
		WeChatPlatform.func = function ()
			-- body
			local delegateTex = WeChatPlatform:SetAsyncImage(headimgurl)
			if delegateTex then
				_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").texture = NTexture(delegateTex)
			end
		end
		--]]
		--_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").texture = NTexture(tempTexture)
	--end
	--]]
	_popPanel[popPanelIndex].panel:GetChild("MusicSlideButton").selected = Player._player_data.game_setting.music
	_popPanel[popPanelIndex].panel:GetChild("EffectSlideButton").selected = Player._player_data.game_setting.audio
	_popPanel[popPanelIndex].panel:GetChild("GameVoiceSlideButton").selected = Player._player_data.game_setting.voice
	--_popPanel[popPanelIndex].panel:GetChild("ClickOutSlideButton").selected = Player._player_data.game_setting.click_push
	--_popPanel[popPanelIndex].panel:GetChild("ChangeAccount").visible = false
end

function ClickEvent.MusicSlideButton( ... )
	-- body
	Player._player_data.game_setting.music = _popPanel[popPanelIndex].panel:GetChild("MusicSlideButton").selected
	if Player._player_data.game_setting.music then
		AudioPlayer.PlaySound(AudioPlayer._audio_name.Bgm,true,0.5)
	else
		AudioPlayer.StopSound(AudioPlayer._audio_name.Bgm)
	end
end

function ClickEvent.EffectSlideButton( ... )
	-- body
	Player._player_data.game_setting.audio = _popPanel[popPanelIndex].panel:GetChild("EffectSlideButton").selected
end

function ClickEvent.GameVoiceSlideButton( ... )
	-- body
	Player._player_data.game_setting.voice = _popPanel[popPanelIndex].panel:GetChild("GameVoiceSlideButton").selected
end

function ClickEvent.ClickOutSlideButton( ... )
	-- body
	Player._player_data.game_setting.click_push = _popPanel[popPanelIndex].panel:GetChild("ClickOutSlideButton").selected
end

function ClickEvent.Shop( ... )
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._mall_ui)
	_popPanel[popPanelIndex].panel:GetChild("MallDouButton").selected = true
	for i=1,5 do
		_popPanel[popPanelIndex].panel:GetChild("MallItemBg"..tostring(i)):GetChild("SaleHint").visible = false
	end
	Player.CmdMatTrackCutomKVEvent("Button","MainMenuMall","1")
end

function ClickEvent.Instruction( ... )
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._instruction_ui)
	Player.CmdMatTrackCutomKVEvent("Button","MainMenuHowtoplay","1")
end

function ClickEvent.Mail( ... )
	-- body
	Player.LogWarning("mail")
	ClickEvent.PopPanel(ClickEvent.panelTable._mail_ui)
	Player.CmdMatTrackCutomKVEvent("Button","MainMenuMail","1")
end

function ClickEvent.VIPRecordButton( ... )
	-- body
	WeChatPlatform.func = nil
	ClickEvent.PopPanel(ClickEvent.panelTable._vip_note_ui)
	_popPanel[popPanelIndex].panel:GetChild("NoteList"):RemoveChildrenToPool()
	_popPanel[popPanelIndex].panel:GetChild("NoteList").scrollPane.onPullUpRelease:Add(ClickEvent.OnPullUpRefresh)
	local dataCount = 0
	for k,v in pairs(Player.history_data) do
		dataCount = dataCount + 1
		local obj = _popPanel[popPanelIndex].panel:GetChild("NoteList"):AddItemFromPool(UIPackage.GetItemURL("MXUI","VipNoteList"))
		obj.name = "VipNoteList"
		obj.gameObjectName = tostring(v.room_id)
		obj.onClick:Add(ClickEvent.registerButtonClick)
		if obj:GetChild("Replay") then
			obj:GetChild("Replay").onClick:Add(ClickEvent.registerButtonClick)
		end
		local year,month,day = ClickEvent.ChangeSecondToDate(v.create_time)
		local hour,minute = ClickEvent.ChangeSecondToTime(v.create_time)
		obj:GetChild("FinishDate").text = tostring(year).."/"..tostring(month).."/"..tostring(day)
		obj:GetChild("FinishTime").text = tostring(hour)..":"..tostring(minute)
		if obj:GetChild("RoomID") then
			obj:GetChild("RoomID").text = tostring(v.room_id)
		end
		local countScore = 0
		local headimgurlTable = {}
		local imgCount = 0
		for j,c in pairs(v.list) do
			imgCount = 0
			for roundKey,roundData in pairs(c.list) do
				imgCount = imgCount + 1
				if not headimgurlTable[imgCount] then
					for playerKey,playerData in pairs(v.player_brief_list) do
						if playerData.player_id == roundData.player_id then
							headimgurlTable[imgCount] = playerData.headimgurl
						end
					end
				end
				if roundData.player_id == Player._player_data.common_prop.player_id then
					countScore = countScore + roundData.score
				end
			end
		end
		for i=1,4 do
			local tempTexture = WeChatPlatform:SetAsyncImage(headimgurlTable[i])
			if tempTexture then
				obj:GetChild("Avatar"..tostring(i)).texture = NTexture(tempTexture)
			end
		end
		WeChatPlatform:SetFuncDelegate(function ( ... )
			-- body
			for i=1,4 do
				local tempTexture = WeChatPlatform:SetAsyncImage(headimgurlTable[i])
				if tempTexture then
					obj:GetChild("Avatar"..tostring(i)).texture = NTexture(tempTexture)
				end
			end
		end)
		if countScore > 0 then
			obj:GetChild("WinLoseNum").text = "+"..tostring(countScore)
		else
			obj:GetChild("WinLoseNum").text = tostring(countScore)
		end
	end
	if dataCount == 0 then
		_popPanel[popPanelIndex].panel:GetChild("NoHistory").visible = true
	else
		_popPanel[popPanelIndex].panel:GetChild("NoHistory").visible = false
	end
	Player.history_start = dataCount + 1
	if dataCount <= 5 and dataCount < Player.history_count then
		ClickEvent.OnPullUpRefresh()
	end
	Player.CmdMatTrackCutomKVEvent("Button","MainMenuHistory","1")
end

function ClickEvent.OnReceiveHistory()
	-- body
	if ClickEvent.IsPopPanel(ClickEvent.panelTable._vip_note_ui) == true then
		local dataCount = 0
		for i=Player.history_start,Player.history_end do
			local v = Player.history_data[i]
			if v and v.room_id then
				Player.LogWarning("currentDataIndex:"..i)
				dataCount = dataCount + 1
				local obj = _popPanel[popPanelIndex].panel:GetChild("NoteList"):AddItemFromPool(UIPackage.GetItemURL("MXUI","VipNoteList"))
				obj.name = "VipNoteList"
				obj.gameObjectName = tostring(v.room_id)
				obj.onClick:Add(ClickEvent.registerButtonClick)
				if obj:GetChild("Replay") then
					obj:GetChild("Replay").onClick:Add(ClickEvent.registerButtonClick)
				end
				local year,month,day = ClickEvent.ChangeSecondToDate(v.create_time)
				local hour,minute = ClickEvent.ChangeSecondToTime(v.create_time)
				obj:GetChild("FinishDate").text = tostring(year).."/"..tostring(month).."/"..tostring(day)
				obj:GetChild("FinishTime").text = tostring(hour)..":"..tostring(minute)
				if obj:GetChild("RoomID") then
					obj:GetChild("RoomID").text = tostring(v.room_id)
				end
				local countScore = 0
				local headimgurlTable = {}
				local imgCount = 0
				for j,c in pairs(v.list) do
					imgCount = 0
					for roundKey,roundData in pairs(c.list) do
						imgCount = imgCount + 1
						if not headimgurlTable[imgCount] then
							for playerKey,playerData in pairs(v.player_brief_list) do
								if playerData.player_id == roundData.player_id then
									headimgurlTable[imgCount] = playerData.headimgurl
								end
							end
						end
						if roundData.player_id == Player._player_data.common_prop.player_id then
							countScore = countScore + roundData.score
						end
					end
				end
				for i=1,4 do
					local tempTexture = WeChatPlatform:SetAsyncImage(headimgurlTable[i])
					if tempTexture then
						obj:GetChild("Avatar"..tostring(i)).texture = NTexture(tempTexture)
					end
				end
				WeChatPlatform:SetFuncDelegate(function ( ... )
					-- body
					for i=1,4 do
						local tempTexture = WeChatPlatform:SetAsyncImage(headimgurlTable[i])
						if tempTexture then
							obj:GetChild("Avatar"..tostring(i)).texture = NTexture(tempTexture)
						end
					end
				end)
				if countScore > 0 then
					obj:GetChild("WinLoseNum").text = "+"..tostring(countScore)
				else
					obj:GetChild("WinLoseNum").text = tostring(countScore)
				end
			end
		end
		if dataCount > 0 then
			_popPanel[popPanelIndex].panel:GetChild("NoHistory").visible = false
		end
		Player.history_start = dataCount + Player.history_start
	end
end

function ClickEvent.OnPullUpRefresh()
	-- body
	Player.LogWarning("OnPullUpRefresh:"..Player.history_start)
	Player.history_end = Player.history_start
	if Player.history_end <= Player.history_count then
		if Player.history_end + 4 <= Player.history_count then
			Player.history_end = Player.history_end + 4
			Player.CmdBattleHistory(Player.history_start,Player.history_end)
		else
			Player.history_end = Player.history_count
			Player.CmdBattleHistory(Player.history_start,Player.history_end)
		end
	end
	Player.LogWarning("refreshStart:"..Player.history_start.."refreshEnd:"..Player.history_end)
end

function ClickEvent.ChangeSecondToDate(t)
	-- body
	return os.date("%Y",t),os.date("%m",t),os.date("%d",t)
end

function ClickEvent.ChangeSecondToTime(t)
	-- body
	return os.date("%H",t),os.date("%M",t)
end

function ClickEvent.Promotion( ... )
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._custom_servive_ui)

	Player.CmdMatTrackCutomKVEvent("Button","MainMenuCustomService","1")
end

function ClickEvent.Welfare( ... )
	-- body
	--ClickEvent.PopPanel(ClickEvent.panelTable._welfare_ui)
	ClickEvent.ShowSingleYesWindow(3000)
	Player.CmdMatTrackCutomKVEvent("Button","MainMenuWelfare","1")
end

function ClickEvent.Setting( ... )
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._setting_ui)
	Player.LogWarning("Music:")
	Player.LogWarning(Player._player_data.game_setting.music)
	_popPanel[popPanelIndex].panel:GetChild("Version").text = Player.pc_version
	--[[
	if CS.LuaCommon.isIos == true then
		_popPanel[popPanelIndex].panel:GetChild("UpdateButton").visible = false
	end
	if Player.wechat_nickname and Player.wechat_nickname ~= "" then
		_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerName").text = gbk.toutf8(gbk.fromutf8(Player.wechat_nickname))
	else
		_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerName").text = Player._player_data.common_prop.name
	end
	_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerID").text = tostring(Player._player_data.common_prop.player_id)
	_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
	if Player.wechat_headimgurl and Player.wechat_headimgurl ~= "" then
		_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").url = ""
		local tempTexture = WeChatPlatform:SetAsyncImage(Player.wechat_headimgurl)
		--[[
		WeChatPlatform.func = function ()
			-- body
			local delegateTex = WeChatPlatform:SetAsyncImage(Player.wechat_headimgurl)
			if delegateTex then
				_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").texture = NTexture(delegateTex)
			end
		end
		--]]
		--_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").texture = NTexture(tempTexture)
	--end
	--]]
	_popPanel[popPanelIndex].panel:GetChild("MusicSlideButton").selected = Player._player_data.game_setting.music
	_popPanel[popPanelIndex].panel:GetChild("EffectSlideButton").selected = Player._player_data.game_setting.audio
	_popPanel[popPanelIndex].panel:GetChild("GameVoiceSlideButton").selected = Player._player_data.game_setting.voice

	if Player.paiSizeSet == 1 then
		_popPanel[popPanelIndex].panel:GetChild("BlueBack").selected = true
	elseif Player.paiSizeSet == 2 then
		_popPanel[popPanelIndex].panel:GetChild("GoldBack").selected = true
	else
		_popPanel[popPanelIndex].panel:GetChild("GreenBack").selected = true
	end
	if Player.tablecloth == 1 then
		_popPanel[popPanelIndex].panel:GetChild("BlueDesk").selected = true
	elseif Player.tablecloth == 2 then
		_popPanel[popPanelIndex].panel:GetChild("RedDesk").selected = true
	else
		_popPanel[popPanelIndex].panel:GetChild("GreenDesk").selected = true
	end
	--_popPanel[popPanelIndex].panel:GetChild("ClickOutSlideButton").selected = Player._player_data.game_setting.click_push
	Player.CmdMatTrackCutomKVEvent("Button","MainMenuMall","1")
end

function ClickEvent.More( ... )
	-- body
	ClickEvent.ShowSingleYesWindow(3000)
end

function ClickEvent.MallDouButton( ... )
	-- body
	for i=1,5 do
		_popPanel[popPanelIndex].panel:GetChild("MallItemBg"..tostring(i)):GetChild("SaleHint").visible = false
	end
end

function ClickEvent.MallGemsButton( ... )
	-- body
	for i=1,5 do
		_popPanel[popPanelIndex].panel:GetChild("MallItemBg"..tostring(i)):GetChild("SaleHint").visible = false
	end
end

function ClickEvent.MallItemButton( ... )
	-- body
	for i=1,5 do
		_popPanel[popPanelIndex].panel:GetChild("MallItemBg"..tostring(i)):GetChild("SaleHint").visible = false
	end
	_popPanel[popPanelIndex].panel:GetChild("MallItemBg2"):GetChild("SaleHint").visible = true
end

function ClickEvent.RoomCardNum( ... )
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._mall_ui)
	for i=1,5 do
		_popPanel[popPanelIndex].panel:GetChild("MallItemBg"..tostring(i)):GetChild("SaleHint").visible = false
	end
	_popPanel[popPanelIndex].panel:GetChild("MallItemBg2"):GetChild("SaleHint").visible = true
	_popPanel[popPanelIndex].panel:GetChild("MallItemButton").selected = true
	Player.CmdMatTrackCutomKVEvent("Button","MainMenuRoomCard","1")
end

function ClickEvent.DouNum( ... )
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._mall_ui)
	for i=1,5 do
		_popPanel[popPanelIndex].panel:GetChild("MallItemBg"..tostring(i)):GetChild("SaleHint").visible = false
	end
	_popPanel[popPanelIndex].panel:GetChild("MallDouButton").selected = true
	Player.CmdMatTrackCutomKVEvent("Button","MainMenuCoins","1")
end

function ClickEvent.GemsNum( ... )
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._mall_ui)
	for i=1,5 do
		_popPanel[popPanelIndex].panel:GetChild("MallItemBg"..tostring(i)):GetChild("SaleHint").visible = false
	end
	_popPanel[popPanelIndex].panel:GetChild("MallGemsButton").selected = true
	Player.CmdMatTrackCutomKVEvent("Button","MainMenuGems","1")
end

function ClickEvent.PriceButtonGems1( ... )
	-- body
	if CS.LuaCommon.isIos == true then
		if CS.LuaCommon.isCompany == true then
			ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
			_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
			return
		end
		WeChatPlatform:callBilling("xiangle_chaoyan_6yuan")
	else
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
	end
end
function ClickEvent.PriceButtonGems2( ... )
	-- body
	if CS.LuaCommon.isIos == true then
		if CS.LuaCommon.isCompany == true then
			ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
			_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
			return
		end
		WeChatPlatform:callBilling("xiangle_chaoyan_30yuan")
	else
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
	end
end
function ClickEvent.PriceButtonGems3( ... )
	-- body
	if CS.LuaCommon.isIos == true then
		if CS.LuaCommon.isCompany == true then
			ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
			_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
			return
		end
		WeChatPlatform:callBilling("xiangle_chaoyan_68yuan")
	else
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
	end
end
function ClickEvent.PriceButtonGems4( ... )
	-- body
	if CS.LuaCommon.isIos == true then
		if CS.LuaCommon.isCompany == true then
			ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
			_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
			return
		end
		WeChatPlatform:callBilling("xiangle_chaoyan_128yuan")
	else
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
	end
end
function ClickEvent.PriceButtonGems5( ... )
	-- body
	if CS.LuaCommon.isIos == true then
		if CS.LuaCommon.isCompany == true then
			ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
			_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
			return
		end
		WeChatPlatform:callBilling("xiangle_chaoyan_298yuan")
	else
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
	end
end
function ClickEvent.PriceButtonGems6( ... )
	-- body
	if CS.LuaCommon.isIos == true then
		if CS.LuaCommon.isCompany == true then
			ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
			_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
			return
		end
		WeChatPlatform:callBilling("xiangle_chaoyan_618yuan")
	else
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
	end
end

function ClickEvent.PriceButtonDou1( ... )
	-- body
	if CS.LuaCommon.isIos == true then
		if CS.LuaCommon.isCompany == true then
			ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
			_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
			return
		end
	 	Player.CmdBuySomething(655367)
	else
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
	end
end
function ClickEvent.PriceButtonDou2( ... )
	-- body
	if CS.LuaCommon.isIos == true then
		if CS.LuaCommon.isCompany == true then
			ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
			_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
			return
		end
		Player.CmdBuySomething(655368)
	else
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
	end
end
function ClickEvent.PriceButtonDou3( ... )
	-- body
	if CS.LuaCommon.isIos == true then
		Player.CmdBuySomething(655369)
	else
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
	end
end
function ClickEvent.PriceButtonDou4( ... )
	-- body
	if CS.LuaCommon.isIos == true then
		Player.CmdBuySomething(655370)
	else
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
	end
end
function ClickEvent.PriceButtonDou5( ... )
	-- body
	if CS.LuaCommon.isIos == true then
		Player.CmdBuySomething(655371)
	else
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
	end
end
function ClickEvent.PriceButtonDou6( ... )
	-- body
	if CS.LuaCommon.isIos == true then
		Player.CmdBuySomething(655372)
	else
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2027)
	end
end

function ClickEvent.PriceButtonItem1( ... )
	-- body
	if CS.LuaCommon.isIos == true then
		Player.CmdBuySomething(655373)
	else
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2032)
	end
end
function ClickEvent.PriceButtonItem2( ... )
	-- body
	if CS.LuaCommon.isIos == true then
		Player.CmdBuySomething(655374)
	else
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2032)
	end
end

function ClickEvent.Avatar( ... )
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._player_info)
	_popPanel[popPanelIndex].panel:GetChild("BoundAccount").visible = false
	if Player.wechat_nickname and Player.wechat_nickname ~= "" then
		_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerName").text = gbk.toutf8(gbk.fromutf8(Player.wechat_nickname))
	else
		_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerName").text = Player._player_data.common_prop.name
	end
	_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerID").text = tostring(Player._player_data.common_prop.player_id)
	_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
	if Player.wechat_headimgurl and Player.wechat_headimgurl ~= "" then
		_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").url = ""
		local tempTexture = WeChatPlatform:SetAsyncImage(Player.wechat_headimgurl)
		--[[
		WeChatPlatform.func = function ()
			-- body
			local delegateTex = WeChatPlatform:SetAsyncImage(Player.wechat_headimgurl)
			if delegateTex then
				_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").texture = NTexture(delegateTex)
			end
		end
		--]]
		_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").texture = NTexture(tempTexture)
	end
	--_popPanel[popPanelIndex].panel:GetChild("DouNum").text = tostring(Player._player_data.common_prop.huanledou)
	_popPanel[popPanelIndex].panel:GetChild("RoomCardPlay").text = tostring(Player._player_data.common_prop.room_card_rounds)
	_popPanel[popPanelIndex].panel:GetChild("TotalWin").text = tostring(Player._player_data.common_prop.streak_wins)
	_popPanel[popPanelIndex].panel:GetChild("TotalPlay").text = tostring(Player._player_data.common_prop.total_rounds)
	if Player._player_data.common_prop.total_rounds == 0 then
		_popPanel[popPanelIndex].panel:GetChild("WinRate").text = "100%"
	else
		_popPanel[popPanelIndex].panel:GetChild("WinRate").text = tostring(math.modf((Player._player_data.common_prop.total_win_rounds+Player._player_data.common_prop.score_win_rounds/2)*100/(Player._player_data.common_prop.total_rounds*2))+25).."%"
	end
	if Player._client_infomation ~= {} then
		Player.LogWarning("hasIp")
		_popPanel[popPanelIndex].panel:GetChild("IPAddress").text = Player._client_infomation.ip_address
	else
		_popPanel[popPanelIndex].panel:GetChild("IPAddress").text = ""
	end
	Player.CmdMatTrackCutomKVEvent("Button","MainMenuAvatar","1")
end

function ClickEvent.NextRoundButton( ... )
	-- body
	ClickEvent.Close()
	_currentPanel.panel:GetChild("BaoPai"):GetController("BaoPaiShow").selectedIndex = 0
	Player.MahJong.ResetGameState()
	ClickEvent.ShowRoomCalculate()
	Player.CmdMatTrackCutomKVEvent("NextRound","Round"..tostring(Player.room_current_round),"1")
	--if Player._calculate_table_number >= Player._room_information.options.open_rands then
	--end
end

function ClickEvent.NoButton( ... )
	-- body
	if _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText") and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text == StringTable.Get(2009) then
		Player.LoadScene("FairyMainUI")
		return
	elseif _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText") and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text == StringTable.Get(2034) then
		Player.LoadScene("FairyMainUI")
		return
	elseif _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText") and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text == StringTable.Get(2038) then
		CS.UnityEngine.Application.Quit()
		return
	end
	ClickEvent.Close()
end

function ClickEvent.YesButtonSingle( ... )
	-- body
	if _popPanel[popPanelIndex] and _popPanel[popPanelIndex].panel and _popPanel[popPanelIndex].panel:GetChild("TPopText") and _popPanel[popPanelIndex].panel:GetChild("TPopText").text == StringTable.Get(2034) then
		Player.LoadScene("FairyMainUI")
		return
	elseif _popPanel[popPanelIndex] and _popPanel[popPanelIndex].panel and _popPanel[popPanelIndex].panel:GetChild("TPopText") and _popPanel[popPanelIndex].panel:GetChild("TPopText").text == StringTable.Get(2009) then
		Player.LoadScene("FairyMainUI")
		return
	end
	ClickEvent.Close()
end

function ClickEvent.YesButton( ... )
	-- body
	if _popPanel[popPanelIndex] and _popPanel[popPanelIndex].panel and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText") and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text == StringTable.Get(2003) then
		if Player.roomHasBegin == false then
			--Player.returnMainUI = true
			--Player.MahJong.QuitVoiceRoom()
			Player.CmdGameOperation("GAME_OPER_TYPE_LEAVE")
			--Player.LoadScene("FairyMainUI")
		end
	elseif _popPanel[popPanelIndex] and _popPanel[popPanelIndex].panel and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText") and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text == StringTable.Get(2042) then
		Player.returnMainUI = true
		CS.UnityEngine.Time.timeScale = 1
		Player.isReplayFastBackward = true
		if Player.hasFinishReplay == false then
			Player.CmdMatTrackCutomKVEvent("Replay","ReplayNotFinish","1")
		end
		Player.LoadScene("FairyMainUI")
		return
	elseif _popPanel[popPanelIndex] and _popPanel[popPanelIndex].panel and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText") and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text == StringTable.Get(2002) then
		CS.UnityEngine.Application.Quit()
	elseif _popPanel[popPanelIndex] and _popPanel[popPanelIndex].panel and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText") and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text == StringTable.Get(2006) then
		Player.CmdGameOperation("GAME_OPER_TYPE_DISMISS_AGREE")
		if ClickEvent._play_ui.playerAlready.visible == true then
			ClickEvent._play_ui.playerAlready.visible = false
			ClickEvent._play_ui.gamePlayButton.visible = true
		end
	elseif _popPanel[popPanelIndex] and _popPanel[popPanelIndex].panel and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText") and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text == StringTable.Get(2041) then
		ClickEvent.Close()
		if Player.roomHasBegin == false and Player._room_information.options and Player._room_information.options.gmt_opened == true then
			Player.CmdGameOperation("GAME_OPER_TYPE_DISMISS_AGREE")
		else
			ClickEvent.ShowDissmiss()
		end
		return
	elseif _popPanel[popPanelIndex] and _popPanel[popPanelIndex].panel and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText") and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text == StringTable.Get(2009) then
		Player.LoadScene("FairyMainUI")
		return
	elseif _popPanel[popPanelIndex] and _popPanel[popPanelIndex].panel and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText") and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text == StringTable.Get(2036) then
		Player._roomId = Player._player_data.room_id
		Player.LogWarning(tonumber(Player._roomId))
		Player.isFriendRoom = true
		Player.CmdEnterRoom("ROOM_TYPE_FRIEND",Player._roomId)
	elseif _popPanel[popPanelIndex] and _popPanel[popPanelIndex].panel and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText") and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text == StringTable.Get(2034) then
		Player.LoadScene("FairyMainUI")
		return
	elseif _popPanel[popPanelIndex] and _popPanel[popPanelIndex].panel and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText") and _popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text == StringTable.Get(2038) then
		Network.Start()
        Network.ConnetServer()
        Player.disConnetedTime = CS.UnityEngine.Time.time
        Player.hasConnectTimes = Player.hasConnectTimes + 1
	end
	ClickEvent.Close()
end

function ClickEvent.PlayerAvatarInfo( ... )
	-- body
	if not Player._my_player_data then
		return
	end
	ClickEvent.PopPanel(ClickEvent.panelTable._player_info)
	_popPanel[popPanelIndex].panel:RemoveChild(_popPanel[popPanelIndex].panel:GetChild("BoundAccount"))
	Player.LogWarning("playerAvatarInfo")
	for k,v in pairs(Player._all_players_data) do
		Player.LogWarning(v.position)
		local tempX = _position_index[v.position] - _position_index[Player._my_player_data.position]
		if tempX == 0 then
			_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerID").text = tostring(v.common_prop.player_id)
			if v.wechat ~= {} and v.wechat.nickname and v.wechat.nickname ~= "" then
				_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerName").text = gbk.toutf8(gbk.fromutf8(v.wechat.nickname))
			else
				_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerName").text = tostring(v.common_prop.name)
			end
			--_popPanel[popPanelIndex].panel:GetChild("DouNum").text = tostring(v.common_prop.huanledou)
			--_popPanel[popPanelIndex].panel:GetChild("GemsNum").text = tostring(v.common_prop.diamond)
			_popPanel[popPanelIndex].panel:GetChild("TotalWin").text = tostring(v.common_prop.streak_wins)
			_popPanel[popPanelIndex].panel:GetChild("TotalPlay").text = tostring(v.common_prop.total_rounds)
			_popPanel[popPanelIndex].panel:GetChild("RoomCardPlay").text = tostring(v.common_prop.room_card_rounds)
			if v.common_prop.total_rounds == 0 then
				_popPanel[popPanelIndex].panel:GetChild("WinRate").text = "100%"
			else
				_popPanel[popPanelIndex].panel:GetChild("WinRate").text = tostring(math.modf((v.common_prop.total_win_rounds+v.common_prop.score_win_rounds/2)*100/(v.common_prop.total_rounds*2))+25).."%"
			end
			if v.wechat ~= {} and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
				_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").url = ""
				local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
				if tempTexture then
					_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").texture = NTexture(tempTexture)
				end
			end
			if Player.isPlayBack == false then
				_popPanel[popPanelIndex].panel:GetChild("IPAddress").text = tostring(v.ip_address)
			else
				_popPanel[popPanelIndex].panel:GetChild("IPAddress").text = ""
			end
			return
		end
	end
	ClickEvent.Close()
end

function ClickEvent.BehindPlayerAvatarInfo( ... )
	-- body
	if not Player._my_player_data then
		return
	end
	ClickEvent.PopPanel(ClickEvent.panelTable._other_player_info)
	_popPanel[popPanelIndex].panel:RemoveChild(_popPanel[popPanelIndex].panel:GetChild("KickOutRoomButton"))
	if Player._my_player_data.position ~= "POSITION_TYPE_EAST" then
	end
	for k,v in pairs(Player._all_players_data) do
		local tempX = _position_index[v.position] - _position_index[Player._my_player_data.position]
		if tempX == 1 then
			_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerID").text = tostring(v.common_prop.player_id)
			if v.wechat ~= {} and v.wechat.nickname and v.wechat.nickname ~= "" then
				_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerName").text = tostring(gbk.toutf8(gbk.fromutf8(v.wechat.nickname)))
			else
				_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerName").text = tostring(v.common_prop.name)
			end
			--_popPanel[popPanelIndex].panel:GetChild("DouNum").text = tostring(v.common_prop.huanledou)
			_popPanel[popPanelIndex].panel:GetChild("TotalWin").text = tostring(v.common_prop.streak_wins)
			_popPanel[popPanelIndex].panel:GetChild("TotalPlay").text = tostring(v.common_prop.total_rounds)
			_popPanel[popPanelIndex].panel:GetChild("RoomCardPlay").text = tostring(v.common_prop.room_card_rounds)
			if v.common_prop.total_rounds == 0 then
				_popPanel[popPanelIndex].panel:GetChild("WinRate").text = "100%"
			else
				_popPanel[popPanelIndex].panel:GetChild("WinRate").text = tostring(math.modf((v.common_prop.total_win_rounds+v.common_prop.score_win_rounds/2)*100/(v.common_prop.total_rounds*2))+25).."%"
			end
			_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
			if v.wechat ~= {} and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
				_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").url = ""
				local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
				--[[
				WeChatPlatform.func = nil
				WeChatPlatform.func = function ()
					-- body
					local delegateTex = WeChatPlatform:SetAsyncImage(v.wechat_headimgurl)
					if delegateTex then
						_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").texture = NTexture(delegateTex)
					end
				end
				--]]
				if tempTexture then
					_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").texture = NTexture(tempTexture)
				end
			end
			if Player.isPlayBack == false then
				_popPanel[popPanelIndex].panel:GetChild("IPAddress").text = tostring(v.ip_address)
			else
				_popPanel[popPanelIndex].panel:GetChild("IPAddress").text = ""
			end
			--[[
			_popPanel[popPanelIndex].panel:GetChild("n64").text = "GPS未开启"
			for gpsKey,gpsData in pairs(v.dis_list) do
				if Player._my_player_data.position == gpsData.position then
					if gpsData.distance ~= -1.0 then
						_popPanel[popPanelIndex].panel:GetChild("n64").text = tostring(math.ceil(gpsData.distance)).."m"
					end
				end
			end
			--]]
			return
		end
	end
	ClickEvent.Close()
end

function ClickEvent.OppositePlayerAvatarInfo( ... )
	-- body
	if not Player._my_player_data then
		return
	end
	ClickEvent.PopPanel(ClickEvent.panelTable._other_player_info)
	_popPanel[popPanelIndex].panel:RemoveChild(_popPanel[popPanelIndex].panel:GetChild("KickOutRoomButton"))
	if Player._my_player_data.position ~= "POSITION_TYPE_EAST" then
	end
	for k,v in pairs(Player._all_players_data) do
		local tempX = _position_index[v.position] - _position_index[Player._my_player_data.position]
		if tempX == 2 then
			_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerID").text = tostring(v.common_prop.player_id)
			if v.wechat ~= {} and v.wechat.nickname and v.wechat.nickname ~= "" then
				_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerName").text = tostring(gbk.toutf8(gbk.fromutf8(v.wechat.nickname)))
			else
				_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerName").text = tostring(v.common_prop.name)
			end
			--_popPanel[popPanelIndex].panel:GetChild("DouNum").text = tostring(v.common_prop.huanledou)
			_popPanel[popPanelIndex].panel:GetChild("TotalWin").text = tostring(v.common_prop.streak_wins)
			_popPanel[popPanelIndex].panel:GetChild("TotalPlay").text = tostring(v.common_prop.total_rounds)
			_popPanel[popPanelIndex].panel:GetChild("RoomCardPlay").text = tostring(v.common_prop.room_card_rounds)
			if v.common_prop.total_rounds == 0 then
				_popPanel[popPanelIndex].panel:GetChild("WinRate").text = "100%"
			else
				_popPanel[popPanelIndex].panel:GetChild("WinRate").text = tostring(math.modf((v.common_prop.total_win_rounds+v.common_prop.score_win_rounds/2)*100/(v.common_prop.total_rounds*2))+25).."%"
			end
			_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
			if v.wechat ~= {} and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
				_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").url = ""
				local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
				--[[
				WeChatPlatform.func = nil
				WeChatPlatform.func = function ()
					-- body
					local delegateTex = WeChatPlatform:SetAsyncImage(v.wechat_headimgurl)
					if delegateTex then
						_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").texture = NTexture(delegateTex)
					end
				end
				--]]
				if tempTexture then
					_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").texture = NTexture(tempTexture)
				end
			end
			if Player.isPlayBack == false then
				_popPanel[popPanelIndex].panel:GetChild("IPAddress").text = tostring(v.ip_address)
			else
				_popPanel[popPanelIndex].panel:GetChild("IPAddress").text = ""
			end
			--[[
			_popPanel[popPanelIndex].panel:GetChild("n64").text = "GPS未开启"
			for gpsKey,gpsData in pairs(v.dis_list) do
				if Player._my_player_data.position == gpsData.position then
					if gpsData.distance ~= -1.0 then
						_popPanel[popPanelIndex].panel:GetChild("n64").text = tostring(math.ceil(gpsData.distance)).."m"
					end
				end
			end
			--]]
			return
		end
	end
	ClickEvent.Close()
end

function ClickEvent.FrontPlayerAvatarInfo( ... )
	-- body
	if not Player._my_player_data then
		return
	end
	ClickEvent.PopPanel(ClickEvent.panelTable._other_player_info)
	_popPanel[popPanelIndex].panel:RemoveChild(_popPanel[popPanelIndex].panel:GetChild("KickOutRoomButton"))
	if Player._my_player_data.position ~= "POSITION_TYPE_EAST" then
	end
	for k,v in pairs(Player._all_players_data) do
		local tempX = _position_index[v.position] - _position_index[Player._my_player_data.position]
		if tempX == 3 then
			_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerID").text = tostring(v.common_prop.player_id)
			if v.wechat ~= {} and v.wechat.nickname and v.wechat.nickname ~= "" then
				_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerName").text = tostring(gbk.toutf8(gbk.fromutf8(v.wechat.nickname)))
			else
				_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("PlayerName").text = tostring(v.common_prop.name)
			end
			--_popPanel[popPanelIndex].panel:GetChild("DouNum").text = tostring(v.common_prop.huanledou)
			_popPanel[popPanelIndex].panel:GetChild("TotalWin").text = tostring(v.common_prop.streak_wins)
			_popPanel[popPanelIndex].panel:GetChild("TotalPlay").text = tostring(v.common_prop.total_rounds)
			_popPanel[popPanelIndex].panel:GetChild("RoomCardPlay").text = tostring(v.common_prop.room_card_rounds)
			if v.common_prop.total_rounds == 0 then
				_popPanel[popPanelIndex].panel:GetChild("WinRate").text = "100%"
			else
				_popPanel[popPanelIndex].panel:GetChild("WinRate").text = tostring(math.modf((v.common_prop.total_win_rounds+v.common_prop.score_win_rounds/2)*100/(v.common_prop.total_rounds*2))+25).."%"
			end
			_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
			if v.wechat ~= {} and v.wechat.headimgurl and v.wechat.headimgurl ~= "" then
				_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").url = ""
				local tempTexture = WeChatPlatform:SetAsyncImage(v.wechat.headimgurl)
				--[[
				WeChatPlatform.func = nil
				WeChatPlatform.func = function ()
					-- body
					local delegateTex = WeChatPlatform:SetAsyncImage(v.wechat_headimgurl)
					if delegateTex then
						_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").texture = NTexture(delegateTex)
					end
				end
				--]]
				if tempTexture then
					_popPanel[popPanelIndex].panel:GetChild("PlayerInformation"):GetChild("AvatarLoader").texture = NTexture(tempTexture)
				end
			end
			if Player.isPlayBack == false then
				_popPanel[popPanelIndex].panel:GetChild("IPAddress").text = tostring(v.ip_address)
			else
				_popPanel[popPanelIndex].panel:GetChild("IPAddress").text = ""
			end
			--[[
			_popPanel[popPanelIndex].panel:GetChild("n64").text = "GPS未开启"
			for gpsKey,gpsData in pairs(v.dis_list) do
				if Player._my_player_data.position == gpsData.position then
					if gpsData.distance ~= -1.0 then
						_popPanel[popPanelIndex].panel:GetChild("n64").text = tostring(math.ceil(gpsData.distance)).."m"
					end
				end
			end
			--]]
			return
		end
	end
	ClickEvent.Close()
end

function ClickEvent.PlayerID( gameObject )
	-- body
	Player._string_id = gameObject:GetComponent("InputField").text
end

function ClickEvent.PlayerPassword( gameObject )
	-- body
	Player._password = gameObject:GetComponent("InputField").text
end

function ClickEvent.LoginButton(gameObject)
	-- body
	--[[
	--]]
	local textShow = _currentPanel.panel:GetChild("Account"):GetChild("InputText")
	Player._string_id = textShow.text
	Player.CmdLogin(Player._string_id,nil,"ACCOUNT_TYPE_8HERE")

end
function ClickEvent.Account( gameObject )
	-- body
	Player.LogWarning(gameObject.name)
end

function ClickEvent.GuestLogin( gameObject )
	-- body
	--[[
	if _currentPanel.toggleList and _currentPanel.toggleList[0].isOn then
		ClickEvent.DestroyPanel(_currentPanel.panel)
		ClickEvent.CreateNewPanel(ClickEvent.panelTable._choose_ui)
	else
		Player.LogWarning("no find toggle")
	end
	Player.CmdEnterGame(Player._id)
	--]]
	if _currentPanel.panel:GetChild("ServiceCheck") and _currentPanel.panel:GetChild("ServiceCheck").selected == false then
		ClickEvent.ShowSingleYesWindow(2080)
		return
	end

	Player.wechat_nickname = ""
    Player.wechat_sex = ""
    Player.wechat_headimgurl = ""
    --[[
	if not Player.coolDown then
		Player.coolDown = CS.UnityEngine.Time.time
	else
		if (CS.UnityEngine.Time.time - Player.coolDown) <= Player.connectTimes then
			return
		else
			Player.coolDown = CS.UnityEngine.Time.time
		end
	end
    --]]

	local path = CS.UnityEngine.Application.persistentDataPath.."/"
	local openIdFile = io.open(path.."guestID.txt")
	if not openIdFile then
		Player._string_id = ""
		Player.CmdGuestLogin()
	else
		Player._string_id = openIdFile:read "*a"
        openIdFile:close()
        Player.CmdLogin(Player._string_id,nil,"ACCOUNT_TYPE_GUEST")
	end
	Player.LogWarning("ClickEvent.GuestLogin")
	Player.CmdMatTrackCutomKVEvent("Button","GuestLogin","1")
end

function ClickEvent.WechatLogin(gameObject)
	-- body
	--[[
	if not Player.coolDown then
		Player.coolDown = CS.UnityEngine.Time.time
	else
		if (CS.UnityEngine.Time.time - Player.coolDown) <= Player.connectTimes then
			return
		else
			Player.coolDown = CS.UnityEngine.Time.time
		end
	end
	--]]
	if _currentPanel.panel:GetChild("ServiceCheck") and _currentPanel.panel:GetChild("ServiceCheck").selected == false then
		ClickEvent.ShowSingleYesWindow(2080)
		return
	end

	Player.LogWarning("ClickEvent.WechatLogin")
	local path = CS.UnityEngine.Application.persistentDataPath.."/"
	--[[
	Player._string_id = WeChatPlatform:GetData("getOpenID")
	Player.wechat_nickname = WeChatPlatform:GetData("getNickName")
	Player.LogWarning(Player._string_id)
		Player.wechat_sex = WeChatPlatform:GetData("getUserSex")
		Player.wechat_headimgurl = WeChatPlatform:GetData("getImageUrl")
		WeChatPlatform:SetAsyncImage(WeChatPlatform:GetData("getImageUrl"))
		Player.CmdLogin(Player._string_id)
		Player.LogWarning("WeChatLogin")
	--]]
	local openIdFile = io.open(path.."openID.txt")
	if not openIdFile then
		Player._string_id = ""
	else
		Player._string_id = openIdFile:read "*a"
        openIdFile:close()
	end
	--Player.wechat_code = WeChatPlatform:GetData("getWXCode")
	Player.LogWarning(Player._string_id)
	if not Player._string_id or Player._string_id == "" then
		if not Player.wechat_code or Player.wechat_code == "" then
			WeChatPlatform.onWeChatCallBack = function(paraCode)
				-- body
				Player.sayHiTimestarmp = CS.UnityEngine.Time.realtimeSinceStartup
				Player.wechat_code = paraCode--WeChatPlatform:GetData("getWXCode")

				ClickEvent.GetWeChatByHttp(Player.wechat_code,nil)
				--Player.CmdWechatLogin(Player.wechat_code)

				WeChatPlatform.onWeChatCallBack = nil
				if not Player.coolDown then
					Player.coolDown = CS.UnityEngine.Time.time
				else
					if Player.coolDown - CS.UnityEngine.Time.time <= Player.connectTimes then
						return
					else
						Player.coolDown = CS.UnityEngine.Time.time
					end
				end
			end
			WeChatPlatform:LoginWeChat()
		else
			Player.LogWarning("getWXMsg")
			ClickEvent.GetWeChatByHttp(Player.wechat_code,nil)
			--Player.CmdWechatLogin(Player.wechat_code)
		end
	else
		--ClickEvent.GetWeChatByHttp(Player._string_id,nil)
		ClickEvent.GetWeChatByHttp(nil,Player._string_id)
		--Player.CmdLogin(Player._string_id,nil,"ACCOUNT_TYPE_WECHAT")
	end
	Player.CmdMatTrackCutomKVEvent("Button","WechatLogin","1")
end

function ClickEvent.GetWeChatByHttp(paraCode,openId)
	-- body
	local path = CS.UnityEngine.Application.persistentDataPath.."/"
	local httpTokenFile = io.open(path.."httpToken.txt")
	if not httpTokenFile then
		MainUICT.GetHttpToken(2,paraCode,openId)
	else
		Player.httpToken = httpTokenFile:read "*a"
        httpTokenFile:close()
		if Player.httpToken ~= "" then
	        ClickEvent.GetUserInfoByCode(paraCode,openId)
	    else
	    	MainUICT.GetHttpToken(2,paraCode,openId)
		end
	end
end

function ClickEvent.GetUserInfoByCode(wechatCode,openId)
	-- body
	Player.LogWarning("GetUserInfoByCode")
	local co = coroutine.create(function()
		local header = {}
		header.jwt = Player.httpToken
		header["User-Agent"] = "BH-MJProject"..Player.pc_version
		local userUrl = wechatHttpUrl
		userUrl = userUrl.."code="
		if wechatCode then
			userUrl = userUrl..wechatCode
		end
		userUrl = userUrl.."&open_id="
		if openId then
			userUrl = userUrl..openId
		end
		Player.LogWarning("wechatData:"..userUrl)
		local www = CS.UnityEngine.WWW(userUrl, rapidjson.encode(header.jwt), header)
		yield_return(www)
		if not www.error then
			Player.LogWarning("wechatData:"..www.text)
			local jsonData = rapidjson.decode(www.text)
			Player.LogWarning("wechatData:"..jsonData.code)
			if jsonData.code == 0 then
				if not openId then
					Player._string_id = jsonData.data.openid
					local path = CS.UnityEngine.Application.persistentDataPath.."/"
			        local mFile = io.open(path.."openID.txt" ,"w")
			        mFile:write(Player._string_id)  
			        mFile:close()
				end
		        Player.wechat_nickname = jsonData.data.nickname
		        Player.wechat_sex = jsonData.data.sex
		        Player.wechat_headimgurl = jsonData.data.headimgurl
		        Player.CmdWechatLogin(Player._string_id,Player.wechat_nickname,Player.wechat_sex,Player.wechat_headimgurl)
		        Player.CmdLogin(Player._string_id,nil,"ACCOUNT_TYPE_WECHAT")
		        Player.CmdMatTrackCutomKVEvent("Button","WechatLoginSuccess","1")
			elseif jsonData.code == 200201 or jsonData.code == 200200 then
				Player.LogWarning("resetWechat")
				os.remove(CS.UnityEngine.Application.persistentDataPath.."/openID.txt")
				WeChatPlatform.onWeChatCallBack = function(paraCode)
				-- body
					Player.sayHiTimestarmp = CS.UnityEngine.Time.realtimeSinceStartup
					Player.wechat_code = paraCode--WeChatPlatform:GetData("getWXCode")

					ClickEvent.GetWeChatByHttp(Player.wechat_code,nil)
					--Player.CmdWechatLogin(Player.wechat_code)

					WeChatPlatform.onWeChatCallBack = nil
					if not Player.coolDown then
						Player.coolDown = CS.UnityEngine.Time.time
					else
						if Player.coolDown - CS.UnityEngine.Time.time <= Player.connectTimes then
							return
						else
							Player.coolDown = CS.UnityEngine.Time.time
						end
					end
				end
				WeChatPlatform:LoginWeChat()
			else
				Player.LogWarning("httpException")
			end
			
		else
			CS.UnityEngine.Debug.LogWarning('error:'..www.error)
		end
    end)
    coroutine.resume(co)
end

function ClickEvent.OnReceivedWeChatMsg(nickname, sex, headimgurl)
	-- body
	Player.wechat_nickname = nickname
	Player.wechat_sex = sex
	Player.wechat_headimgurl = headimgurl
	Player.LogWarning(Player.wechat_nickname)
	Player.LogWarning(player.wechat_sex)
	Player.LogWarning(player.wechat_headimgurl)
end

function ClickEvent.ThreadToMainMenu( ... )
	-- body
	ClickEvent.DeletePanel(_currentPanel.panel)
	ClickEvent.CreateNewPanel(ClickEvent.panelTable._choose_ui)
	if Player._player_data.game_setting.music and not AudioPlayer.isPlaying(AudioPlayer._audio_name.Bgm) then
		AudioPlayer.PlaySound(AudioPlayer._audio_name.Bgm,true,0.5)
	end
end

function ClickEvent.Admit( gameObject )
	-- body
end

function ClickEvent.Back( ... )
	-- body
	if not ClickEvent.isInDouRoom and _currentPanel.panel.name == ClickEvent.panelTable._choose_ui then
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2002)
		--_currentPanel.panel:GetTransition("ShowFriendMode"):Stop(true,false)
		--ClickEvent.DeletePanel(_currentPanel.panel)
		--ClickEvent.CreateNewPanel(ClickEvent.panelTable._main_ui)
	else
		ClickEvent.isInDouRoom = false
		_currentPanel.panel:GetTransition("ShowFriendMode"):Play()
	end
end

function ClickEvent.PlayerLogo( ... )
	-- body
	Player.LogWarning("playLogoShow")
	ClickEvent.PopPanel(ClickEvent.panelTable._player_message_ui)
	--_Player_Message_UI:SetActive(true)
end

function ClickEvent.DiamondPlus( ... )
	-- body
	Player.LogWarning("DiamondPlusShow")
end

function ClickEvent.BeanPlus( ... )
	-- body
	Player.LogWarning("BeanPlusShow")
end

function ClickEvent.TicketPlus( ... )
	-- body
	Player.LogWarning("TicketPlusShow")
end

function ClickEvent.DouRoomButton( ... )
	-- body
	--[[
	if _currentPanel.panel:GetTransition("HideFriendMode").playing then
		return
	end
	_currentPanel.panel:GetTransition("HideFriendMode"):Play()
	ClickEvent.isInDouRoom = true
	--]]

	ClickEvent.ShowSingleYesWindow(3000)
	Player.CmdMatTrackCutomKVEvent("Button","MainMenuMatchRoom","1")
end

function ClickEvent.GetintoRoomButton( ... )
	-- body
	Player.LogWarning("JoinRoom")
	if Player._player_data.room_id and Player._player_data.room_id ~= 0 then
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2036)
		return
	end
	ClickEvent.PopPanel(ClickEvent.panelTable._join_room_ui)
	Player._roomId = ""
	_popPanel[popPanelIndex].panel:GetChild("InputText").text = ""
	Player.CmdMatTrackCutomKVEvent("Button","MainMenuJoinRoom","1")
end

function ClickEvent.CreateRoomButton( ... )
	-- body
	Player.LogWarning("CreateRoom")
	if Player._player_data.room_id and Player._player_data.room_id ~= 0 then
		ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
		_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2036)
		return
	end
	ClickEvent.PopPanel(ClickEvent.panelTable._create_room_ui)
	local costCard = 0
	if _popPanel[popPanelIndex].panel:GetChild("Round4").selected then
		costCard = 1
	elseif _popPanel[popPanelIndex].panel:GetChild("Round8").selected then
		costCard = 2
	end
	_popPanel[popPanelIndex].panel:GetChild("GvoiceClose").selected = true
	if _popPanel[popPanelIndex].panel:GetChild("AAPay") and _popPanel[popPanelIndex].panel:GetChild("AAPay").selected == true then
		_popPanel[popPanelIndex].panel:GetChild("RoomCardNum").text = tostring(costCard).."/"..tostring(Player._player_data.common_prop.room_card_count)
	else
		_popPanel[popPanelIndex].panel:GetChild("RoomCardNum").text = tostring(costCard*4).."/"..tostring(Player._player_data.common_prop.room_card_count)
	end
	for i=1,7 do
		_popPanel[popPanelIndex].panel:GetChild("ChooseFan0"..tostring(i)).selected = true
	end
	_popPanel[popPanelIndex].panel:GetChild("ChooseFan05").selected = false
	_popPanel[popPanelIndex].panel:GetChild("MultipleNolimit").selected = true
	--_popPanel[popPanelIndex].panel:GetChild("HighRiskMode").selected = true
	Player.CmdMatTrackCutomKVEvent("Button","MainMenuCreateRoom","1")
	--CS.UnityEngine.Application.LoadLevel("PlaySence")
end

function ClickEvent.Round4( ... )
	-- body
	if _popPanel[popPanelIndex].panel:GetChild("AAPay") and _popPanel[popPanelIndex].panel:GetChild("AAPay").selected == true then
		_popPanel[popPanelIndex].panel:GetChild("RoomCardNum").text = "1/"..tostring(Player._player_data.common_prop.room_card_count)
	else
		_popPanel[popPanelIndex].panel:GetChild("RoomCardNum").text = "4/"..tostring(Player._player_data.common_prop.room_card_count)
	end
end

function ClickEvent.Round8( ... )
	-- body
	if _popPanel[popPanelIndex].panel:GetChild("AAPay") and _popPanel[popPanelIndex].panel:GetChild("AAPay").selected == true then
		_popPanel[popPanelIndex].panel:GetChild("RoomCardNum").text = "2/"..tostring(Player._player_data.common_prop.room_card_count)
	else
		_popPanel[popPanelIndex].panel:GetChild("RoomCardNum").text = "8/"..tostring(Player._player_data.common_prop.room_card_count)
	end
end

function ClickEvent.FreshHandButton( ... )
	-- body
	--[[--]]
	Player.CmdEnterRoom("ROOM_TYPE_XINSHOU")
	Player.isFriendRoom = false
	Player.isWaitingList = true
	Player.waitingTimestamp = CS.UnityEngine.Time.time
	_currentPanel.panel:GetTransition("WaitingPopIn"):Play()
end

function ClickEvent.MasterHandButton( ... )
	-- body
	Player.CmdEnterRoom("ROOM_TYPE_GAOSHOU")
	Player.isFriendRoom = false
	Player.isWaitingList = true
	Player.waitingTimestamp = CS.UnityEngine.Time.time
	_currentPanel.panel:GetTransition("WaitingPopIn"):Play()
end

function ClickEvent.GreatNasterHandButton( ... )
	-- body
	Player.CmdEnterRoom("ROOM_TYPE_DASHI")
	Player.isFriendRoom = false
	Player.isWaitingList = true
	Player.waitingTimestamp = CS.UnityEngine.Time.time
	_currentPanel.panel:GetTransition("WaitingPopIn"):Play()
end

function ClickEvent.CloseWaiting( ... )
	-- body
	Player.isWaitingList = false
	_currentPanel.panel:GetTransition("WaitingPopOut"):Play()
end

function ClickEvent.CloseByName( deleteName )
	-- body
	Player.LogWarning("CloseByName")
	if popPanelIndex <= 0 then
		return false
	end
	if deleteName then
		local deleteNumber = 0
		local tempPanel = nil
		for i=1,popPanelIndex do
			if _popPanel[i].panel.name == deleteName then
				deleteNumber = i
				tempPanel = _popPanel[deleteNumber]
			end
		end
		if deleteNumber == 0 then
			return
		end
		for i=deleteNumber,popPanelIndex-1 do
			_popPanel[i] = _popPanel[i+1]
		end
		_popPanel[popPanelIndex] = tempPanel
	end
	--[[
	--]]
	GRoot.inst:RemoveChild(_popPanel[popPanelIndex].panel)
	_popPanel[popPanelIndex].panel = nil
	if _popPanel[popPanelIndex].background then
		GRoot.inst:RemoveChild(_popPanel[popPanelIndex].background)
		_popPanel[popPanelIndex].background = nil
	end
	popBgIndex = popBgIndex - 1
	popPanelIndex = popPanelIndex - 1
	if popPanelIndex < 0 then
		popPanelIndex = 0
	end
	if popBgIndex < 0 then
		popBgIndex = 0
	end
end

function ClickEvent.Close()
	-- body
	Player.LogWarning("ClosePanel")
	if popPanelIndex <= 0 then
		return false
	end
	--[[
	if deleteNumber and deleteNumber < popPanelIndex and deleteNumber > 0 then
		local tempPanel = _popPanel[deleteNumber]
		for i=deleteNumber,popPanelIndex-1 do
			_popPanel[i] = _popPanel[i+1]
		end
		_popPanel[popPanelIndex] = tempPanel
	end
	--]]
	if _popPanel[popPanelIndex].panel.name == ClickEvent.panelTable._setting_play_ui or _popPanel[popPanelIndex].panel.name == ClickEvent.panelTable._setting_ui then
		local zhuobu = "ZHUOBU_TYPE_GREEN"
		if Player.tablecloth == 1 then
			zhuobu = "ZHUOBU_TYPE_BLUE"
		elseif Player.tablecloth == 2 then
			zhuobu = "ZHUOBU_TYPE_RED"
		else
			zhuobu = "ZHUOBU_TYPE_GREEN"
		end
		local paiColor = "CARD_COLOR_TYPE_GREEN"
		if Player.paiSizeSet == 1 then
			paiColor = "CARD_COLOR_TYPE_BLUE"
		elseif Player.paiSizeSet == 2 then
			paiColor = "CARD_COLOR_TYPE_GOLDEN"
		else
			paiColor = "CARD_COLOR_TYPE_GREEN"
		end
		Player.CmdGameSetting(Player._player_data.game_setting.music, Player._player_data.game_setting.voice, Player._player_data.game_setting.audio, Player._player_data.game_setting.click_push,zhuobu,paiColor)
	end

	GRoot.inst:RemoveChild(_popPanel[popPanelIndex].panel)
	_popPanel[popPanelIndex].panel = nil
	if _popPanel[popPanelIndex].background then
		GRoot.inst:RemoveChild(_popPanel[popPanelIndex].background)
		_popPanel[popPanelIndex].background = nil
	end
	popBgIndex = popBgIndex - 1
	popPanelIndex = popPanelIndex - 1
	if popPanelIndex < 0 then
		popPanelIndex = 0
	end
	if popBgIndex < 0 then
		popBgIndex = 0
	end
end

function ClickEvent.CreateRoomId( gameObject )
	-- body
	Player._roomId = tonumber(gameObject:GetComponent("InputField").text)
	Player.LogWarning(gameObject.name)
end

function ClickEvent.RoomOwnerPay( ... )
	-- body
	--_popPanel[popPanelIndex].panel:GetChild("Troomcardnum").text = "拥有房卡:"
	local usedCount = ""
	if _popPanel[popPanelIndex].panel:GetChild("Round4").selected == true then
		usedCount = "4/"
	else
		usedCount = "8/"
	end
	_popPanel[popPanelIndex].panel:GetChild("RoomCardNum").text = usedCount..tostring(Player._player_data.common_prop.room_card_count)
end

function ClickEvent.AAPay( ... )
	-- body
	--_popPanel[popPanelIndex].panel:GetChild("Troomcardnum").text = "拥有钻石:"
	local usedCount = ""
	if _popPanel[popPanelIndex].panel:GetChild("Round4").selected == true then
		usedCount = "1/"
	else
		usedCount = "2/"
	end
	_popPanel[popPanelIndex].panel:GetChild("RoomCardNum").text = usedCount..tostring(Player._player_data.common_prop.room_card_count)
end

function ClickEvent.ClassicMode( ... )
	-- body
	for i=1,7 do
		_popPanel[popPanelIndex].panel:GetChild("ChooseFan0"..tostring(i)).selected = false
	end
	_popPanel[popPanelIndex].panel:GetChild("Multiple32").selected = true
end

function ClickEvent.HighRiskMode( ... )
	-- body
	for i=1,7 do
		_popPanel[popPanelIndex].panel:GetChild("ChooseFan0"..tostring(i)).selected = true
	end
	_popPanel[popPanelIndex].panel:GetChild("MultipleNolimit").selected = true
end

function ClickEvent.CreateButton( )
	-- body
	--roomid
	Player.LogWarning("CreateRoom")
	local model = nil
	local extend_type = {}
	local top_mutiple = nil
	local open_rands = nil
	local costCard = 0
	local cardActivity = false

	--[[
	if _popPanel[popPanelIndex].panel:GetChild("ClassicMode").selected then
		model = "ROOM_MODEL_TYPE_CLASSICAL"
	elseif _popPanel[popPanelIndex].panel:GetChild("HighRiskMode").selected then
		model = "ROOM_MODEL_TYPE_MULTIPLE"
	end
	--]]

	if _popPanel[popPanelIndex].panel:GetChild("Multiple32").selected then
		top_mutiple = 32
	elseif _popPanel[popPanelIndex].panel:GetChild("MultipleNolimit").selected then
		top_mutiple = 0
	end

	if _popPanel[popPanelIndex].panel:GetChild("Round4").selected then
		costCard = 1
		open_rands = 8
	elseif _popPanel[popPanelIndex].panel:GetChild("Round8").selected then
		costCard = 2
		open_rands = 16
	end

	local voice_open = 0
	if _popPanel[popPanelIndex].panel:GetChild("GvoiceOn").selected then
		voice_open = 1
	end

	local extend_type_count = 1
	if _popPanel[popPanelIndex].panel:GetChild("ChooseFan01").selected then
		extend_type[extend_type_count] = "ROOM_EXTEND_TYPE_ZHANLIHU"
		extend_type_count = extend_type_count + 1
	end
	if _popPanel[popPanelIndex].panel:GetChild("ChooseFan02").selected then
		extend_type[extend_type_count] = "ROOM_EXTEND_TYPE_JIAHU"
		extend_type_count = extend_type_count + 1
	end
	if _popPanel[popPanelIndex].panel:GetChild("ChooseFan03").selected then
		extend_type[extend_type_count] = "ROOM_EXTEND_TYPE_XUANFENGGANG"
		extend_type_count = extend_type_count + 1
	end
	if _popPanel[popPanelIndex].panel:GetChild("ChooseFan04").selected then
		extend_type[extend_type_count] = "ROOM_EXTEND_TYPE_BAOPAI"
		extend_type_count = extend_type_count + 1
	end
	if _popPanel[popPanelIndex].panel:GetChild("ChooseFan05").selected then
		extend_type[extend_type_count] = "ROOM_EXTEND_TYPE_DUANMEN"
		extend_type_count = extend_type_count + 1
	end
	if _popPanel[popPanelIndex].panel:GetChild("ChooseFan06").selected then
		extend_type[extend_type_count] = "ROOM_EXTEND_TYPE_QIYISE"
		extend_type_count = extend_type_count + 1
	end
	if _popPanel[popPanelIndex].panel:GetChild("ChooseFan07").selected then
		extend_type[extend_type_count] = "ROOM_EXTEND_TYPE_BAOSANJIA"
		extend_type_count = extend_type_count + 1
	end
	if Player.activityTable then
		for k,v in pairs(Player.activityTable) do
			if v.activity_id == Player.activityDataTable.room_card_limit_free_activity_id then
				if v.open == true then
					cardActivity = true
				end
				break
			end
		end
	end
	if cardActivity == true then
		ClickEvent.Close()
		Player.CmdCreateRoom(model,extend_type,top_mutiple,open_rands,voice_open)
		Player.isFriendRoom = true
	else
		if _popPanel[popPanelIndex].panel:GetChild("AAPay") and _popPanel[popPanelIndex].panel:GetChild("AAPay").selected == true then
			ClickEvent.Close()
			if Player._player_data.common_prop.room_card_count >= costCard then
				Player.CmdCreateRoom(model,extend_type,top_mutiple,open_rands,voice_open,"ROOM_PAY_TYPE_AA")
				Player.isFriendRoom = true
			else
				ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
				_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2032)
			end
		else
			ClickEvent.Close()
			if Player._player_data.common_prop.room_card_count >= costCard*4 then
				Player.CmdCreateRoom(model,extend_type,top_mutiple,open_rands,voice_open,"ROOM_PAY_TYPE_HOSTER")
				Player.isFriendRoom = true
			else
				Player.CmdMatTrackCutomKVEvent("NotEnoughRoomCard","NotEnoughRoomCard","1")
				ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
				_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2032)
			end
		end
	end
	--[[
	Player.CmdCreateRoom(model,extend_type,top_mutiple,open_rands)
	Player.isFriendRoom = true
	--]]
end

function ClickEvent.MatModelCheck( ... )
	-- body

	if _popPanel[popPanelIndex].panel:GetChild("Multiple32").selected then
		Player.CmdMatTrackCutomKVEvent("Button","Mulit32","1")
	elseif _popPanel[popPanelIndex].panel:GetChild("MultipleNolimit").selected then
		Player.CmdMatTrackCutomKVEvent("Button","MulitNoLimit","1")
	end

	if _popPanel[popPanelIndex].panel:GetChild("Round4").selected then
		Player.CmdMatTrackCutomKVEvent("Button","Round8","1")
	elseif _popPanel[popPanelIndex].panel:GetChild("Round8").selected then
		Player.CmdMatTrackCutomKVEvent("Button","Round16","1")
	end

	if _popPanel[popPanelIndex].panel:GetChild("GvoiceOn").selected then
		Player.CmdMatTrackCutomKVEvent("Button","Gvoice","1")
	end

	local extend_type_count = 1
	if _popPanel[popPanelIndex].panel:GetChild("ChooseFan01").selected then
		Player.CmdMatTrackCutomKVEvent("Button","ZhanLiHu","1")
	end
	if _popPanel[popPanelIndex].panel:GetChild("ChooseFan02").selected then
		Player.CmdMatTrackCutomKVEvent("Button","DaiJiaHu","1")
	end
	if _popPanel[popPanelIndex].panel:GetChild("ChooseFan03").selected then
		Player.CmdMatTrackCutomKVEvent("Button","XuanFengGang","1")
	end
	if _popPanel[popPanelIndex].panel:GetChild("ChooseFan04").selected then
		Player.CmdMatTrackCutomKVEvent("Button","BaoPai","1")
	end
	if _popPanel[popPanelIndex].panel:GetChild("ChooseFan05").selected then
		Player.CmdMatTrackCutomKVEvent("Button","KeDuanMen","1")
	end
	if _popPanel[popPanelIndex].panel:GetChild("ChooseFan06").selected then
		Player.CmdMatTrackCutomKVEvent("Button","QingYiSe","1")
	end
	if _popPanel[popPanelIndex].panel:GetChild("ChooseFan07").selected then
		Player.CmdMatTrackCutomKVEvent("Button","BaoSanJia","1")
	end
	if _popPanel[popPanelIndex].panel:GetChild("AAPay") and _popPanel[popPanelIndex].panel:GetChild("AAPay").selected == true then
		Player.CmdMatTrackCutomKVEvent("Button","AAPay","1")
	else
		Player.CmdMatTrackCutomKVEvent("Button","RoomOwnerPay","1")
	end
end

function ClickEvent.JoinRoomId( gameObject )
	-- body
	Player._roomId = tonumber(gameObject:GetComponent("InputField").text)
end

function ClickEvent.GetinButton( ... )
	-- body
	--[[
	Player.CmdPlayBack(346392,3)
	--]]
	Player._roomId = tonumber(_popPanel[popPanelIndex].panel:GetChild("InputText").text)
	Player.LogWarning(tonumber(Player._roomId))
	Player.CmdEnterRoom("ROOM_TYPE_FRIEND",Player._roomId)
	Player.isFriendRoom = true
	ClickEvent.Close()
end
--数字
function ClickEvent.KeyBoardNumber(number)
	-- body
	if Player._roomId then
		_popPanel[popPanelIndex].panel:GetChild("InputText").text = tostring(Player._roomId)
		_popPanel[popPanelIndex].panel:GetChild("InputText").text = _popPanel[popPanelIndex].panel:GetChild("InputText").text..tostring(number)
	else
		_popPanel[popPanelIndex].panel:GetChild("InputText").text = tostring(number)
	end
	Player._roomId = tonumber(_popPanel[popPanelIndex].panel:GetChild("InputText").text)
end

function ClickEvent.KeyBoardZero( ... )
	-- body
	ClickEvent.KeyBoardNumber(0)
end
function ClickEvent.KeyBoardOne( ... )
	-- body
	ClickEvent.KeyBoardNumber(1)
end
function ClickEvent.KeyBoardTwo( ... )
	-- body
	ClickEvent.KeyBoardNumber(2)
end
function ClickEvent.KeyBoardThree( ... )
	-- body
	ClickEvent.KeyBoardNumber(3)
end
function ClickEvent.KeyBoardFour( ... )
	-- body
	ClickEvent.KeyBoardNumber(4)
end
function ClickEvent.KeyBoardFive( ... )
	-- body
	ClickEvent.KeyBoardNumber(5)
end
function ClickEvent.KeyBoardSix( ... )
	-- body
	ClickEvent.KeyBoardNumber(6)
end
function ClickEvent.KeyBoardSeven( ... )
	-- body
	ClickEvent.KeyBoardNumber(7)
end
function ClickEvent.KeyBoardEight( ... )
	-- body
	ClickEvent.KeyBoardNumber(8)
end
function ClickEvent.KeyBoardNine( ... )
	-- body
	ClickEvent.KeyBoardNumber(9)
end

function ClickEvent.Clear( ... )
 	-- body
 	_popPanel[popPanelIndex].panel:GetChild("InputText").text = ""
 	Player._roomId = nil
end
function ClickEvent.BackSpaceButton( ... )
	-- body
	local tempStr = _popPanel[popPanelIndex].panel:GetChild("InputText").text
	if tempStr then
		_popPanel[popPanelIndex].panel:GetChild("InputText").text = string.sub(tempStr,1,-2)
		Player._roomId = tonumber(_popPanel[popPanelIndex].panel:GetChild("InputText").text)
	end
end
--[[
--]]

-------------------------------------
---游戏中
---------------------------

function ClickEvent.GameBillButton(gameObject)
	-- body
	ClickEvent.PopPanel(ClickEvent.panelTable._history_score_play_ui)
	--[[
	if Player._room_information.options.model == "ROOM_MODEL_TYPE_CLASSICAL" then
		_popPanel[popPanelIndex].panel:GetChild("ModeText").text = "经典模式"
	else
		_popPanel[popPanelIndex].panel:GetChild("ModeText").text = "高番模式"
	end
	--]]
	local fanxing = ""
	for k,v in pairs(Player._room_information.options.extend_type) do
		if v == "ROOM_EXTEND_TYPE_ZHANLIHU" then
			fanxing = fanxing.."站立胡"
		elseif v == "ROOM_EXTEND_TYPE_JIAHU" then
			fanxing = fanxing.."带夹胡"
		elseif v == "ROOM_EXTEND_TYPE_XUANFENGGANG" then
			fanxing = fanxing.."旋风杠"
		elseif v == "ROOM_EXTEND_TYPE_BAOPAI" then
			fanxing = fanxing.."宝牌"
		elseif v == "ROOM_EXTEND_TYPE_DUANMEN" then
			fanxing = fanxing.."可断门"
		elseif v == "ROOM_EXTEND_TYPE_QIYISE" then
			fanxing = fanxing.."清一色"
		elseif v == "ROOM_EXTEND_TYPE_BAOSANJIA" then
			fanxing = fanxing.."点炮包三家"
		end
		fanxing = fanxing.."  "
	end
	fanxing = string.sub(fanxing, 1, -2)
	_popPanel[popPanelIndex].panel:GetChild("NoHistory").visible = false
	_popPanel[popPanelIndex].panel:GetChild("FanText").text = fanxing
	_popPanel[popPanelIndex].panel:GetChild("RoundText").text = tostring(Player._room_information.options.open_rands).."局"
	if _popPanel[popPanelIndex].panel:GetChild("RoomIDText") then
		_popPanel[popPanelIndex].panel:GetChild("RoomIDText").text = tostring(Player._roomId)
	end
	if Player._room_information.options.top_mutiple == 0 then
		_popPanel[popPanelIndex].panel:GetChild("MultipleText").text = "不封顶"
	else
		_popPanel[popPanelIndex].panel:GetChild("MultipleText").text = tostring(Player._room_information.options.top_mutiple).."倍"
	end
	local roundCount = 0
	local historyList = _popPanel[popPanelIndex].panel:GetChild("HistoryList")
	historyList:RemoveChildrenToPool()
	local countScore = {}
	for i=1,4 do
		countScore[i] = {}
		countScore[i].nickname = ""
		countScore[i].headimgurl = ""
		countScore[i].allScore = 0
	end
	WeChatPlatform.func = nil
	if Player._all_calculate_data then
		for c=1,Player._calculate_table_number do
			local obj = historyList:AddItemFromPool(UIPackage.GetItemURL("MXUI","VipNoteListInRoundNoButton"))
			obj.name = "VipNoteListInRound"
			roundCount = roundCount + 1
			if roundCount > 10 then
				obj:GetChild("RoundNum").text = "0"..tostring(roundCount % 10)
			else
				obj:GetChild("RoundNum").text = tostring(roundCount % 10)
			end
			if obj:GetChild("ShareReplay") and obj:GetChild("PlayThisRound") then
				obj:GetChild("ShareReplay").visible = false
				obj:GetChild("PlayThisRound").visible = false
			end
			local playerNumber = 1
			for roundKey,roundData in pairs(Player._all_calculate_data[c].list) do
				if not roundData.nickname or roundData.nickname == "" then
					if Player.roomall_player_brief then
						for playerKey,playerData in pairs(Player.roomall_player_brief) do
							if playerData.player_id == roundData.player_id then
								countScore[playerNumber].nickname = playerData.nickname
							end
						end
					end
				else
					countScore[playerNumber].nickname = roundData.nickname
				end
				if not roundData.headimgurl or roundData.headimgurl == "" then
					if Player.roomall_player_brief then
						for playerKey,playerData in pairs(Player.roomall_player_brief) do
							if playerData.player_id == roundData.player_id then
								countScore[playerNumber].headimgurl = playerData.headimgurl
							end
						end
					end
				else
					countScore[playerNumber].headimgurl = roundData.headimgurl
				end

				countScore[playerNumber].allScore = countScore[playerNumber].allScore + roundData.score
				obj:GetChild("VipNoteListRountUnit"..tostring(playerNumber)):GetChild("PlayerName").text = countScore[playerNumber].nickname
				obj:GetChild("VipNoteListRountUnit"..tostring(playerNumber)):GetChild("WinLoseNum").text = tostring(roundData.score)
				if obj:GetChild("VipNoteListRountUnit"..tostring(playerNumber)):GetChild("AvatarLoader") then
					obj:GetChild("VipNoteListRountUnit"..tostring(playerNumber)):GetChild("AvatarLoader").url = UIPackage.GetItemURL("MXUI","Touxiang01")
					if countScore[playerNumber].headimgurl and countScore[playerNumber].headimgurl ~= "" then
						obj:GetChild("VipNoteListRountUnit"..tostring(playerNumber)):GetChild("AvatarLoader").url = ""
						local tempTexture = WeChatPlatform:SetAsyncImage(countScore[playerNumber].headimgurl)
						if tempTexture then
							obj:GetChild("VipNoteListRountUnit"..tostring(playerNumber)):GetChild("AvatarLoader").texture = NTexture(tempTexture)
						end
					end
				end
				playerNumber = playerNumber + 1
			end
		end
	end
	--[[
	local historyShareList = _popPanel[popPanelIndex].panel:GetChild("HistoryShareList")
	historyShareList:RemoveChildrenToPool()
	for i=1,4 do
		local tempTable = {}
		for j=i,4 do
			if countScore[i].allScore < countScore[j].allScore then
				tempTable = countScore[i]
				countScore[i] = countScore[j]
				countScore[j] = tempTable
			end
		end
	end
	for i=1,4 do
		local obj = historyShareList:AddItemFromPool(UIPackage.GetItemURL("MXUI","VipNoteListInTotal"))
		obj.name = "VipNoteListInTotal"
		obj:GetChild("Rank").text = tostring(i)
		if countScore[i].allScore < 0 then
			local loseFont = obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").textFormat
			loseFont.font = UIPackage.GetItemURL("MXUI","LoseFont")
			obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").textFormat = loseFont
			obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").text = tostring(countScore[i].allScore)
		else
			local winFont = obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").textFormat
			winFont.font = UIPackage.GetItemURL("MXUI","WinFont")
			obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").textFormat = winFont
			obj:GetChild("VipNoteListTotalUnit"):GetChild("WinLoseNum").text = tostring(countScore[i].allScore)
		end
		obj:GetChild("VipNoteListTotalUnit"):GetChild("PlayerName").text = tostring(countScore[i].nickname)
		obj:GetChild("VipNoteListTotalUnit"):GetChild("AvatarLoader").url  = UIPackage.GetItemURL("MXUI","Touxiang01")
		if countScore[i].headimgurl and countScore[i].headimgurl ~= "" then
			obj:GetChild("VipNoteListTotalUnit"):GetChild("AvatarLoader").url = ""
			local tempTexture = WeChatPlatform:SetAsyncImage(countScore[i].headimgurl)
			if tempTexture then
				obj:GetChild("VipNoteListTotalUnit"):GetChild("AvatarLoader").texture = NTexture(tempTexture)
			end
		end
		obj:GetChild("VipNoteListTotalUnit"):GetChild("TotalRoundNum").text = tostring(roundCount)
	end
	--]]
end

function ClickEvent.GameListenButton(gameObject)
	-- body
	if _currentPanel.panel:GetChild("GameListenButton").selected then
		WeChatPlatform.m_voiceengine:CloseSpeaker()
		Player.CmdMatTrackCutomKVEvent("Gvoice","CloseReceiver","1")
	else
		WeChatPlatform.m_voiceengine:OpenSpeaker()
		Player.CmdMatTrackCutomKVEvent("Gvoice","OpenReceiver","1")
	end
end

function ClickEvent.GameVoiceButton(gameObject)
	-- body
	if _currentPanel.panel:GetChild("GameVoiceButton").selected then
		ClickEvent._play_ui.playerAvatarInfo:GetChild("VoiceState"):GetController("State").selectedIndex = 0
		WeChatPlatform.m_voiceengine:CloseMic()
		Player.CmdMatTrackCutomKVEvent("Gvoice","CloseMicrophone","1")
	else
		if CS.LuaCommon.isAndroid then
			Player._player_data.game_setting.music = false
			Player._player_data.game_setting.audio = false
			Player._player_data.game_setting.voice = false
			AudioPlayer.StopSound(AudioPlayer._audio_name.Bgm)
		end
		ClickEvent._play_ui.playerAvatarInfo:GetChild("VoiceState"):GetController("State").selectedIndex = 1
		WeChatPlatform.m_voiceengine:OpenMic()
		Player.CmdMatTrackCutomKVEvent("Gvoice","OpenMicrophone","1")
	end
end

function ClickEvent.TalkingState(position,state)
	-- body
	--[[
	--]]
	local tempPos = ClickEvent.PlayerPosition(position)
	if not tempPos then
		return
	end
	local talkState = 0
	if state and state == 0 then
		talkState = 0
	else
		talkState = 1
	end

	if tempPos == 1 then
		ClickEvent._play_ui.behindPlayerAvatarInfo:GetChild("VoiceState"):GetController("State").selectedIndex = talkState
	elseif tempPos == 2 then
		ClickEvent._play_ui.oppositePlayerAvatarInfo:GetChild("VoiceState"):GetController("State").selectedIndex = talkState
	elseif tempPos == 3 then
		ClickEvent._play_ui.frontPlayerAvatarInfo:GetChild("VoiceState"):GetController("State").selectedIndex = talkState
	else
		ClickEvent._play_ui.playerAvatarInfo:GetChild("VoiceState"):GetController("State").selectedIndex = talkState
	end
end

function ClickEvent.GameBackButton(gameObject)
	-- body
	if ClickEvent.IsPopPanel(ClickEvent.panelTable._share_calculate_ui) == true then
		ClickEvent.Close()
	else
		if Player.isPlayBack == true then
			ClickEvent.ShowSmallWindow(2042)
			return
		end
		if Player.roomHasBegin == false then
			ClickEvent.PopPanel(ClickEvent.panelTable._window_small)
			_popPanel[popPanelIndex].panel:GetChild("PopWindowsSmallShowText").text = StringTable.Get(2003)
			Player.CmdMatTrackCutomKVEvent("Back","BackNotInRound","1")
		else
			ClickEvent.ShowSingleYesWindow(2003)
			Player.CmdMatTrackCutomKVEvent("Back","BackInRound","1")
		end
	end
end

function ClickEvent.GameBackButtonShare(gameObject)
	-- body
	Player.CmdGameOperation("GAME_OPER_TYPE_LEAVE")
end

function ClickEvent.GameTingButton(gameObject)
	-- body
	--ClickEvent.CloseOperationPanel()
	ClickEvent._play_ui.operationBar:RemoveChildrenToPool()
	Player.MahJong.TingPaiUpdateState()
	Player.MahJong.SetCurrentState(operationState.DAPAI)
	--Player.CmdPaiOperation("PAI_OPER_TYPE_TINGPAI",{},{})
end

function ClickEvent.GamePlayButton( gameObject )
	-- body
	gameObject.visible = false
	Player.canShowPlayButton = false
	--Player.MahJong.PlayDoubleDices()
	Player.CmdGameOperation("GAME_OPER_TYPE_START")
end

function ClickEvent.GameGangButton(gameObject)
	-- body
	ClickEvent.CloseOperationPanel()
	local angangCount = 0
	local tempPai = nil
	if Player._operation_alert_cache.pais then
		for k,v in pairs(Player._operation_alert_cache.pais) do
			for j,m in pairs(v.oper_list) do
				if m == "PAI_OPER_TYPE_ANGANGPAI" or m == "PAI_OPER_TYPE_GANGPAI" then
					angangCount = angangCount + 1
				end
			end
		end
	end
	if angangCount > 1 then
		if Player._operation_alert_cache.pais then
			for k,v in pairs(Player._operation_alert_cache.pais) do
				for j,m in pairs(v.oper_list) do
					if m == "PAI_OPER_TYPE_ANGANGPAI" or m == "PAI_OPER_TYPE_GANGPAI" then
						Player.MahJong.CreateGangPai(v.pai,false)
					end
				end
			end
		end
	else
		Player.MahJong.GangPai()
	end
end

function ClickEvent.XuanFengButton(gameObject)
	-- body
	ClickEvent.CloseOperationPanel()
	Player.MahJong.XuanFengGang()
end

function ClickEvent.GameChiButton(gameObject)
	-- body
	ClickEvent.CloseOperationPanel()
	Player.MahJong.CheckChiPai()
	--Player.MahJong.ChiPai()
end

function ClickEvent.CreateChiPai(cardType,paiGroup,paiValue1,paiValue2,paiValue3)--牌类型、牌组数、牌值、
	-- body
	ClickEvent._play_ui.chiPaiBar.visible = true
	ClickEvent._play_ui.passButton.visible = true
	local chiPaiGroupTemp = ClickEvent._play_ui.chiPaiBar:GetChild("ChiPaiList"):AddItemFromPool(UIPackage.GetItemURL("MXUI","ChiPai"))
	chiPaiGroupTemp.name = tostring(paiGroup)
	chiPaiGroupTemp:GetChild("ChiPaiLoader01").url = UIPackage.GetItemURL("MXUI",cardType.."_"..paiValue1)
	chiPaiGroupTemp:GetChild("ChiPaiLoader02").url = UIPackage.GetItemURL("MXUI",cardType.."_"..paiValue2)
	chiPaiGroupTemp:GetChild("ChiPaiLoader03").url = UIPackage.GetItemURL("MXUI",cardType.."_"..paiValue3)
	chiPaiGroupTemp.onClick:Add(Player.MahJong.ClickChiPaiEvent)
	ClickEvent._play_ui.chiPaiBar:GetChild("ChiPaiList").width = chiPaiGroupTemp.width * paiGroup
end

function ClickEvent.CreateGangPai(cardType,paiValue,paiGroup,isXuanFeng)
	-- body
	ClickEvent._play_ui.gangPaiBar.visible = true
	ClickEvent._play_ui.passButton.visible = true
	Player.LogWarning("gangtype:"..cardType)
	local gangPaiGroupTemp
	if cardType == "CARD_TYPE_JIAN" and isXuanFeng == true then
		Player.LogWarning("xuanfeng:CARD_TYPE_JIAN")
		gangPaiGroupTemp = ClickEvent._play_ui.gangPaiBar:GetChild("ChiPaiList"):AddItemFromPool(UIPackage.GetItemURL("MXUI","ChiPai"))
		gangPaiGroupTemp.name = tostring(paiGroup)
		gangPaiGroupTemp:GetChild("ChiPaiLoader01").url = UIPackage.GetItemURL("MXUI",cardType.."_"..1)
		gangPaiGroupTemp:GetChild("ChiPaiLoader02").url = UIPackage.GetItemURL("MXUI",cardType.."_"..2)
		gangPaiGroupTemp:GetChild("ChiPaiLoader03").url = UIPackage.GetItemURL("MXUI",cardType.."_"..3)
		gangPaiGroupTemp.onClick:Add(Player.MahJong.ClickGangPaiEvent)
	elseif cardType == "CARD_TYPE_FENG" and isXuanFeng == true then
		Player.LogWarning("xuanfeng:CARD_TYPE_FENG")
		gangPaiGroupTemp = ClickEvent._play_ui.gangPaiBar:GetChild("ChiPaiList"):AddItemFromPool(UIPackage.GetItemURL("MXUI","GangPai"))
		gangPaiGroupTemp.name = tostring(paiGroup)
		gangPaiGroupTemp:GetChild("ChiPaiLoader01").url = UIPackage.GetItemURL("MXUI",cardType.."_"..1)
		gangPaiGroupTemp:GetChild("ChiPaiLoader02").url = UIPackage.GetItemURL("MXUI",cardType.."_"..2)
		gangPaiGroupTemp:GetChild("ChiPaiLoader03").url = UIPackage.GetItemURL("MXUI",cardType.."_"..3)
		gangPaiGroupTemp:GetChild("ChiPaiLoader04").url = UIPackage.GetItemURL("MXUI",cardType.."_"..4)
		gangPaiGroupTemp.onClick:Add(Player.MahJong.ClickGangPaiEvent)
	else
		gangPaiGroupTemp = ClickEvent._play_ui.gangPaiBar:GetChild("ChiPaiList"):AddItemFromPool(UIPackage.GetItemURL("MXUI","GangPai"))
		gangPaiGroupTemp.name = tostring(paiGroup)
		gangPaiGroupTemp:GetChild("ChiPaiLoader01").url = UIPackage.GetItemURL("MXUI",cardType.."_"..paiValue)
		gangPaiGroupTemp:GetChild("ChiPaiLoader02").url = UIPackage.GetItemURL("MXUI",cardType.."_"..paiValue)
		gangPaiGroupTemp:GetChild("ChiPaiLoader03").url = UIPackage.GetItemURL("MXUI",cardType.."_"..paiValue)
		gangPaiGroupTemp:GetChild("ChiPaiLoader04").url = UIPackage.GetItemURL("MXUI",cardType.."_"..paiValue)
		gangPaiGroupTemp.onClick:Add(Player.MahJong.ClickGangPaiEvent)
	end
	Player.LogWarning("xuanfeng:1")
	ClickEvent._play_ui.gangPaiBar:GetChild("ChiPaiList").width = gangPaiGroupTemp.width * paiGroup
	Player.LogWarning("xuanfeng:2")
end

function ClickEvent.CloseChiPai()
	-- body
	ClickEvent._play_ui.chiPaiBar:GetChild("ChiPaiList"):RemoveChildrenToPool()
	ClickEvent._play_ui.chiPaiBar.visible = false
end

function ClickEvent.CloseGangPai()
	-- body
	ClickEvent._play_ui.gangPaiBar:GetChild("ChiPaiList"):RemoveChildrenToPool()
	ClickEvent._play_ui.gangPaiBar.visible = false
end

function ClickEvent.GamePengButton(gameObject)
	-- body

	ClickEvent.CloseOperationPanel()
	Player.MahJong.PengPai()
end

function ClickEvent.GameHuButton(gameObject)
	-- body

	ClickEvent.CloseOperationPanel()
    Player.MahJong.HuPai()
end

function ClickEvent.GamePassButton(gameObject)
	-- body

	ClickEvent.CloseOperationPanel()
	ClickEvent.CloseChiPai()
	ClickEvent.CloseGangPai()
	Player.MahJong.GuoPai()
	Effect.DeleteEffect(Effect._effect_name.maybeOperationShowCircle)
end

function ClickEvent.GameCancelButton(gameObject)
	-- body
	Player._ting_pai_cache = nil
	ClickEvent.CloseOperationPanel()
	Player.MahJong.SetCurrentState(operationState.DAPAI)
	Player.MahJong.TingPaiCancelState()
end

function ClickEvent.CloseOperationPanel()
	-- body
	if ClickEvent._play_ui.operationBar then
		ClickEvent._play_ui.operationBar:RemoveChildrenToPool()
	end
	if ClickEvent._play_ui.passButton then
		ClickEvent._play_ui.passButton.visible = false
	end
	if ClickEvent._play_ui.cancelButton then
		ClickEvent._play_ui.cancelButton.visible = false
	end
end

---------------------------------------------------------------------------
---------------------------------------------------------------------------
function ClickEvent.registerButtonClick(gameObject)
	-- body
	local key = gameObject.sender.name
	--[[
	switch = {
		
		["Reward"] = function ( ... )
			-- body
		end,
		["More"] = function ( ... )
			-- body
		end,
		["ClosePlayerMessagePanel"] = function ( ... )
			-- body
			_Player_Message_UI:SetActive(false)
		end,
	}
	--]]
	local fSwitch = ClickEvent[key]

	if fSwitch then
		local result = fSwitch(gameObject.sender)
		if key == "Close" then
			AudioPlayer.PlaySound(AudioPlayer._audio_name.CloseUI,false,1)
		else
			AudioPlayer.PlaySound(AudioPlayer._audio_name.ClickUI,false,1)
		end
	else
		if gameObject.sender.gameObjectName == "HelloEmojiListButton" then
			ClickEvent.Emoji(gameObject.sender)
		end
		if gameObject.sender.gameObjectName == "HelloTextListButton" then
			ClickEvent.HelloText(gameObject.sender)
		end
		Player.LogWarning(key)
		Player.LogWarning("key no found")
	end

end

function ClickEvent.registerButtonDown(gameObject)
	-- body
	_popPanel[popPanelIndex].background:GetChild("Di").visible  = false
	if not _popPanel[popPanelIndex] or not _popPanel[popPanelIndex].panel then
		GRoot.inst:RemoveChild(_popPanel[popPanelIndex].background)
	end
	if _popPanel[popPanelIndex].panel.name == ClickEvent.panelTable._calculate_ui then
		_popPanel[popPanelIndex].panel.visible = false
	end
	
end

function ClickEvent.registerButtonUp(gameObject)
	-- body
	_popPanel[popPanelIndex].background:GetChild("Di").visible  = true
	if _popPanel[popPanelIndex].panel.name == ClickEvent.panelTable._calculate_ui then
		_popPanel[popPanelIndex].panel.visible = true
	end
end

return ClickEvent